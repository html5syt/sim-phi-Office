{"version":3,"file":"index-DNc_SsUy.js","sources":["../src/office.ts","../src/js/common.js","../src/components/Timer.ts","../src/utils/parseCSV.ts","../src/utils/stringify.ts","../src/utils/Type.ts","../src/utils/Chart.ts","../src/utils/structInfo.ts","../node_modules/crypt/crypt.js","../node_modules/charenc/charenc.js","../node_modules/is-buffer/index.js","../node_modules/md5/md5.js","../src/utils/reader.ts","../src/components/HitManager.ts","../src/components/Stat.ts","../src/utils/AudioTools.ts","../src/utils/createCtx.ts","../node_modules/stackblur-canvas/dist/stackblur-es.js","../src/utils/ImageTools.ts","../src/components/Checkbox.ts","../src/components/HitEvents.ts","../src/components/HitFeedback.ts","../src/components/HitImage.ts","../src/components/HitWord.ts","../src/components/ScaledNote.ts","../src/utils/adjustSize.ts","../src/components/MessageHandler.ts","../src/components/InfoHandler.ts","../src/index.ts","../src/components/Stage.ts","../src/core.ts","../src/components/StatusManager.ts","../src/components/FrameTimer.ts","../src/components/FrameAnimater.ts","../src/utils/checkSupport.ts","../src/utils/fixme.ts"],"sourcesContent":["import { mainPlay, uploader } from \"@/index\";\n///<reference path=\"../public/utils/dist/office.d.ts\" />\n\n// 获取select元素  \nexport const selectChartFile = document.getElementById('selectChartFile') as HTMLSelectElement;\nconst musicDispatchE = document.getElementById('music-dispatch');\n// const resetChart = document.getElementById('resetChart');\nvar playFlag = 0\nexport var activeview = 0\nvar isAuto = 0\nvar int: NodeJS.Timeout\nvar chartFilePath = \"\";\nexport var isOfficeInited = 0\n\n// 入口函数\nexport function init() {\n    console.log(\"office.ts inited\");\n}\n\n// phi，启动！\nOffice.initialize = function () {\n    isOfficeInited = 1\n    registerActiveViewChanged();\n    checkViewF();\n    musicDispatch();\n    setSelect();\n    selectChartFile.addEventListener('listfiled', () => {\n        getAndSetChartIndex();\n    })\n    // uploader.simulateFileSelection(chartFilePath)\n    // // 测试测试！！！记得删除\n}\n\nonload = () => {\n    if (isOfficeInited == 0) {\n        setSelect();\n    }\n};\n\n// 加载谱面。。。\nasync function loading() {\n\n    const goToFirst = Office.Index.First;\n\n    Office.context.document.goToByIdAsync(goToFirst, Office.GoToType.Index, function (asyncResult) {\n        if (asyncResult.status == Office.AsyncResultStatus.Failed) {\n            console.error(asyncResult.error.message);\n        }\n        else {\n            setTimeout(gotonext, 6000)\n        }\n    });\n\n    async function gotonext() {\n        const goToNext = Office.Index.Next;\n\n        Office.context.document.goToByIdAsync(goToNext, Office.GoToType.Index, function (asyncResult) {\n            if (asyncResult.status == Office.AsyncResultStatus.Failed) {\n                console.error(asyncResult.error.message);\n            }\n            else {\n                mainPlay();\n                // main.error('测试。。。');\n                playFlag = 1\n            }\n        });\n    }\n\n}\n\n\n\n// // 检查当前视图\nfunction checkViewF() {\n    Office.context.document.getActiveViewAsync(\n        function (asyncResult) {\n            if (asyncResult.status == Office.AsyncResultStatus.Failed) {\n                console.log(\"[office] Action failed with error: \" + asyncResult.error.message);\n            }\n            // 应对直接开启幻灯片放映\n            else if (asyncResult.value == \"read\" && playFlag == 0) {\n                loading()\n            }\n        });\n}\n\n// 检查当前选中的幻灯片\nfunction checkView() {\n    Office.context.document.getSelectedDataAsync(Office.CoercionType.SlideRange, (asyncResult) => {\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n            console.error(asyncResult.error.message);\n        }\n        // @ts-ignore\n        else if (asyncResult.value.slides[0].index == 2 && playFlag == 0 && activeview == 1) {\n            {\n                mainPlay();\n                playFlag = 1\n                setInt(0)\n            }\n        }\n    });\n}\n\n// 设置定时器\nasync function setInt(flag: number) {\n    if (flag == 1) {\n        int = setInterval(checkView, 500)\n    }\n    else if (flag == 0) {\n        //@ts-ignore\n        clearInterval(int)\n    }\n}\n\n\n\n// 活动视图改变处理函数\nasync function activeViewHandler(eventArgs: any) {\n    if (eventArgs.activeView == \"edit\") {\n        mainPlay();\n        playFlag = 0\n        activeview = 0\n        setInt(0)\n    }\n    else if (eventArgs.activeView == \"read\") {\n        musicDispatch();\n        // 加载谱面时间\n        setInt(1)\n        activeview = 1\n    }\n}\n\n// 注册活动视图改变事件\nfunction registerActiveViewChanged() {\n    Office.context.document.addHandlerAsync(Office.EventType.ActiveViewChanged, activeViewHandler,\n        function (asyncResult) {\n            if (asyncResult.status == Office.AsyncResultStatus.Failed) {\n                console.log(\"[office] Action failed with error: \" + asyncResult.error.message);\n            }\n            else {\n                console.log(\"[office] activeview changed handler registered\", asyncResult.status);\n            }\n        });\n}\n\nexport function setSetting(name: string, value: any) {\n    Office.context.document.settings.set(name, value);\n    Office.context.document.settings.saveAsync((asyncResult) => {\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n            console.error(asyncResult.error.message);\n        }\n        // @ts-ignore\n        else {\n            console.log(\"[office] set setting success\")\n        }\n    });\n}\n\nexport function rmSetting(all: boolean = false, name: string) {\n    if (all) {\n        // re: 统计所有用到的设置名！\n        Office.context.document.settings.remove('chartIndex');\n    }\n    else {\n        Office.context.document.settings.remove(name);\n    }\n    Office.context.document.settings.saveAsync((asyncResult) => {\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n            console.error(asyncResult.error.message);\n        }\n        // @ts-ignore\n        else {\n            console.log(\"[office] rm setting success\")\n        }\n    });\n}\n\n// Office.context.document.settings.get('mySetting')\n\n\n\n\n\n// 设置谱面文件列表\nfunction setSelect() {\n\n    // 假设list.json位于您的服务器上，或者您可以通过相对路径或绝对URL访问它  \n    const jsonUrl = '/chartfile/list.json';\n\n    // 使用fetch异步加载JSON文件  \n    fetch(jsonUrl)\n        .then(response => {\n            if (!response.ok) {\n                throw new Error('谱面JSON路径文件读取错误，请检查文件是否存在！');\n            }\n            return response.json(); // 解析JSON响应  \n        })\n        .then(data => {\n            // 假设data现在包含了从list.json加载的对象  \n            const chartlist = data as { [key: string]: { name: string, path: string } };\n\n            // 创建两个列表  \n            const chartFileName: string[] = [];\n            const chartFilePath: string[] = [];\n\n            // 遍历chartlist对象  \n            for (const key in chartlist) {\n                if (chartlist.hasOwnProperty(key)) { // 确保属性是对象自身的属性，而不是继承的  \n                    const item = chartlist[key];\n                    chartFileName.push(item.name);\n                    chartFilePath.push(item.path);\n                }\n            }\n\n            // 假设这是从某处获取的列表  \n\n\n            // 确保这两个列表的长度相同  \n            if (chartFileName.length !== chartFilePath.length) {\n                throw new Error(\"chartFileName和chartFilePath的项数必须相同，请检查JSON配置！\");\n            }\n\n\n\n            // 清除select元素中现有的所有option（如果有的话）  \n            selectChartFile.innerHTML = '';\n\n            // 遍历列表并添加option元素  \n            chartFileName.forEach((name, index) => {\n                const option = document.createElement('option');\n                option.value = chartFilePath[index]; // 设置value为对应的文件路径  \n                option.text = name; // 设置显示的文本为文件名  \n                selectChartFile.appendChild(option); // 将option添加到select中  \n            });\n\n            // 添加事件监听器以处理选项改变  \n            selectChartFile.addEventListener('change', () => {\n                // 获取所选option的value（即文件路径）  \n                const selectedValue = selectChartFile.value;\n                // 调用setChart函数并传入所选的value  \n                setChart(selectedValue);\n            });\n            selectChartFile.dispatchEvent(new Event('listfiled'));\n\n\n\n        })\n        .catch(error => {\n            console.error('Error fetching or parsing JSON:', error);\n        });\n}\n\n\n\n// 代替原有文件选择框\nfunction setChart(value: string) {\n    console.log('Selected chart:', value);\n    if (isAuto == 1) {\n        isAuto = 0\n    }\n    else {\n        const chartIndex = selectChartFile.selectedIndex\n        if (isOfficeInited == 1 && activeview == 0) {\n            setSetting('chartIndex', chartIndex)\n        }\n    }\n    chartFilePath = value\n    uploader.simulateFileSelection(value)\n    // 在这里可以添加更多的逻辑，比如加载图表等  \n}\n\nexport function getChartFilePath() { return chartFilePath; }\n\nfunction musicDispatch() {\n    //@ts-ignore\n    musicDispatchE.click();\n}\n//@ts-ignore\n// resetChart.addEventListener('click', function(this: HTMLInputElement) {\n//     rmSetting(true,\"0\")\n// })\n\nfunction getAndSetChartIndex() {\n    isAuto = 1\n    const chartIndex = Office.context.document.settings.get('chartIndex');\n    selectChartFile.selectedIndex = chartIndex;\n    selectChartFile.dispatchEvent(new Event('change'));\n}\n//@ts-ignore\n// musicDispatchE.addEventListener('click', function(this: HTMLInputElement) {\n//     rmSetting(true,\"0\")\n// })","// 全屏相关\nexport const full = {\n  /**\n   * @param {HTMLElement} [elem]\n   * @returns {Promise<void>}\n   */\n  toggle(elem) {\n    // 踩坑：Apple第三方浏览器可能根本没有包含full的属性或方法\n    if (!this.enabled) return Promise.reject(new Error('Fullscreen is not supported'));\n    const onFullscreen = () => new Promise((resolve, reject) => {\n      document.addEventListener(this.onchange, resolve, { once: true });\n      document.addEventListener(this.onerror, reject, { once: true });\n    });\n    if (this.element) {\n      const handler = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen;\n      if (handler) { handler.call(document); return onFullscreen() }\n    } else {\n      const element = elem instanceof HTMLElement ? elem : document.body;\n      const handler = element.requestFullscreen || element.webkitRequestFullscreen || element.mozRequestFullScreen;\n      if (handler) { handler.call(element); return onFullscreen() }\n    }\n    return Promise.reject(new Error('Fullscreen is not supported'));\n  },\n  check(elem) {\n    const element = elem instanceof HTMLElement ? elem : document.body;\n    return this.element === element;\n  },\n  get onchange() {\n    if (document.onfullscreenchange !== undefined) return 'fullscreenchange';\n    if (document.onwebkitfullscreenchange !== undefined) return 'webkitfullscreenchange';\n    if (document.onmozfullscreenchange !== undefined) return 'mozfullscreenchange';\n    return null;\n  },\n  get onerror() {\n    if (document.onfullscreenerror !== undefined) return 'fullscreenerror';\n    if (document.onwebkitfullscreenerror !== undefined) return 'webkitfullscreenerror';\n    if (document.onmozfullscreenerror !== undefined) return 'mozfullscreenerror';\n    return null;\n  },\n  get element() {\n    return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || null;\n  },\n  get enabled() {\n    return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || false;\n  }\n};\nexport const orientation = {\n  async checkSupport() {\n    const s = screen.orientation;\n    if (!s) return false;\n    try {\n      await s.lock(s.type);\n      s.unlock();\n      hook.toast('如果你看到了这个提示，请联系开发者：Unexpected Allow Orientation Lock Without Permission');\n      return true;\n    } catch (e) {\n      if (e.name === 'SecurityError') {\n        if (e.message === 'The operation is insecure.') return false; // Firefox\n        return true;\n      } else if (e.name === 'NotSupportedError') return false;\n      else if (e.name === 'TypeError') return false; // Safari 16.4\n      throw e;\n    }\n  },\n  lockLandscape() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.lock('landscape-primary');\n  },\n  lockPortrait() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.lock('portrait-primary');\n  },\n  unlock() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.unlock();\n  }\n};\n// function loadJS(url, callback) {\n//   const script = document.createElement('script');\n//   const fn = callback || function() {};\n//   script.type = 'text/javascript';\n//   script.onload = function() {\n//     fn();\n//   };\n//   script.src = url;\n//   document.getElementsByTagName('head')[0].appendChild(script);\n// }\n// function loadJS2(url) {\n//   return new Promise((resolve, reject) => {\n//     const script = document.createElement('script');\n//     script.type = 'text/javascript';\n//     script.onload = resolve;\n//     script.onerror = reject;\n//     script.src = url;\n//     document.getElementsByTagName('head')[0].appendChild(script);\n//   });\n// }\n// self.onerror=(...a)=>console.log('awa',a);\n// self.addEventListener('error',(...a)=>console.log('awa',a));\nexport const urls0 = {\n  jszip: ['//unpkg.com/jszip/dist/jszip.min.js', '//cdn.jsdelivr.net/npm/jszip', '//fastly.jsdelivr.net/npm/jszip'],\n  blur: ['//unpkg.com/stackblur-canvas/dist/stackblur.min.js', '//cdn.jsdelivr.net/npm/stackblur-canvas', '//fastly.jsdelivr.net/npm/stackblur-canvas'],\n  md5: ['//unpkg.com/md5-js/md5.min.js', '//cdn.jsdelivr.net/npm/md5-js', '//fastly.jsdelivr.net/npm/md5-js']\n};\nexport const getConstructorName = obj => {\n  if (obj === null) return 'Null';\n  if (obj === undefined) return 'Undefined';\n  return obj.constructor.name;\n};\nexport const isUndefined = name => self[name] === undefined;\n// Legacy\n{\n  // EventTarget.constructor polyfill for Safari 14-\n  try {\n    Reflect.construct(EventTarget, []);\n  } catch (e) {\n    self.EventTarget = function() {\n      this.listeners = {};\n    };\n    EventTarget.prototype = {\n      constructor: EventTarget,\n      addEventListener(type, callback) {\n        if (!(type in this.listeners)) this.listeners[type] = [];\n        this.listeners[type].push(callback);\n      },\n      removeEventListener(type, callback) {\n        if (!(type in this.listeners)) return;\n        const stack = this.listeners[type];\n        for (let i = 0, l = stack.length; i < l; i++) {\n          if (stack[i] === callback) {\n            stack.splice(i, 1);\n            return;\n          }\n        }\n      },\n      dispatchEvent(event) {\n        if (!(event.type in this.listeners)) return true;\n        const stack = this.listeners[event.type];\n        // event.target = this;\n        for (let i = 0, l = stack.length; i < l; i++) {\n          stack[i].call(this, event);\n        }\n        return !event.defaultPrevented;\n      }\n    };\n  }\n  // Error.cause polyfill for Safari 15-\n  const error = new Error();\n  if (new Error('', { cause: error }).cause !== error) {\n    class Error extends self.Error {\n      constructor(message, { cause } = {}) {\n        super(message);\n        this.cause = cause;\n      }\n    }\n    Object.defineProperty(Error, 'name', { value: 'Error' });\n    self.Error = Error;\n  }\n  // DOMException.stack polyfill for All Browsers\n  class DOMException extends self.DOMException {\n    constructor(message, name) {\n      super(message, name);\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, DOMException); // 过滤自身stack\n      } else {\n        this.stack = new Error().stack.replace(/.+\\n/, '');\n      }\n    }\n  }\n  Object.defineProperty(DOMException, 'name', { value: 'DOMException' });\n  self.DOMException = DOMException;\n  // AudioContext constructor polyfill for Safari 14.5-\n  if (isUndefined('AudioContext')) {\n    self.AudioContext = self.webkitAudioContext;\n  }\n  // Object.hasOwn polyfill for Safari 15.4-\n  if (Object.hasOwn === undefined) {\n    Object.defineProperty(Object, 'hasOwn', {\n      value(obj, prop) {\n        // eslint-disable-next-line prefer-object-has-own\n        return Object.prototype.hasOwnProperty.call(obj, prop);\n      }\n    });\n  }\n  // Array.prototype.findLast polyfill\n  if (Array.prototype.findLast === undefined) {\n    // eslint-disable-next-line no-extend-native\n    Object.defineProperty(Array.prototype, 'findLast', {\n      value(predicate, thisArg) {\n        for (let i = this.length - 1; i >= 0; i--) {\n          if (predicate.call(thisArg, this[i], i, this)) return this[i];\n        }\n        return undefined;\n      }\n    });\n  }\n  // Array.prototype.toReversed polyfill\n  if (Array.prototype.toReversed === undefined) {\n    // eslint-disable-next-line no-extend-native\n    Object.defineProperty(Array.prototype, 'toReversed', {\n      value() {\n        return this.slice().reverse();\n      }\n    });\n  }\n}\nexport function loadJS(...args) {\n  const arr = Array.from(args[0] instanceof Array ? args[0] : args, i => new URL(i, location).href);\n  const args0 = (function *(arg) { yield* arg }(arr));\n  const load = url => new Promise((resolve, reject) => {\n    if (!url) { reject(new DOMException(`All urls are invalid\\n${arr.join('\\n')}`, 'NetworkError')); return }\n    const script = document.createElement('script');\n    script.onload = () => resolve(script);\n    script.onerror = () => load(args0.next().value).then(s => resolve(s)).catch(e => reject(e));\n    script.src = url;\n    if (!location.port) script.crossOrigin = 'anonymous';\n    document.head.appendChild(script);\n  });\n  return load(args0.next().value);\n}\n","export class Timer {\n  private t0: number;\n  private t1: number;\n  private isPaused: boolean;\n  public constructor() {\n    this.t0 = 0;\n    this.t1 = 0;\n    this.isPaused = true;\n  }\n  public get time(): number {\n    if (this.isPaused) return this.t0;\n    return this.t0 + performance.now() - this.t1;\n  }\n  public get second(): number {\n    return this.time / 1e3;\n  }\n  public play(): void {\n    if (!this.isPaused) throw new Error('Time has been playing');\n    this.t1 = performance.now();\n    this.isPaused = false;\n  }\n  public pause(): void {\n    if (this.isPaused) throw new Error('Time has been paused');\n    this.t0 = this.time;\n    this.isPaused = true;\n  }\n  public reset(): void {\n    this.t0 = 0;\n    this.t1 = 0;\n    this.isPaused = true;\n  }\n  public addTime(num = 0): void {\n    this.t0 += num;\n  }\n}\n","export function parseCSV(rawText: string, isObject: false): string[][];\nexport function parseCSV(rawText: string, isObject: true): Record<string, string>[];\nexport function parseCSV(rawText: string, isObject: boolean): Record<string, string>[] | string[][] {\n  const lines = rawText.replace(/\\ufeff|\\r/g, '').split('\\n');\n  const rows = [];\n  for (const line of lines) {\n    let rowText = '';\n    let isQuot = false;\n    let beforeQuot = false;\n    const row = [];\n    for (const char of line) {\n      if (char === '\"') {\n        if (!isQuot) isQuot = true;\n        else if (beforeQuot) {\n          rowText += char; beforeQuot = false;\n        } else beforeQuot = true;\n      } else if (char === ',') {\n        if (!isQuot) {\n          row.push(rowText);\n          rowText = '';\n        } else if (beforeQuot) {\n          row.push(rowText);\n          rowText = '';\n          isQuot = false;\n          beforeQuot = false;\n        } else rowText += char;\n      } else if (beforeQuot) throw new SyntaxError('Unexpected token , (-1)');\n      else rowText += char;\n    }\n    if (!isQuot) {\n      row.push(rowText);\n      rowText = '';\n    } else if (beforeQuot) {\n      row.push(rowText);\n      rowText = '';\n      isQuot = false;\n      beforeQuot = false;\n    } else throw new SyntaxError('Unexpected token , (-2)');\n    rows.push(row);\n  }\n  if (!isObject) return rows;\n  const arr = [];\n  for (let i = 1; i < rows.length; i++) {\n    const obj = {} as Record<string, string>;\n    for (let j = 0; j < rows[0].length; j++) obj[rows[0][j]] = rows[i][j];\n    arr.push(obj);\n  }\n  return arr;\n}\n","export function stringify(bfs: BufferSource): string {\n  const labels = ['utf-8', 'gbk', 'big5', 'shift_jis'];\n  for (const label of labels) {\n    const decoder = new TextDecoder(label, { fatal: true }); // '\\ufffd'\n    try {\n      return decoder.decode(bfs);\n    } catch (e) {\n      if (label === labels[labels.length - 1]) throw e;\n    }\n  }\n  throw new Error('Unknown encoding');\n}\n","namespace Type {\n  export function int(a: unknown): number {\n    return Number(a) | 0;\n  }\n  export function float(a: unknown): number {\n    return Number(a) || 0;\n  }\n  export function bool(a: unknown): boolean {\n    return Boolean(a);\n  }\n  export function str(a: unknown): string {\n    return String(a);\n  }\n  export function arr<T>(a: unknown, constructor: new (b: Record<string, unknown>) => T): T[] {\n    return Array.isArray(a) ? a.map((i?: Record<string, unknown>) => new constructor(i || {})) : [];\n  }\n  export function obj<T>(a: unknown, constructor: new (b: Record<string, unknown>) => T): T {\n    return new constructor((a as Record<string, unknown> | null) || {});\n  }\n}\nexport default Type;\n","import Type from './Type';\nexport class SpeedEvent {\n  public startTime: number;\n  public endTime: number;\n  public value: number;\n  public constructor(event: Record<string, unknown>) {\n    this.startTime = Type.int(event.startTime);\n    this.endTime = Type.int(event.endTime);\n    this.value = Type.float(event.value);\n  }\n}\nexport class Note {\n  public type: number;\n  public time: number;\n  public positionX: number;\n  public holdTime: number;\n  public speed: number;\n  public floorPosition: number;\n  public constructor(note: Record<string, unknown>) {\n    this.type = Type.int(note.type);\n    this.time = Type.int(note.time);\n    this.positionX = Type.float(note.positionX);\n    this.holdTime = Type.int(note.holdTime);\n    this.speed = Type.float(note.speed);\n    this.floorPosition = Type.float(note.floorPosition);\n  }\n}\nexport class JudgeLineEvent {\n  public startTime: number;\n  public endTime: number;\n  public start: number;\n  public end: number;\n  public start2: number;\n  public end2: number;\n  public constructor(event: Record<string, unknown>) {\n    this.startTime = Type.int(event.startTime);\n    this.endTime = Type.int(event.endTime);\n    this.start = Type.float(event.start);\n    this.end = Type.float(event.end);\n    this.start2 = Type.float(event.start2);\n    this.end2 = Type.float(event.end2);\n  }\n}\nexport class JudgeLine {\n  public numOfNotes: number;\n  public numOfNotesAbove: number;\n  public numOfNotesBelow: number;\n  public bpm: number;\n  public speedEvents: SpeedEvent[];\n  public notesAbove: Note[];\n  public notesBelow: Note[];\n  public judgeLineDisappearEvents: JudgeLineEvent[];\n  public judgeLineMoveEvents: JudgeLineEvent[];\n  public judgeLineRotateEvents: JudgeLineEvent[];\n  public constructor(line: Record<string, unknown>) {\n    this.numOfNotes = Type.int(line.numOfNotes);\n    this.numOfNotesAbove = Type.int(line.numOfNotesAbove);\n    this.numOfNotesBelow = Type.int(line.numOfNotesBelow);\n    this.bpm = Type.float(line.bpm);\n    this.speedEvents = Type.arr(line.speedEvents, SpeedEvent);\n    this.notesAbove = Type.arr(line.notesAbove, Note);\n    this.notesBelow = Type.arr(line.notesBelow, Note);\n    if (line.numOfNotesAbove == null) this.numOfNotesAbove = this.notesAbove.length;\n    if (line.numOfNotesBelow == null) this.numOfNotesBelow = this.notesBelow.length;\n    if (line.numOfNotes == null) this.numOfNotes = this.numOfNotesAbove + this.numOfNotesBelow;\n    this.judgeLineDisappearEvents = Type.arr(line.judgeLineDisappearEvents, JudgeLineEvent);\n    this.judgeLineMoveEvents = Type.arr(line.judgeLineMoveEvents, JudgeLineEvent);\n    this.judgeLineRotateEvents = Type.arr(line.judgeLineRotateEvents, JudgeLineEvent);\n  }\n}\nexport class Chart {\n  public formatVersion: number;\n  public offset: number;\n  public numOfNotes: number;\n  public judgeLineList: JudgeLine[];\n  public constructor(input?: Record<string, unknown>) {\n    const chart = input || {};\n    this.formatVersion = Type.int(chart.formatVersion);\n    this.offset = Type.float(chart.offset);\n    this.numOfNotes = Type.int(chart.numOfNotes);\n    this.judgeLineList = Type.arr(chart.judgeLineList, JudgeLine);\n    if (chart.numOfNotes == null) this.numOfNotes = this.judgeLineList.reduce((a, b) => a + b.numOfNotes, 0);\n  }\n  public duplicate(): Chart {\n    return Type.obj(this, Chart);\n  }\n}\ninterface ChartData {\n  data: Chart;\n  messages: BetterMessage[];\n}\nexport function structChart(chart: ChartPGS, filename: string): ChartData {\n  const result = Type.obj(chart, Chart);\n  switch (result.formatVersion) {\n    case 1:\n      for (const line of result.judgeLineList) {\n        for (const evt of line.judgeLineMoveEvents) {\n          evt.start2 = evt.start % 1000 / 520;\n          evt.end2 = evt.end % 1000 / 520;\n          evt.start = Math.floor(evt.start / 1000) / 880;\n          evt.end = Math.floor(evt.end / 1000) / 880;\n        }\n      } // fallthrough\n    case 3:\n    case 3473:\n      break;\n    default:\n      throw new Error(`Unsupported formatVersion: ${result.formatVersion}`);\n  }\n  const errors = [];\n  const messages: BetterMessage[] = [];\n  const numOfLines = result.judgeLineList.length;\n  // if (result.offset < 0) throw new Error('Offset must be non-negative');\n  // if (result.numOfNotes <= 0) throw new Error('At least one note is required');\n  const warn = (code: number, name: string, message: string) => messages.push({ host: 'Core', code, name, message, target: filename });\n  if (numOfLines > 100) warn(1, 'LineCountWarning', `Expected at most 100 items in judgeLineList, but got ${numOfLines}`);\n  let maxNoteSeconds = 0;\n  for (const { bpm, notesAbove, notesBelow } of result.judgeLineList) {\n    for (const { type, time, holdTime } of notesAbove) {\n      const seconds = (time % 1e9 + (type === 3 && holdTime > 0 ? holdTime : 0)) / bpm * 1.875;\n      if (seconds > maxNoteSeconds) maxNoteSeconds = seconds;\n    }\n    for (const { type, time, holdTime } of notesBelow) {\n      const seconds = (time % 1e9 + (type === 3 && holdTime > 0 ? holdTime : 0)) / bpm * 1.875;\n      if (seconds > maxNoteSeconds) maxNoteSeconds = seconds;\n    }\n  }\n  for (let i = 0; i < numOfLines; i++) {\n    const line = result.judgeLineList[i];\n    const subErrors = [];\n    if (line.bpm > 0) {\n      const maxNoteTime = Math.ceil(maxNoteSeconds * line.bpm / 1.875);\n      type KeyOfType<T, U> = { [K in keyof T]: T[K] extends U ? K : never }[keyof T];\n      type KeyOfJudgeLine = KeyOfType<JudgeLine, (JudgeLineEvent | SpeedEvent)[]>;\n      const checkMaxEventTime = (key: KeyOfJudgeLine) => {\n        if (line[key].length) {\n          let maxEndTime = 0;\n          for (const { endTime } of line[key]) {\n            if (endTime > maxEndTime) maxEndTime = endTime;\n          }\n          if (maxEndTime < maxNoteTime) subErrors.push(`Maximum time for ${key} is too small`);\n        } else subErrors.push(`Expected at least 1 item in ${key}`);\n      };\n      checkMaxEventTime('speedEvents');\n      checkMaxEventTime('judgeLineDisappearEvents');\n      checkMaxEventTime('judgeLineMoveEvents');\n      checkMaxEventTime('judgeLineRotateEvents');\n    } else subErrors.push(`Expected bpm > 0, but got ${line.bpm}`);\n    if (subErrors.length) errors.push(`JudgeLine ${i}:\\n${subErrors.map(e => `  ${e}`).join('\\n')}`);\n  }\n  if (errors.length) throw new Error(`Invalid chart input\\n${errors.map(e => `  ${e.split('\\n').join('\\n  ')}`).join('\\n')}`);\n  if (!numOfLines) throw new Error('No judge lines available');\n  return { data: result, messages };\n}\n","export function structInfoData(entries: Record<string, string | null>[], path: string): ChartInfoData[] {\n  const result = [];\n  for (const entry of entries) {\n    if (entry.Chart == null) continue;\n    const data: ChartInfoData = { chart: entry.Chart };\n    if (entry.Name != null) data.name = entry.Name;\n    if (entry.Musician != null) data.artist = entry.Musician; // Alternative\n    if (entry.Composer != null) data.artist = entry.Composer; // Alternative\n    if (entry.Artist != null) data.artist = entry.Artist;\n    if (entry.Level != null) data.level = entry.Level;\n    if (entry.Illustrator != null) data.illustrator = entry.Illustrator;\n    if (entry.Designer != null) data.charter = entry.Designer; // Alternative\n    if (entry.Charter != null) data.charter = entry.Charter;\n    if (entry.Music != null) data.music = entry.Music;\n    if (entry.Image != null) data.image = entry.Image;\n    if (entry.AspectRatio != null) {\n      const v = parseFloat(entry.AspectRatio);\n      if (isFinite(v)) data.aspectRatio = v;\n    }\n    if (entry.ScaleRatio != null) { // Legacy\n      const v = 8080 / parseFloat(entry.ScaleRatio);\n      if (isFinite(v)) data.noteScale = v;\n    }\n    if (entry.NoteScale != null) {\n      const v = parseFloat(entry.NoteScale);\n      if (isFinite(v)) data.noteScale = v;\n    }\n    if (entry.GlobalAlpha != null) { // Legacy\n      const v = parseFloat(entry.GlobalAlpha);\n      if (isFinite(v)) data.backgroundDim = v;\n    }\n    if (entry.BackgroundDim != null) {\n      const v = parseFloat(entry.BackgroundDim);\n      if (isFinite(v)) data.backgroundDim = v;\n    }\n    if (entry.Offset != null) {\n      const v = parseFloat(entry.Offset);\n      if (isFinite(v)) data.offset = v;\n    }\n    result.push(data);\n    if (path) {\n      data.chart = `${path}/${data.chart}`;\n      if (data.music != null) data.music = `${path}/${data.music}`;\n      if (data.image != null) data.image = `${path}/${data.image}`;\n    }\n  }\n  return result;\n}\nexport function structLineData(entries: Record<string, string | null>[], path: string): ChartLineData[] {\n  const result = [];\n  for (const entry of entries) {\n    if (entry.Chart == null) continue;\n    const data: ChartLineData = { chart: entry.Chart };\n    if (entry.LineId != null) data.lineId = Number(entry.LineId);\n    if (entry.Image != null) data.image = entry.Image;\n    if (entry.Vert != null) { // Legacy\n      const v = parseFloat(entry.Vert);\n      if (isFinite(v)) data.scaleOld = v;\n    }\n    if (entry.Horz != null) { // Legacy\n      const v = parseFloat(entry.Horz);\n      if (isFinite(v)) data.aspect = v;\n    }\n    if (entry.IsDark != null) { // Legacy\n      const v = parseFloat(entry.IsDark);\n      if (isFinite(v)) data.useBackgroundDim = Boolean(v);\n    }\n    if (entry.Scale != null) {\n      const v = parseFloat(entry.Scale);\n      if (isFinite(v)) data.scale = v;\n    }\n    if (entry.Aspect != null) {\n      const v = parseFloat(entry.Aspect);\n      if (isFinite(v)) data.aspect = v;\n    }\n    if (entry.UseBackgroundDim != null) {\n      const v = parseFloat(entry.UseBackgroundDim);\n      if (isFinite(v)) data.useBackgroundDim = Boolean(v);\n    }\n    if (entry.UseLineColor != null) {\n      const v = parseFloat(entry.UseLineColor);\n      if (isFinite(v)) data.useLineColor = Boolean(v);\n    }\n    if (entry.UseLineScale != null) {\n      const v = parseFloat(entry.UseLineScale);\n      if (isFinite(v)) data.useLineScale = Boolean(v);\n    }\n    result.push(data);\n    if (path) {\n      data.chart = `${path}/${data.chart}`;\n      if (data.image != null) data.image = `${path}/${data.image}`;\n    }\n  }\n  return result;\n}\n","(function() {\n  var base64map\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n\n  crypt = {\n    // Bit-wise rotation left\n    rotl: function(n, b) {\n      return (n << b) | (n >>> (32 - b));\n    },\n\n    // Bit-wise rotation right\n    rotr: function(n, b) {\n      return (n << (32 - b)) | (n >>> b);\n    },\n\n    // Swap big-endian to little-endian and vice versa\n    endian: function(n) {\n      // If number given, swap endian\n      if (n.constructor == Number) {\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\n      }\n\n      // Else, assume array and swap all items\n      for (var i = 0; i < n.length; i++)\n        n[i] = crypt.endian(n[i]);\n      return n;\n    },\n\n    // Generate an array of any length of random bytes\n    randomBytes: function(n) {\n      for (var bytes = []; n > 0; n--)\n        bytes.push(Math.floor(Math.random() * 256));\n      return bytes;\n    },\n\n    // Convert a byte array to big-endian 32-bit words\n    bytesToWords: function(bytes) {\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\n      return words;\n    },\n\n    // Convert big-endian 32-bit words to a byte array\n    wordsToBytes: function(words) {\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a hex string\n    bytesToHex: function(bytes) {\n      for (var hex = [], i = 0; i < bytes.length; i++) {\n        hex.push((bytes[i] >>> 4).toString(16));\n        hex.push((bytes[i] & 0xF).toString(16));\n      }\n      return hex.join('');\n    },\n\n    // Convert a hex string to a byte array\n    hexToBytes: function(hex) {\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n      return bytes;\n    },\n\n    // Convert a byte array to a base-64 string\n    bytesToBase64: function(bytes) {\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n        for (var j = 0; j < 4; j++)\n          if (i * 8 + j * 6 <= bytes.length * 8)\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\n          else\n            base64.push('=');\n      }\n      return base64.join('');\n    },\n\n    // Convert a base-64 string to a byte array\n    base64ToBytes: function(base64) {\n      // Remove non-base-64 characters\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\n\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\n          imod4 = ++i % 4) {\n        if (imod4 == 0) continue;\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\n      }\n      return bytes;\n    }\n  };\n\n  module.exports = crypt;\n})();\n","var charenc = {\n  // UTF-8 encoding\n  utf8: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\n    }\n  },\n\n  // Binary encoding\n  bin: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      for (var bytes = [], i = 0; i < str.length; i++)\n        bytes.push(str.charCodeAt(i) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      for (var str = [], i = 0; i < bytes.length; i++)\n        str.push(String.fromCharCode(bytes[i]));\n      return str.join('');\n    }\n  }\n};\n\nmodule.exports = charenc;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","(function(){\r\n  var crypt = require('crypt'),\r\n      utf8 = require('charenc').utf8,\r\n      isBuffer = require('is-buffer'),\r\n      bin = require('charenc').bin,\r\n\r\n  // The core\r\n  md5 = function (message, options) {\r\n    // Convert to byte array\r\n    if (message.constructor == String)\r\n      if (options && options.encoding === 'binary')\r\n        message = bin.stringToBytes(message);\r\n      else\r\n        message = utf8.stringToBytes(message);\r\n    else if (isBuffer(message))\r\n      message = Array.prototype.slice.call(message, 0);\r\n    else if (!Array.isArray(message) && message.constructor !== Uint8Array)\r\n      message = message.toString();\r\n    // else, assume byte array already\r\n\r\n    var m = crypt.bytesToWords(message),\r\n        l = message.length * 8,\r\n        a =  1732584193,\r\n        b = -271733879,\r\n        c = -1732584194,\r\n        d =  271733878;\r\n\r\n    // Swap endian\r\n    for (var i = 0; i < m.length; i++) {\r\n      m[i] = ((m[i] <<  8) | (m[i] >>> 24)) & 0x00FF00FF |\r\n             ((m[i] << 24) | (m[i] >>>  8)) & 0xFF00FF00;\r\n    }\r\n\r\n    // Padding\r\n    m[l >>> 5] |= 0x80 << (l % 32);\r\n    m[(((l + 64) >>> 9) << 4) + 14] = l;\r\n\r\n    // Method shortcuts\r\n    var FF = md5._ff,\r\n        GG = md5._gg,\r\n        HH = md5._hh,\r\n        II = md5._ii;\r\n\r\n    for (var i = 0; i < m.length; i += 16) {\r\n\r\n      var aa = a,\r\n          bb = b,\r\n          cc = c,\r\n          dd = d;\r\n\r\n      a = FF(a, b, c, d, m[i+ 0],  7, -680876936);\r\n      d = FF(d, a, b, c, m[i+ 1], 12, -389564586);\r\n      c = FF(c, d, a, b, m[i+ 2], 17,  606105819);\r\n      b = FF(b, c, d, a, m[i+ 3], 22, -1044525330);\r\n      a = FF(a, b, c, d, m[i+ 4],  7, -176418897);\r\n      d = FF(d, a, b, c, m[i+ 5], 12,  1200080426);\r\n      c = FF(c, d, a, b, m[i+ 6], 17, -1473231341);\r\n      b = FF(b, c, d, a, m[i+ 7], 22, -45705983);\r\n      a = FF(a, b, c, d, m[i+ 8],  7,  1770035416);\r\n      d = FF(d, a, b, c, m[i+ 9], 12, -1958414417);\r\n      c = FF(c, d, a, b, m[i+10], 17, -42063);\r\n      b = FF(b, c, d, a, m[i+11], 22, -1990404162);\r\n      a = FF(a, b, c, d, m[i+12],  7,  1804603682);\r\n      d = FF(d, a, b, c, m[i+13], 12, -40341101);\r\n      c = FF(c, d, a, b, m[i+14], 17, -1502002290);\r\n      b = FF(b, c, d, a, m[i+15], 22,  1236535329);\r\n\r\n      a = GG(a, b, c, d, m[i+ 1],  5, -165796510);\r\n      d = GG(d, a, b, c, m[i+ 6],  9, -1069501632);\r\n      c = GG(c, d, a, b, m[i+11], 14,  643717713);\r\n      b = GG(b, c, d, a, m[i+ 0], 20, -373897302);\r\n      a = GG(a, b, c, d, m[i+ 5],  5, -701558691);\r\n      d = GG(d, a, b, c, m[i+10],  9,  38016083);\r\n      c = GG(c, d, a, b, m[i+15], 14, -660478335);\r\n      b = GG(b, c, d, a, m[i+ 4], 20, -405537848);\r\n      a = GG(a, b, c, d, m[i+ 9],  5,  568446438);\r\n      d = GG(d, a, b, c, m[i+14],  9, -1019803690);\r\n      c = GG(c, d, a, b, m[i+ 3], 14, -187363961);\r\n      b = GG(b, c, d, a, m[i+ 8], 20,  1163531501);\r\n      a = GG(a, b, c, d, m[i+13],  5, -1444681467);\r\n      d = GG(d, a, b, c, m[i+ 2],  9, -51403784);\r\n      c = GG(c, d, a, b, m[i+ 7], 14,  1735328473);\r\n      b = GG(b, c, d, a, m[i+12], 20, -1926607734);\r\n\r\n      a = HH(a, b, c, d, m[i+ 5],  4, -378558);\r\n      d = HH(d, a, b, c, m[i+ 8], 11, -2022574463);\r\n      c = HH(c, d, a, b, m[i+11], 16,  1839030562);\r\n      b = HH(b, c, d, a, m[i+14], 23, -35309556);\r\n      a = HH(a, b, c, d, m[i+ 1],  4, -1530992060);\r\n      d = HH(d, a, b, c, m[i+ 4], 11,  1272893353);\r\n      c = HH(c, d, a, b, m[i+ 7], 16, -155497632);\r\n      b = HH(b, c, d, a, m[i+10], 23, -1094730640);\r\n      a = HH(a, b, c, d, m[i+13],  4,  681279174);\r\n      d = HH(d, a, b, c, m[i+ 0], 11, -358537222);\r\n      c = HH(c, d, a, b, m[i+ 3], 16, -722521979);\r\n      b = HH(b, c, d, a, m[i+ 6], 23,  76029189);\r\n      a = HH(a, b, c, d, m[i+ 9],  4, -640364487);\r\n      d = HH(d, a, b, c, m[i+12], 11, -421815835);\r\n      c = HH(c, d, a, b, m[i+15], 16,  530742520);\r\n      b = HH(b, c, d, a, m[i+ 2], 23, -995338651);\r\n\r\n      a = II(a, b, c, d, m[i+ 0],  6, -198630844);\r\n      d = II(d, a, b, c, m[i+ 7], 10,  1126891415);\r\n      c = II(c, d, a, b, m[i+14], 15, -1416354905);\r\n      b = II(b, c, d, a, m[i+ 5], 21, -57434055);\r\n      a = II(a, b, c, d, m[i+12],  6,  1700485571);\r\n      d = II(d, a, b, c, m[i+ 3], 10, -1894986606);\r\n      c = II(c, d, a, b, m[i+10], 15, -1051523);\r\n      b = II(b, c, d, a, m[i+ 1], 21, -2054922799);\r\n      a = II(a, b, c, d, m[i+ 8],  6,  1873313359);\r\n      d = II(d, a, b, c, m[i+15], 10, -30611744);\r\n      c = II(c, d, a, b, m[i+ 6], 15, -1560198380);\r\n      b = II(b, c, d, a, m[i+13], 21,  1309151649);\r\n      a = II(a, b, c, d, m[i+ 4],  6, -145523070);\r\n      d = II(d, a, b, c, m[i+11], 10, -1120210379);\r\n      c = II(c, d, a, b, m[i+ 2], 15,  718787259);\r\n      b = II(b, c, d, a, m[i+ 9], 21, -343485551);\r\n\r\n      a = (a + aa) >>> 0;\r\n      b = (b + bb) >>> 0;\r\n      c = (c + cc) >>> 0;\r\n      d = (d + dd) >>> 0;\r\n    }\r\n\r\n    return crypt.endian([a, b, c, d]);\r\n  };\r\n\r\n  // Auxiliary functions\r\n  md5._ff  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & c | ~b & d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._gg  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & d | c & ~d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._hh  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b ^ c ^ d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._ii  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n\r\n  // Package private blocksize\r\n  md5._blocksize = 16;\r\n  md5._digestsize = 16;\r\n\r\n  module.exports = function (message, options) {\r\n    if (message === undefined || message === null)\r\n      throw new Error('Illegal argument ' + message);\r\n\r\n    var digestbytes = crypt.wordsToBytes(md5(message, options));\r\n    return options && options.asBytes ? digestbytes :\r\n        options && options.asString ? bin.bytesToString(digestbytes) :\r\n        crypt.bytesToHex(digestbytes);\r\n  };\r\n\r\n})();\r\n","import { parseCSV } from './parseCSV';\nimport { stringify } from './stringify';\nimport { structChart } from './Chart';\nimport { structInfoData, structLineData } from './structInfo';\nimport md5 from 'md5';\n// @ts-expect-error: vite-plugin-worker-loader\nimport Zip from '@/zip.worker?worker';\n\nexport var file2= undefined as unknown as File;\n\nexport class FileEmitter extends EventTarget {\n  private readonly input: HTMLInputElement;\n\n  // // 假设这个函数返回一个文件的URL  \n  // private async fetchFileFromPath(filePath: string): Promise<Blob> {\n  //   const response = await fetch(filePath);\n  //   if (!response.ok) {\n  //     throw new Error(`Failed to fetch file: ${filePath}`);\n  //   }\n  //   return response.blob();\n  // }\n\n  // 触发文件加载的事件  \n  private fireFileLoaded(files: File): boolean {\n    return this.dispatchEvent(Object.assign(new Event('load'), { files }));\n  }\n\n  // 构造函数和其他代码...  \n  public constructor() {\n    super();\n    this.input = document.createElement('input');\n    this.input.type = 'file';\n    this.input.accept = '';\n    this.input.multiple = true;\n\n    // 原始 onchange 事件处理器  \n    this.input.onchange = () => {\n      this.fireChange(this.input.files);\n      for (const file of this.input.files || []) {\n        // 加载文件\n        const reader = new FileReader();\n        reader.readAsArrayBuffer(file);\n        reader.onprogress = evt => this.fireProgress(evt.loaded, evt.total);\n        reader.onload = evt => evt.target && evt.target.result instanceof ArrayBuffer && this.fireLoad(file, evt.target.result);\n      }\n\n      // // 假设您有一个方法来从某个地方调用以模拟文件选择  \n      // this.simulateFileSelection = async (filePath: string) => {\n      //   try {\n      //     // 从URL加载文件  \n      //     const blob = await this.fetchFileFromPath(filePath);\n      //     // 将Blob转换为File对象（如果需要，可以添加文件名和其他属性）  \n      //     const file = new File([blob], 'downloaded_file.zip', { type: 'application/zip' });\n      //     // 创建一个文件列表（因为我们可能一次只处理一个文件）  \n      //     const files = [file];\n\n      //     // 触发自定义的 change 事件，或者您可以直接调用后续的处理函数  \n      //     this.fireFileLoaded(files);\n\n      //     // 如果您希望这些文件也出现在 input 元素的 files 列表中（通常不推荐，因为用户未实际选择它们）  \n      //     // 注意：这通常不是标准行为，并且可能因浏览器而异  \n      //     // Object.defineProperty(this.input, 'files', {  \n      //     //   value: FileList.from(files),  \n      //     //   writable: false,  \n      //     //   enumerable: true  \n      //     // }); // 注意：FileList.from 不是标准API，这里只是示意  \n\n      //     // 由于我们不能直接修改 input.files，我们通常不这样做，而是使用自定义事件或直接调用处理函数  \n      //   } catch (error) {\n      //     console.error('Error loading file:', error);\n      //   }\n      // };\n    }\n  }\n\n  public uploadFile(): void {\n    this.input.webkitdirectory = false;\n    this.input.click();\n  }\n  public uploadDir(): void {\n    this.input.webkitdirectory = true;\n    this.input.click();\n  }\n  public fireChange(files: FileList | null): boolean {\n    return this.dispatchEvent(Object.assign(new Event('change'), { files }));\n  }\n  public fireProgress(loaded: number, total: number): boolean {\n    return this.dispatchEvent(new ProgressEvent('progress', { lengthComputable: true, loaded, total }));\n  }\n  public fireLoad(file: Pick<File, 'name'>, buffer: ArrayBuffer): boolean {\n    return this.dispatchEvent(Object.assign(new ProgressEvent('load'), { file, buffer }));\n  }\n\n  public async simulateFileSelection(filePath: string): Promise<void> {  \n    try {  \n      // 从 URL 加载文件  \n      const blob = await this.fetchFileFromPath(filePath);  \n      // 将 Blob 转换为 File 对象  \n      const file = new File([blob], filePath, { type: 'application/zip' });  \n      // 触发自定义的 change 事件，或调用处理函数  \n      file2=file\n      this.fireFileLoaded(file);  \n    } catch (error) {  \n      console.error('Error loading file:', error);  \n    }  \n  }  \n  \n  // 私有方法，用于从 URL 加载 Blob  \n  private async fetchFileFromPath(filePath: string): Promise<Blob> {  \n    const response = await fetch(filePath);  \n    if (!response.ok) {  \n      throw new Error(`Failed to fetch file: ${filePath}`);  \n    }  \n    return response.blob();  \n  }  \n\n  // 注意：上面的 simulateFileSelection 方法签名与构造函数内的私有方法冲突，我已在构造函数内的方法前添加了 `this.` 前缀以区分它们  \n  // 但实际上，您可能希望将构造函数内的私有方法重命名为其他名称，以避免混淆  \n}\n\n// 注意：我修改了 simulateFileSelection 方法的签名，以使其与构造函数内的私有方法不同。  \n// 在实际应用中，您可能希望将私有方法重命名为不同的名称，以避免潜在的命名冲突。\n\n\nexport class ZipReader extends EventTarget {\n  public total: number;\n  private worker: Worker | null;\n  private readonly handler: (data: ByteData) => Promise<unknown>;\n  public constructor({ handler = async data => Promise.resolve(data) }: ReaderOptions) {\n    super();\n    this.worker = null;\n    this.total = 0;\n    this.handler = handler;\n  }\n  public read(zipData: ByteData): void {\n    if (!this.worker) {\n      this.dispatchEvent(new CustomEvent('loadstart'));\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      const worker = new Zip() as Worker; // 以后考虑indexedDB存储url\n      worker.addEventListener('message', msg => {\n        const handler = async () => {\n          const { data } = msg as { data: { data: ByteData; total: number } };\n          this.total = data.total;\n          const result = await this.handler(data.data);\n          this.dispatchEvent(new CustomEvent('read', { detail: result }));\n        };\n        handler().catch((e: unknown) => this.dispatchEvent(new CustomEvent('error', { detail: e })));\n      });\n      this.worker = worker;\n    }\n    this.worker.postMessage(zipData, [zipData.buffer]);\n  }\n  public terminate(): void {\n    if (this.worker) {\n      this.worker.terminate();\n      this.worker = null;\n    }\n  }\n}\ninterface ReaderInit {\n  pattern: RegExp;\n  /** binary(not text)/text(not json)/json */\n  type?: 'binary' | 'json' | 'text';\n  mustMatch?: boolean;\n  weight?: number;\n  read: (data: ByteData, options?: Record<string, unknown>) => Promise<ReaderData | null> | ReaderData | null;\n}\nfunction defineReader(readerInit: ReaderInit): ByteReader {\n  const { pattern, type = 'binary', mustMatch = false, weight = 0, read } = readerInit;\n  const reader = { pattern, type, mustMatch, weight, read };\n  if (type === 'text') {\n    reader.read = async (i: ByteData) => {\n      if (i.isText == null) {\n        try {\n          i.text = stringify(i.buffer);\n          i.isText = true;\n        } catch (error) {\n          i.isText = false;\n        }\n      }\n      return i.isText ? read(i) : null;\n    };\n  }\n  if (type === 'json') {\n    reader.read = async (i: ByteData) => {\n      if (i.isText == null) {\n        try {\n          i.text = stringify(i.buffer);\n          i.isText = true;\n        } catch (error) {\n          i.isText = false;\n        }\n      }\n      if (i.isJSON == null) {\n        try {\n          i.data = JSON.parse(i.text!);\n          i.isJSON = true;\n        } catch (error) {\n          i.isJSON = false;\n        }\n      }\n      return i.isJSON ? read(i) : null;\n    };\n  }\n  return reader;\n}\nconst readerInits: ReaderInit[] = [\n  {\n    pattern: /\\.(mp3|ogg|wav|mp4|webm|ogv|mpg|mpeg|avi|mov|flv|wmv|mkv)$/i,\n    async read(i: ByteData, { createAudioBuffer }: Record<string, unknown> = {}): Promise<MediaReaderData> {\n      return readMediaData(i, async (arraybuffer: ArrayBuffer) => {\n        if (typeof createAudioBuffer === 'function') return createAudioBuffer(arraybuffer) as AudioBuffer;\n        return defaultDecode(arraybuffer);\n      });\n    }\n  }, {\n    pattern: /\\.json$/i,\n    type: 'json',\n    read(i: ByteData): ChartReaderData {\n      const text = i.text!;\n      const json = JSON.parse(text, (_, value) => typeof value === 'number' ? Math.fround(value) : value as unknown) as ChartPGS;\n      const { data: jsonData, messages } = structChart(json, i.pathname);\n      const format = `PGS(${jsonData.formatVersion})`;\n      return { pathname: i.pathname, type: 'chart', md5: md5(text), data: jsonData, msg: messages, format };\n    }\n  }, {\n    pattern: /\\.(png|jpg|jpeg|gif|bmp|webp|svg)$/i,\n    async read(i: ByteData): Promise<ImageReaderData> {\n      const data = new Blob([i.buffer]);\n      const imageData = await createImageBitmap(data);\n      return { pathname: i.pathname, type: 'image', data: imageData };\n    }\n  }, {\n    pattern: /^line\\.csv$/i,\n    type: 'text',\n    mustMatch: true,\n    read(i: ByteData): ChartLineReaderData {\n      const { path } = splitPath(i.pathname);\n      const data = i.text!;\n      const chartLine = structLineData(parseCSV(data, true), path);\n      return { pathname: i.pathname, type: 'line', data: chartLine };\n    }\n  }, {\n    pattern: /^info\\.csv$/i,\n    type: 'text',\n    mustMatch: true,\n    read(i: ByteData): ChartInfoReaderData {\n      const { path } = splitPath(i.pathname);\n      const data = i.text!;\n      const chartInfo = structInfoData(parseCSV(data, true), path);\n      return { pathname: i.pathname, type: 'info', data: chartInfo };\n    }\n  }\n];\nasync function defaultDecode(arraybuffer: ArrayBuffer) {\n  const actx: AudioContext = new self.AudioContext();\n  await actx.close();\n  // return actx.decodeAudioData(arraybuffer);\n  return new Promise((resolve: (value: AudioBuffer) => void, reject) => {\n    const a = actx.decodeAudioData(arraybuffer, resolve, reject);\n    if (a instanceof Promise) a.then(resolve, reject);\n  }).catch((e: unknown) => {\n    if (e instanceof Error) throw e;\n    throw new DOMException('Unable to decode audio data', 'EncodingError');\n  });\n}\nfunction createReader(define: ((readerInit: ReaderInit) => ByteReader)) {\n  const readers = readerInits.map(define);\n  return {\n    async read(i: ByteData, options = {}): Promise<ReaderData> {\n      const { name } = splitPath(i.pathname);\n      const filtered = readers.filter(a => a.pattern.test(name) || !a.mustMatch);\n      filtered.sort((a, b) => {\n        if (a.pattern.test(name) && !b.pattern.test(name)) return -1;\n        if (!a.pattern.test(name) && b.pattern.test(name)) return 1;\n        if (a.weight > b.weight) return -1;\n        if (a.weight < b.weight) return 1;\n        return 0;\n      });\n      const errors = [] as Error[];\n      const errorHandler = (reader: ByteReader, err: Error) => {\n        if (reader.pattern.test(name)) errors.push(err);\n      };\n      for (const reader of filtered) {\n        try {\n          const data = await reader.read(i, options);\n          if (data) return data;\n        } catch (err) {\n          errorHandler(reader, err as Error);\n        }\n      }\n      return { pathname: i.pathname, type: 'unknown', data: errors.join('\\n') }; // TODO: 完善错误信息\n    },\n    use(readerInit: ReaderInit | ReaderInit[]) {\n      if (Array.isArray(readerInit)) {\n        for (const reader of readerInit) this.use(reader);\n      } else {\n        readers.push(define(readerInit));\n      }\n    }\n  } as const;\n}\nexport const reader = createReader(defineReader);\nexport function splitPath(i: string): { name: string; path: string } {\n  const j = i.lastIndexOf('/');\n  const name = i.slice(j + 1);\n  const path = ~j ? i.slice(0, j) : '';\n  return { name, path };\n}\nasync function readMediaData(i: ByteData, createAudioBuffer: (arraybuffer: ArrayBuffer) => Promise<AudioBuffer>) {\n  const videoElement = document.createElement('video');\n  await new Promise(resolve => {\n    videoElement.src = URL.createObjectURL(new Blob([i.buffer]));\n    videoElement.preload = 'metadata';\n    videoElement.onloadedmetadata = resolve;\n    videoElement.onerror = resolve;\n  });\n  return {\n    pathname: i.pathname,\n    type: 'media',\n    data: {\n      audio: await createAudioBuffer(i.buffer.slice(0)),\n      video: videoElement.videoWidth && videoElement.videoHeight ? videoElement : null\n    }\n  } as MediaReaderData;\n}\n","type HitType = 'keyboard' | 'mouse' | 'touch';\nclass HitEvent {\n  public type: HitType;\n  public id: number | string;\n  public offsetX: number;\n  public offsetY: number;\n  public isActive: boolean;\n  public isTapped: boolean;\n  public isMoving: boolean;\n  public lastDeltaX: number;\n  public lastDeltaY: number;\n  public nowDeltaX: number;\n  public nowDeltaY: number;\n  public deltaTime: number;\n  public currentTime: number;\n  public flicking: boolean;\n  public flicked: boolean;\n  public constructor(type: HitType, id: number | string, offsetX: number, offsetY: number) {\n    this.type = type;\n    this.id = id;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.isActive = true; // 是否标记为按下，若false则可以移除\n    this.isTapped = false; // 是否触发过Tap判定\n    this.isMoving = false; // 是否正在移动\n    // flick(speed)\n    this.lastDeltaX = 0;\n    this.lastDeltaY = 0;\n    this.nowDeltaX = 0;\n    this.nowDeltaY = 0;\n    this.deltaTime = 0; // 按下时间差\n    this.currentTime = performance.now(); // 按下时间\n    this.flicking = false; // 是否触发Flick判定\n    this.flicked = false; // 是否触发过Flick判定\n  }\n  public move(offsetX: number, offsetY: number): void {\n    this.lastDeltaX = this.nowDeltaX;\n    this.lastDeltaY = this.nowDeltaY;\n    this.nowDeltaX = offsetX - this.offsetX;\n    this.nowDeltaY = offsetY - this.offsetY;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    const time = performance.now();\n    this.deltaTime = time - this.currentTime;\n    this.currentTime = time;\n    this.isMoving = true;\n    const flickSpeed = (this.nowDeltaX * this.lastDeltaX + this.nowDeltaY * this.lastDeltaY) / Math.sqrt(this.lastDeltaX ** 2 + this.lastDeltaY ** 2) / this.deltaTime;\n    if (this.flicking && flickSpeed < 0.5) {\n      this.flicking = false;\n      this.flicked = false;\n    } else if (!this.flicking && flickSpeed > 1.0) this.flicking = true;\n  }\n}\nexport class HitManager {\n  public list: HitEvent[];\n  public constructor() {\n    this.list = [];\n  }\n  public activate(type: HitType, id: number | string, offsetX: number, offsetY: number): void {\n    const { list } = this;\n    const idx = list.findIndex(hit => hit.type === type && hit.id === id);\n    if (idx !== -1) list.splice(idx, 1);\n    list.push(new HitEvent(type, id, offsetX, offsetY));\n  }\n  public moving(type: HitType, id: number | string, offsetX: number, offsetY: number): void {\n    const hitEl = this.list.find(hit => hit.type === type && hit.id === id);\n    if (hitEl) hitEl.move(offsetX, offsetY);\n  }\n  public deactivate(type: HitType, id: number | string): void {\n    const hitEl = this.list.find(hit => hit.type === type && hit.id === id);\n    if (hitEl) hitEl.isActive = false;\n  }\n  public update(): void {\n    const { list } = this;\n    for (let i = 0; i < list.length; i++) {\n      const hitEl = list[i];\n      if (hitEl.isActive) {\n        hitEl.isTapped = true;\n        hitEl.isMoving = false;\n      } else list.splice(i--, 1);\n    }\n  }\n  public clear(type: HitType): void {\n    for (const i of this.list) if (i.type === type) this.deactivate(type, i.id);\n  }\n}\nexport class JudgeEvent {\n  public offsetX: number;\n  public offsetY: number;\n  public type: number;\n  public judged: boolean;\n  public event?: HitEvent;\n  public preventBad: boolean;\n  public constructor(offsetX: number, offsetY: number, type: number, event?: HitEvent) {\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.type = type | 0; // 1-Tap,2-Hold/Drag,3-Move\n    this.judged = false; // 是否被判定\n    this.event = event; // Flick专用回调\n    this.preventBad = false; // 是否阻止判定为Bad\n  }\n}\n","export class Stat {\n  public level: number;\n  public noteRank: [number, number, number, number, number, number, number, number];\n  public combos: [number, number, number, number, number];\n  public maxcombo: number;\n  public combo: number;\n  private cumDisp: number;\n  private curDisp: number;\n  private numDisp: number;\n  private numOfNotes: number;\n  private data: Record<string, string>;\n  private id: string;\n  public format: string;\n  public constructor() {\n    this.level = 0;\n    this.noteRank = [0, 0, 0, 0, 0, 0, 0, 0];\n    this.combos = [0, 0, 0, 0, 0];\n    this.cumDisp = 0;\n    this.curDisp = 0;\n    this.numDisp = 0;\n    this.maxcombo = 0;\n    this.combo = 0;\n    this.numOfNotes = 0;\n    this.data = {};\n    this.id = '';\n    this.format = '';\n  }\n  public get good(): number {\n    return this.noteRank[7] + this.noteRank[3];\n  }\n  public get bad(): number {\n    return this.noteRank[6] + this.noteRank[2];\n  }\n  public get great(): number {\n    return this.noteRank[5] + this.noteRank[1];\n  }\n  public get perfect(): number {\n    return this.noteRank[4] + this.great;\n  }\n  public get all(): number {\n    return this.perfect + this.good + this.bad;\n  }\n  public get scoreNum(): number {\n    const a = 1e6 * (this.perfect * 0.9 + this.good * 0.585 + this.maxcombo * 0.1) / this.numOfNotes;\n    return isFinite(a) ? a : 0;\n  }\n  public get scoreStr(): string {\n    const a = this.scoreNum.toFixed(0);\n    return '0'.repeat(a.length < 7 ? 7 - a.length : 0) + a;\n  }\n  public get accNum(): number {\n    const a = (this.perfect + this.good * 0.65) / this.all;\n    return isFinite(a) ? a : 1;\n  }\n  public get accStr(): string {\n    return `${(100 * this.accNum).toFixed(2)}\\uff05`;\n  }\n  public get avgDispStr(): string {\n    const a = Math.trunc(this.cumDisp / this.numDisp * 1e3) || 0;\n    return `${a > 0 ? '+' : ''}${a.toFixed(0)}ms`;\n  }\n  public get curDispStr(): string {\n    const a = Math.trunc(this.curDisp * 1e3);\n    return `${a > 0 ? '+' : ''}${a.toFixed(0)}ms`;\n  }\n  public get lineStatus(): 0 | 1 | 3 {\n    if (this.bad) return 0;\n    if (this.good) return 3;\n    return 1;\n  }\n  public get rankStatus(): 0 | 1 | 2 | 3 | 4 | 5 | 6 {\n    const a = Math.round(this.scoreNum);\n    if (a >= 1e6) return 0;\n    if (a >= 9.6e5) return 1;\n    if (a >= 9.2e5) return 2;\n    if (a >= 8.8e5) return 3;\n    if (a >= 8.2e5) return 4;\n    if (a >= 7e5) return 5;\n    return 6;\n  }\n  public get localData(): string {\n    const l1 = Math.round(this.accNum * 1e4 + 566).toString(22).slice(-3);\n    const l2 = Math.round(this.scoreNum + 40672).toString(32).slice(-4);\n    const l3 = this.level.toString(36).slice(-1);\n    return l1 + l2 + l3;\n  }\n  public static removeLegacy(key: string): void {\n    const item = localStorage.getItem('phi');\n    if (item == null) return;\n    localStorage.setItem(key, item);\n    localStorage.removeItem('phi');\n  }\n  public getData(isAuto: boolean, speed = ''): StatData {\n    const s1 = this.data[this.id].slice(0, 3);\n    const s2 = this.data[this.id].slice(3, 7);\n    const l1 = Math.round(this.accNum * 1e4 + 566).toString(22).slice(-3);\n    const l2 = Math.round(this.scoreNum + 40672).toString(32).slice(-4);\n    const l3 = this.level.toString(36).slice(-1);\n    const na = parseInt(s2, 32) - 40672;\n    const sa = na.toFixed(0);\n    const sb = '0'.repeat(sa.length < 7 ? 7 - sa.length : 0) + sa;\n    if (!isAuto) this.data[this.id] = (s1 > l1 ? s1 : l1) + (s2 > l2 ? s2 : l2) + l3;\n    const arr = [];\n    for (const [i, v] of Object.entries(this.data)) arr.push(i + v);\n    localStorage.setItem(`phi-${speed}`, arr.sort(() => Math.random() - 0.5).join(''));\n    const pbj = {\n      newBestColor: s2 < l2 ? '#18ffbf' : '#fff',\n      newBestStr: s2 < l2 ? 'NEW BEST' : 'BEST',\n      scoreBest: sb,\n      scoreDelta: `${s2 > l2 ? '- ' : '+ '}${Math.abs(na - Math.round(this.scoreNum))}`,\n      textAboveColor: '#65fe43',\n      textAboveStr: '  ( Speed {SPEED}x )',\n      textBelowColor: '#fe4365',\n      textBelowStr: 'AUTO PLAY'\n    };\n    if (isAuto) {\n      return Object.assign(pbj, {\n        newBestColor: '#fff',\n        newBestStr: 'BEST',\n        scoreDelta: ''\n      });\n    }\n    if (this.lineStatus === 1) {\n      return Object.assign(pbj, {\n        textBelowStr: 'ALL  PERFECT',\n        textBelowColor: '#ffc500'\n      });\n    }\n    if (this.lineStatus === 3) {\n      return Object.assign(pbj, {\n        textBelowStr: 'FULL  COMBO',\n        textBelowColor: '#00bef1'\n      });\n    }\n    return Object.assign(pbj, { textBelowStr: '' });\n  }\n  public reset(numOfNotes: number, id: string, format: string, speed = ''): void {\n    const key = `phi-${speed}`;\n    this.numOfNotes = numOfNotes | 0;\n    this.combo = 0;\n    this.maxcombo = 0;\n    this.noteRank = [0, 0, 0, 0, 0, 0, 0, 0]; // 4:PM,5:PE,1:PL,7:GE,3:GL,6:BE,2:BL\n    this.combos = [0, 0, 0, 0, 0]; // 不同种类note实时连击次数\n    this.cumDisp = 0;\n    this.curDisp = 0;\n    this.numDisp = 0;\n    if (speed === '') Stat.removeLegacy(key);\n    const str = localStorage.getItem(key) ?? (localStorage.setItem(key, ''), ''); // 初始化存储\n    for (let i = 0; i < Math.floor(str.length / 40); i++) {\n      const data = str.slice(i * 40, i * 40 + 40);\n      this.data[data.slice(0, 32)] = data.slice(-8);\n    }\n    if (id) {\n      if (!this.data[id]) this.data[id] = this.localData;\n      this.id = id;\n    }\n    this.format = format;\n  }\n  public addCombo(status: number, type: number): void {\n    this.noteRank[status]++;\n    this.combo = status % 4 === 2 ? 0 : this.combo + 1;\n    if (this.combo > this.maxcombo) this.maxcombo = this.combo;\n    this.combos[0]++;\n    this.combos[type]++;\n  }\n  public addDisp(disp: number): void {\n    this.curDisp = disp;\n    this.cumDisp += disp;\n    this.numDisp++;\n  }\n}\n","let _actx: AudioContext = null!;\nlet _gain: GainNode = null!;\nlet _msdest: MediaStreamAudioDestinationNode | null = null;\nlet _inited = false;\nconst initFnList: (() => void)[] = [];\nconst bfsList: (AudioBufferSourceNode | IntervalBufferSource)[] = [];\ninterface AudioParamOptions {\n  loop: boolean;\n  offset: number;\n  playbackrate: number;\n  interval: number;\n}\nclass IntervalBufferSource {\n  public res: AudioBuffer;\n  public loop: boolean;\n  public offset: number;\n  public playbackrate: number;\n  public interval: number;\n  public dest: AudioNode;\n  public startTime: number;\n  private _bfs: AudioBufferSourceNode | null;\n  public constructor(res: AudioBuffer, dest: AudioNode, options: AudioParamOptions) {\n    const { loop, offset, playbackrate, interval } = options;\n    this.res = res;\n    this.dest = dest;\n    this.loop = loop;\n    this.offset = offset;\n    this.playbackrate = playbackrate;\n    this.interval = interval;\n    this.startTime = NaN;\n    this._bfs = null;\n  }\n  public get bfs() {\n    return this._bfs || _actx.createBufferSource();\n  }\n  public start() {\n    this.startTime = performance.now() / 1000; // 使用actx.currentTime会有迷之延迟\n    this._loop();\n  }\n  public stop() {\n    if (!this._bfs) return;\n    this._bfs.onended = null;\n    this._bfs.stop();\n  }\n  private _loop() {\n    this._bfs = _actx.createBufferSource();\n    const bfs = this._bfs;\n    bfs.buffer = this.res;\n    bfs.loop = this.loop; // 循环播放\n    bfs.connect(this.dest);\n    bfs.playbackRate.value = this.playbackrate;\n    const currentOffset = (this.offset + (performance.now() / 1000 - this.startTime) * this.playbackrate) % this.res.duration;\n    bfs.start(_actx.currentTime, currentOffset, this.interval);\n    bfs.onended = _ => {\n      bfs.onended = null;\n      if (currentOffset + this.interval > this.res.duration && !this.loop) return;\n      this._loop();\n    };\n  }\n}\nfunction play(res: AudioBuffer, dest: AudioNode, options: AudioParamOptions): () => AudioBufferSourceNode {\n  const { loop, offset, playbackrate, interval } = options;\n  if (isFinite(interval) && interval > 0) {\n    const bufferSource = new IntervalBufferSource(res, dest, options);\n    bufferSource.start();\n    bfsList[bfsList.length] = bufferSource;\n    return () => bufferSource.bfs;\n  }\n  const bufferSource = _actx.createBufferSource();\n  bufferSource.buffer = res;\n  bufferSource.loop = loop; // 循环播放\n  bufferSource.connect(dest);\n  bufferSource.playbackRate.value = playbackrate;\n  bufferSource.start(0, offset);\n  bfsList[bfsList.length] = bufferSource;\n  return () => bufferSource;\n}\nconst audio = {\n  get actx(): AudioContext | null { return _actx },\n  get gainNode(): GainNode | null { return _gain },\n  get msdest(): MediaStreamAudioDestinationNode | null { return _msdest },\n  set msdest(msdest: MediaStreamAudioDestinationNode | null) {\n    if (msdest) _gain.connect(msdest);\n    else if (_msdest) _gain.disconnect(_msdest);\n    _msdest = msdest;\n  },\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition, @typescript-eslint/strict-boolean-expressions\n  init(context = self.AudioContext || self.webkitAudioContext): AudioContext {\n    // eslint-disable-next-line new-cap\n    _actx = new context();\n    _gain = _actx.createGain();\n    _gain.connect(_actx.destination);\n    _inited = true;\n    for (const initFn of initFnList) initFn();\n    return _actx;\n  },\n  test(callback: () => unknown): void {\n    if (_inited) callback();\n    initFnList[initFnList.length] = callback;\n  },\n  async decode(arraybuffer: ArrayBuffer): Promise<AudioBuffer> {\n    return _actx.decodeAudioData(arraybuffer);\n  },\n  mute(length: number): AudioBuffer {\n    return _actx.createBuffer(2, 44100 * length, 44100);\n  },\n  sine(length: number, frequency = 440, gain = 1): AudioBuffer {\n    const buffer = _actx.createBuffer(1, 44100 * length, 44100);\n    const data = buffer.getChannelData(0);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = Math.sin(i * frequency * 2 * Math.PI / 44100) * gain;\n    }\n    return buffer;\n  },\n  sawtooth(length: number, frequency = 440, gain = 1): AudioBuffer {\n    const buffer = _actx.createBuffer(1, 44100 * length, 44100);\n    const data = buffer.getChannelData(0);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = (i * frequency / 44100 % 1 - 0.5) * 2 * gain;\n    }\n    return buffer;\n  },\n  square(length: number, frequency = 440, gain = 1): AudioBuffer {\n    const buffer = _actx.createBuffer(1, 44100 * length, 44100);\n    const data = buffer.getChannelData(0);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = (i * frequency / 44100 % 1 < 0.5 ? 1 : -1) * gain;\n    }\n    return buffer;\n  },\n  triangle(length: number, frequency = 440, gain = 1): AudioBuffer {\n    const buffer = _actx.createBuffer(1, 44100 * length, 44100);\n    const data = buffer.getChannelData(0);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = (Math.abs((i * frequency / 44100 % 1 - 0.5) * 4) - 1) * gain;\n    }\n    return buffer;\n  },\n  noise(length: number, gain = 1): AudioBuffer {\n    const buffer = _actx.createBuffer(1, 44100 * length, 44100);\n    const data = buffer.getChannelData(0);\n    for (let i = 0; i < data.length; i++) {\n      data[i] = (Math.random() * 2 - 1) * gain;\n    }\n    return buffer;\n  },\n  play(res: AudioBuffer, options: Partial<AudioParamOptions> = {}): () => AudioBufferSourceNode {\n    const { loop = false, offset = 0, playbackrate = 1, interval = 0 } = options;\n    return play(res, _gain, { loop, offset, playbackrate, interval });\n  },\n  stop(): void {\n    for (const i of bfsList) i.stop();\n    bfsList.length = 0;\n  }\n};\nclass AudioController {\n  public gainNode: GainNode;\n  public constructor() {\n    this.gainNode = null!;\n    audio.test(this.init.bind(this));\n  }\n  private init() {\n    const gain = _actx.createGain();\n    gain.connect(_gain);\n    this.gainNode = gain;\n  }\n  public play(res: AudioBuffer, options: Partial<AudioParamOptions> = {}): () => AudioBufferSourceNode {\n    const { loop = false, offset = 0, playbackrate = 1, interval = 0 } = options;\n    return play(res, this.gainNode, { loop, offset, playbackrate, interval });\n  }\n}\nexport { audio, AudioController };\n","export default function(\n  width: number, height: number,\n  options?: CanvasRenderingContext2DSettings\n): CanvasRenderingContext2D {\n  const canvas = document.createElement('canvas');\n  Object.assign(canvas, { width, height });\n  const ctx = canvas.getContext('2d', options);\n  if (!ctx) throw new TypeError('Failed to create canvas context');\n  return ctx;\n}\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\n/* eslint-disable no-bitwise -- used for calculations */\n\n/* eslint-disable unicorn/prefer-query-selector -- aiming at\n  backward-compatibility */\n\n/**\n* StackBlur - a fast almost Gaussian Blur For Canvas\n*\n* In case you find this class useful - especially in commercial projects -\n* I am not totally unhappy for a small donation to my PayPal account\n* mario@quasimondo.de\n*\n* Or support me on flattr:\n* {@link https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript}.\n*\n* @module StackBlur\n* @author Mario Klingemann\n* Contact: mario@quasimondo.com\n* Website: {@link http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html}\n* Twitter: @quasimondo\n*\n* @copyright (c) 2010 Mario Klingemann\n*\n* Permission is hereby granted, free of charge, to any person\n* obtaining a copy of this software and associated documentation\n* files (the \"Software\"), to deal in the Software without\n* restriction, including without limitation the rights to use,\n* copy, modify, merge, publish, distribute, sublicense, and/or sell\n* copies of the Software, and to permit persons to whom the\n* Software is furnished to do so, subject to the following\n* conditions:\n*\n* The above copyright notice and this permission notice shall be\n* included in all copies or substantial portions of the Software.\n*\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n* OTHER DEALINGS IN THE SOFTWARE.\n*/\nvar mulTable = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\nvar shgTable = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n/**\n * @param {string|HTMLImageElement} img\n * @param {string|HTMLCanvasElement} canvas\n * @param {Float} radius\n * @param {boolean} blurAlphaChannel\n * @param {boolean} useOffset\n * @param {boolean} skipStyles\n * @returns {undefined}\n */\n\nfunction processImage(img, canvas, radius, blurAlphaChannel, useOffset, skipStyles) {\n  if (typeof img === 'string') {\n    img = document.getElementById(img);\n  }\n\n  if (!img || Object.prototype.toString.call(img).slice(8, -1) === 'HTMLImageElement' && !('naturalWidth' in img)) {\n    return;\n  }\n\n  var dimensionType = useOffset ? 'offset' : 'natural';\n  var w = img[dimensionType + 'Width'];\n  var h = img[dimensionType + 'Height']; // add ImageBitmap support,can blur texture source\n\n  if (Object.prototype.toString.call(img).slice(8, -1) === 'ImageBitmap') {\n    w = img.width;\n    h = img.height;\n  }\n\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || !('getContext' in canvas)) {\n    return;\n  }\n\n  if (!skipStyles) {\n    canvas.style.width = w + 'px';\n    canvas.style.height = h + 'px';\n  }\n\n  canvas.width = w;\n  canvas.height = h;\n  var context = canvas.getContext('2d');\n  context.clearRect(0, 0, w, h);\n  context.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight, 0, 0, w, h);\n\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  if (blurAlphaChannel) {\n    processCanvasRGBA(canvas, 0, 0, w, h, radius);\n  } else {\n    processCanvasRGB(canvas, 0, 0, w, h, radius);\n  }\n}\n/**\n * @param {string|HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @throws {Error|TypeError}\n * @returns {ImageData} See {@link https://html.spec.whatwg.org/multipage/canvas.html#imagedata}\n */\n\n\nfunction getImageDataFromCanvas(canvas, topX, topY, width, height) {\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || _typeof(canvas) !== 'object' || !('getContext' in canvas)) {\n    throw new TypeError('Expecting canvas with `getContext` method ' + 'in processCanvasRGB(A) calls!');\n  }\n\n  var context = canvas.getContext('2d');\n\n  try {\n    return context.getImageData(topX, topY, width, height);\n  } catch (e) {\n    throw new Error('unable to access image data: ' + e);\n  }\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGBA(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGBA(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGBA(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null,\n      stackOut = null,\n      yw = 0,\n      yi = 0;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n\n  for (var y = 0; y < height; y++) {\n    stack = stackStart;\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        pa = pixels[yi + 3];\n\n    for (var _i = 0; _i < radiusPlus1; _i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack.a = pa;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0,\n        aInSum = 0,\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        aOutSum = radiusPlus1 * pa,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb,\n        aSum = sumFactor * pa;\n\n    for (var _i2 = 1; _i2 < radiusPlus1; _i2++) {\n      var p = yi + ((widthMinus1 < _i2 ? widthMinus1 : _i2) << 2);\n      var r = pixels[p],\n          g = pixels[p + 1],\n          b = pixels[p + 2],\n          a = pixels[p + 3];\n      var rbs = radiusPlus1 - _i2;\n      rSum += (stack.r = r) * rbs;\n      gSum += (stack.g = g) * rbs;\n      bSum += (stack.b = b) * rbs;\n      aSum += (stack.a = a) * rbs;\n      rInSum += r;\n      gInSum += g;\n      bInSum += b;\n      aInSum += a;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      var paInitial = aSum * mulSum >>> shgSum;\n      pixels[yi + 3] = paInitial;\n\n      if (paInitial !== 0) {\n        var _a2 = 255 / paInitial;\n\n        pixels[yi] = (rSum * mulSum >>> shgSum) * _a2;\n        pixels[yi + 1] = (gSum * mulSum >>> shgSum) * _a2;\n        pixels[yi + 2] = (bSum * mulSum >>> shgSum) * _a2;\n      } else {\n        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n      }\n\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      aSum -= aOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      aOutSum -= stackIn.a;\n\n      var _p = x + radius + 1;\n\n      _p = yw + (_p < widthMinus1 ? _p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[_p];\n      gInSum += stackIn.g = pixels[_p + 1];\n      bInSum += stackIn.b = pixels[_p + 2];\n      aInSum += stackIn.a = pixels[_p + 3];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      aSum += aInSum;\n      stackIn = stackIn.next;\n      var _stackOut = stackOut,\n          _r = _stackOut.r,\n          _g = _stackOut.g,\n          _b = _stackOut.b,\n          _a = _stackOut.a;\n      rOutSum += _r;\n      gOutSum += _g;\n      bOutSum += _b;\n      aOutSum += _a;\n      rInSum -= _r;\n      gInSum -= _g;\n      bInSum -= _b;\n      aInSum -= _a;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x = 0; _x < width; _x++) {\n    yi = _x << 2;\n\n    var _pr = pixels[yi],\n        _pg = pixels[yi + 1],\n        _pb = pixels[yi + 2],\n        _pa = pixels[yi + 3],\n        _rOutSum = radiusPlus1 * _pr,\n        _gOutSum = radiusPlus1 * _pg,\n        _bOutSum = radiusPlus1 * _pb,\n        _aOutSum = radiusPlus1 * _pa,\n        _rSum = sumFactor * _pr,\n        _gSum = sumFactor * _pg,\n        _bSum = sumFactor * _pb,\n        _aSum = sumFactor * _pa;\n\n    stack = stackStart;\n\n    for (var _i3 = 0; _i3 < radiusPlus1; _i3++) {\n      stack.r = _pr;\n      stack.g = _pg;\n      stack.b = _pb;\n      stack.a = _pa;\n      stack = stack.next;\n    }\n\n    var yp = width;\n    var _gInSum = 0,\n        _bInSum = 0,\n        _aInSum = 0,\n        _rInSum = 0;\n\n    for (var _i4 = 1; _i4 <= radius; _i4++) {\n      yi = yp + _x << 2;\n\n      var _rbs = radiusPlus1 - _i4;\n\n      _rSum += (stack.r = _pr = pixels[yi]) * _rbs;\n      _gSum += (stack.g = _pg = pixels[yi + 1]) * _rbs;\n      _bSum += (stack.b = _pb = pixels[yi + 2]) * _rbs;\n      _aSum += (stack.a = _pa = pixels[yi + 3]) * _rbs;\n      _rInSum += _pr;\n      _gInSum += _pg;\n      _bInSum += _pb;\n      _aInSum += _pa;\n      stack = stack.next;\n\n      if (_i4 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y = 0; _y < height; _y++) {\n      var _p2 = yi << 2;\n\n      pixels[_p2 + 3] = _pa = _aSum * mulSum >>> shgSum;\n\n      if (_pa > 0) {\n        _pa = 255 / _pa;\n        pixels[_p2] = (_rSum * mulSum >>> shgSum) * _pa;\n        pixels[_p2 + 1] = (_gSum * mulSum >>> shgSum) * _pa;\n        pixels[_p2 + 2] = (_bSum * mulSum >>> shgSum) * _pa;\n      } else {\n        pixels[_p2] = pixels[_p2 + 1] = pixels[_p2 + 2] = 0;\n      }\n\n      _rSum -= _rOutSum;\n      _gSum -= _gOutSum;\n      _bSum -= _bOutSum;\n      _aSum -= _aOutSum;\n      _rOutSum -= stackIn.r;\n      _gOutSum -= stackIn.g;\n      _bOutSum -= stackIn.b;\n      _aOutSum -= stackIn.a;\n      _p2 = _x + ((_p2 = _y + radiusPlus1) < heightMinus1 ? _p2 : heightMinus1) * width << 2;\n      _rSum += _rInSum += stackIn.r = pixels[_p2];\n      _gSum += _gInSum += stackIn.g = pixels[_p2 + 1];\n      _bSum += _bInSum += stackIn.b = pixels[_p2 + 2];\n      _aSum += _aInSum += stackIn.a = pixels[_p2 + 3];\n      stackIn = stackIn.next;\n      _rOutSum += _pr = stackOut.r;\n      _gOutSum += _pg = stackOut.g;\n      _bOutSum += _pb = stackOut.b;\n      _aOutSum += _pa = stackOut.a;\n      _rInSum -= _pr;\n      _gInSum -= _pg;\n      _bInSum -= _pb;\n      _aInSum -= _pa;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGB(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGB(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGB(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null;\n  var stackOut = null;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n  var p, rbs;\n  var yw = 0,\n      yi = 0;\n\n  for (var y = 0; y < height; y++) {\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb;\n    stack = stackStart;\n\n    for (var _i5 = 0; _i5 < radiusPlus1; _i5++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0;\n\n    for (var _i6 = 1; _i6 < radiusPlus1; _i6++) {\n      p = yi + ((widthMinus1 < _i6 ? widthMinus1 : _i6) << 2);\n      rSum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - _i6);\n      gSum += (stack.g = pg = pixels[p + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[p + 2]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      pixels[yi] = rSum * mulSum >>> shgSum;\n      pixels[yi + 1] = gSum * mulSum >>> shgSum;\n      pixels[yi + 2] = bSum * mulSum >>> shgSum;\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[p];\n      gInSum += stackIn.g = pixels[p + 1];\n      bInSum += stackIn.b = pixels[p + 2];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x2 = 0; _x2 < width; _x2++) {\n    yi = _x2 << 2;\n\n    var _pr2 = pixels[yi],\n        _pg2 = pixels[yi + 1],\n        _pb2 = pixels[yi + 2],\n        _rOutSum2 = radiusPlus1 * _pr2,\n        _gOutSum2 = radiusPlus1 * _pg2,\n        _bOutSum2 = radiusPlus1 * _pb2,\n        _rSum2 = sumFactor * _pr2,\n        _gSum2 = sumFactor * _pg2,\n        _bSum2 = sumFactor * _pb2;\n\n    stack = stackStart;\n\n    for (var _i7 = 0; _i7 < radiusPlus1; _i7++) {\n      stack.r = _pr2;\n      stack.g = _pg2;\n      stack.b = _pb2;\n      stack = stack.next;\n    }\n\n    var _rInSum2 = 0,\n        _gInSum2 = 0,\n        _bInSum2 = 0;\n\n    for (var _i8 = 1, yp = width; _i8 <= radius; _i8++) {\n      yi = yp + _x2 << 2;\n      _rSum2 += (stack.r = _pr2 = pixels[yi]) * (rbs = radiusPlus1 - _i8);\n      _gSum2 += (stack.g = _pg2 = pixels[yi + 1]) * rbs;\n      _bSum2 += (stack.b = _pb2 = pixels[yi + 2]) * rbs;\n      _rInSum2 += _pr2;\n      _gInSum2 += _pg2;\n      _bInSum2 += _pb2;\n      stack = stack.next;\n\n      if (_i8 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x2;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y2 = 0; _y2 < height; _y2++) {\n      p = yi << 2;\n      pixels[p] = _rSum2 * mulSum >>> shgSum;\n      pixels[p + 1] = _gSum2 * mulSum >>> shgSum;\n      pixels[p + 2] = _bSum2 * mulSum >>> shgSum;\n      _rSum2 -= _rOutSum2;\n      _gSum2 -= _gOutSum2;\n      _bSum2 -= _bOutSum2;\n      _rOutSum2 -= stackIn.r;\n      _gOutSum2 -= stackIn.g;\n      _bOutSum2 -= stackIn.b;\n      p = _x2 + ((p = _y2 + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;\n      _rSum2 += _rInSum2 += stackIn.r = pixels[p];\n      _gSum2 += _gInSum2 += stackIn.g = pixels[p + 1];\n      _bSum2 += _bInSum2 += stackIn.b = pixels[p + 2];\n      stackIn = stackIn.next;\n      _rOutSum2 += _pr2 = stackOut.r;\n      _gOutSum2 += _pg2 = stackOut.g;\n      _bOutSum2 += _pb2 = stackOut.b;\n      _rInSum2 -= _pr2;\n      _gInSum2 -= _pg2;\n      _bInSum2 -= _pb2;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n *\n */\n\n\nvar BlurStack =\n/**\n * Set properties.\n */\nfunction BlurStack() {\n  _classCallCheck(this, BlurStack);\n\n  this.r = 0;\n  this.g = 0;\n  this.b = 0;\n  this.a = 0;\n  this.next = null;\n};\n\nexport { BlurStack, processCanvasRGB as canvasRGB, processCanvasRGBA as canvasRGBA, processImage as image, processImageDataRGB as imageDataRGB, processImageDataRGBA as imageDataRGBA };\n","import createCtx from './createCtx';\nimport { canvasRGBA } from 'stackblur-canvas';\n// 十六进制color转rgba数组\nexport function hex2rgba(color: string): Uint8ClampedArray {\n  const ctx = createCtx(1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\nexport async function imgPainter(img: ImageBitmap, color: string, limit = 512): Promise<ImageBitmap> {\n  const dataRGBA = hex2rgba(color);\n  const ctx = createCtx(img.width, img.height, { willReadFrequently: true }); // Warning\n  ctx.drawImage(img, 0, 0);\n  for (let dy = 0; dy < img.height; dy += limit) {\n    for (let dx = 0; dx < img.width; dx += limit) {\n      const imgData = ctx.getImageData(dx, dy, limit, limit);\n      for (let i = 0; i < imgData.data.length / 4; i++) {\n        imgData.data[i * 4] = dataRGBA[0];\n        imgData.data[i * 4 + 1] = dataRGBA[1];\n        imgData.data[i * 4 + 2] = dataRGBA[2];\n        imgData.data[i * 4 + 3] *= dataRGBA[3] / 255;\n      }\n      ctx.putImageData(imgData, dx, dy);\n    }\n  }\n  return createImageBitmap(ctx.canvas);\n}\nexport async function imgBlur(img: ImageBitmap): Promise<ImageBitmap> {\n  const ctx = createCtx(img.width, img.height);\n  const { width: w, height: h } = ctx.canvas;\n  ctx.drawImage(img, 0, 0);\n  canvasRGBA(ctx.canvas, 0, 0, w, h, Math.ceil(Math.min(w, h) * 0.0125));\n  return createImageBitmap(ctx.canvas);\n}\nexport async function imgShader(img: ImageBitmap, color: string, limit = 512): Promise<ImageBitmap> {\n  const dataRGBA = hex2rgba(color);\n  const ctx = createCtx(img.width, img.height, { willReadFrequently: true }); // warning\n  ctx.drawImage(img, 0, 0);\n  for (let dy = 0; dy < img.height; dy += limit) {\n    for (let dx = 0; dx < img.width; dx += limit) {\n      const imgData = ctx.getImageData(dx, dy, limit, limit);\n      for (let i = 0; i < imgData.data.length / 4; i++) {\n        imgData.data[i * 4] *= dataRGBA[0] / 255;\n        imgData.data[i * 4 + 1] *= dataRGBA[1] / 255;\n        imgData.data[i * 4 + 2] *= dataRGBA[2] / 255;\n        imgData.data[i * 4 + 3] *= dataRGBA[3] / 255;\n      }\n      ctx.putImageData(imgData, dx, dy);\n    }\n  }\n  return createImageBitmap(ctx.canvas);\n}\nexport namespace ImgAny{\n  export function decode(img: ImageBitmap, border = 0): ArrayBuffer {\n    const ctx1 = createCtx(img.width - border * 2, img.height - border * 2);\n    ctx1.drawImage(img, -border, -border);\n    const id = ctx1.getImageData(0, 0, ctx1.canvas.width, ctx1.canvas.width);\n    const ab = new Uint8Array(id.data.length / 4 * 3);\n    for (let i = 0; i < ab.length; i++) ab[i] = id.data[(i / 3 | 0) * 4 + i % 3] ^ i * 3473;\n    const size = new DataView(ab.buffer, 0, 4).getUint32(0);\n    return ab.buffer.slice(4, size + 4);\n  }\n  export function decodeAlt(img: ImageBitmap): ArrayBuffer {\n    const ctx = createCtx(img.width, img.height);\n    ctx.drawImage(img, 0, 0);\n    const id = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n    const ab = new Uint8Array(id.data.length / 4 * 3);\n    const mask = (v = 0, i = 0) => v ^ i ** 2 * 3473 & 255;\n    for (let i = 0; i < ab.length; i++) ab[i] = id.data[(i / 3 | 0) * 4 + i % 3];\n    const combined = new Uint8Array(ab.length / 2);\n    for (let i = 0; i < ab.length / 2; i++) combined[i] = mask((ab[i * 2] + 8) / 17 << 4 | (ab[i * 2 + 1] + 8) / 17, i);\n    const size = new DataView(combined.buffer, 0, 4).getUint32(0);\n    return combined.buffer.slice(4, size + 4);\n  }\n}\nexport async function imgSplit(img: ImageBitmap, limitX?: number, limitY?: number): Promise<ImageBitmap[]> {\n  const dx = Math.floor(limitX ?? Math.min(img.width, img.height));\n  const dy = Math.floor(limitY ?? dx);\n  const arr = [];\n  for (let sy = 0; sy < img.height; sy += dy) {\n    for (let sx = 0; sx < img.width; sx += dx) {\n      arr.push(createImageBitmap(img, sx, sy, dx, dy));\n    }\n  }\n  return Promise.all(arr);\n}\n","export class Checkbox {\n  public container: HTMLDivElement;\n  public checkbox: HTMLInputElement;\n  public label: HTMLLabelElement;\n  public constructor(text: string, checked = false) {\n    this.container = document.createElement('div');\n    this.checkbox = document.createElement('input');\n    this.checkbox.type = 'checkbox';\n    this.checkbox.id = Utils.randomUUID();\n    this.checkbox.checked = checked;\n    this.label = document.createElement('label');\n    this.label.htmlFor = this.checkbox.id;\n    this.label.textContent = text;\n    this.container.appendChild(this.checkbox);\n    this.container.appendChild(this.label);\n  }\n  public get checked(): boolean {\n    return this.checkbox.checked;\n  }\n  public set checked(value: boolean) {\n    this.checkbox.checked = value;\n    this.checkbox.dispatchEvent(new Event('change'));\n  }\n  public appendTo(container: HTMLElement): this {\n    container.appendChild(this.container);\n    return this;\n  }\n  public appendBefore(node: HTMLElement): this {\n    if (node.parentNode == null) throw new Error('Node must have a parent node');\n    node.parentNode.insertBefore(this.container, node);\n    return this;\n  }\n  public toggle(): void {\n    this.checked = !this.checkbox.checked;\n  }\n  public hook(callback: (arg0: HTMLInputElement, arg1: HTMLDivElement) => void): this {\n    callback(this.checkbox, this.container);\n    return this;\n  }\n}\n","interface HitEventsOptions<T> {\n  updateCallback?: (arg0: T) => boolean;\n  iterateCallback?: (arg0: T) => void;\n}\nexport class HitEvents<T> extends Array<T> {\n  public update: () => void;\n  public animate: () => void;\n  public constructor({\n    updateCallback = () => false,\n    iterateCallback = () => {}\n  }: HitEventsOptions<T> = {}) {\n    super();\n    this.update = this.defilter.bind(this, updateCallback);\n    this.animate = this.iterate.bind(this, iterateCallback);\n  }\n  private defilter(predicate: (arg0: T) => boolean): this {\n    let i = this.length;\n    while (i--) if (predicate(this[i])) this.splice(i, 1);\n    return this;\n  }\n  private iterate(callback: (arg0: T) => void): void {\n    for (const i of this) callback(i);\n  }\n  public add(value: T): void {\n    this[this.length] = value;\n  }\n  public clear(): void {\n    this.length = 0;\n  }\n}\n","export class HitFeedback {\n  public offsetX: number;\n  public offsetY: number;\n  public color: string;\n  public text: string;\n  public time: number;\n  public constructor(offsetX: number, offsetY: number, n1: string, n2: string) {\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.color = n1;\n    this.text = n2;\n    this.time = 0;\n  }\n  public static tap(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Tap', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'cyan', '');\n  }\n  public static hold(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Hold', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'lime', '');\n  }\n  public static move(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Move', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'violet', '');\n  }\n}\n","import type { Renderer } from '@/core';\nimport type { ScaledNote } from './ScaledNote';\nexport class HitImage {\n  public offsetX: number;\n  public offsetY: number;\n  public time: number;\n  public duration: number;\n  public effects: ScaledNote[];\n  public direction: number[][];\n  public color: string;\n  public constructor(offsetX: number, offsetY: number, n1: string, n3: string) {\n    const packs = hook.noteRender.hitFX[n1]; // TODO: Refactor\n    this.offsetX = offsetX || 0;\n    this.offsetY = offsetY || 0;\n    this.time = performance.now();\n    this.duration = packs.duration;\n    this.effects = packs.effects;\n    this.direction = Array(packs.numOfParts || 0).fill(0).map(() => [Math.random() * 80 + 185, Math.random() * 2 * Math.PI]);\n    this.color = n3;\n  }\n  public static perfect(offsetX: number, offsetY: number, _note: Renderer.Note): HitImage {\n    // console.log(note);\n    return new HitImage(offsetX, offsetY, 'Perfect', '#ffeca0');\n  }\n  public static good(offsetX: number, offsetY: number, _note: Renderer.Note): HitImage {\n    // console.log(note);\n    return new HitImage(offsetX, offsetY, 'Good', '#b4e1ff');\n  }\n}\n","export class HitWord {\n  public offsetX: number;\n  public offsetY: number;\n  public time: number;\n  public duration: number;\n  public color: string;\n  public text: string;\n  public constructor(offsetX: number, offsetY: number, n1: string, n2: string) {\n    this.offsetX = offsetX || 0;\n    this.offsetY = offsetY || 0;\n    this.time = performance.now();\n    this.duration = 250;\n    this.color = n1;\n    this.text = n2;\n  }\n  public static early(offsetX: number, offsetY: number): HitWord {\n    // console.log('Tap', offsetX, offsetY);\n    return new HitWord(offsetX, offsetY, '#03aaf9', 'Early');\n  }\n  public static late(offsetX: number, offsetY: number): HitWord {\n    // console.log('Hold', offsetX, offsetY);\n    return new HitWord(offsetX, offsetY, '#ff4612', 'Late');\n  }\n}\n","export class ScaledNote {\n  public full: (ctx: CanvasRenderingContext2D) => void;\n  public head: (ctx: CanvasRenderingContext2D) => void;\n  public body: (ctx: CanvasRenderingContext2D, offset: number, length: number) => void;\n  public tail: (ctx: CanvasRenderingContext2D, offset: number) => void;\n  // private readonly img: ImageBitmap;\n  // private readonly scale: number;\n  public constructor(img: ImageBitmap, scale: number, compacted = false) {\n    // this.img = img;\n    // this.scale = scale;\n    const dx = -img.width / 2 * scale;\n    const dy = -img.height / 2 * scale;\n    const dw = img.width * scale;\n    const dh = img.height * scale;\n    this.full = ctx => ctx.drawImage(img, dx, dy, dw, dh);\n    this.head = ctx => ctx.drawImage(img, dx, 0, dw, dh);\n    this.body = (ctx, offset, length) => ctx.drawImage(img, dx, offset, dw, length);\n    this.tail = (ctx, offset) => ctx.drawImage(img, dx, offset - dh, dw, dh);\n    if (compacted) {\n      this.head = ctx => ctx.drawImage(img, dx, dy, dw, dh);\n      this.tail = (ctx, offset) => ctx.drawImage(img, dx, offset - dh - dy, dw, dh);\n    }\n  }\n}\n","interface Size {\n  width: number;\n  height: number;\n}\n// 调节画面尺寸和全屏相关(返回source播放aegleseeker会出现迷之error)\nexport function adjustSize(source: Size, dest: Size, scale: number): [number, number, number, number] {\n  const { width: sw, height: sh } = source;\n  const { width: dw, height: dh } = dest;\n  if (dw * sh > dh * sw) return [dw * (1 - scale) / 2, (dh - dw * sh / sw * scale) / 2, dw * scale, dw * sh / sw * scale];\n  return [(dw - dh * sw / sh * scale) / 2, dh * (1 - scale) / 2, dh * sw / sh * scale, dh * scale];\n}\n","class BetterMessageBox {\n  public host: string;\n  public code: number;\n  public name: string;\n  public target: string;\n  public list: BetterMessage[];\n  public updateHTML: (...args: any[]) => void;\n  public constructor(msg: BetterMessage) {\n    this.host = msg.host;\n    this.code = msg.code;\n    this.name = msg.name;\n    this.target = msg.target;\n    this.list = [msg];\n    this.updateHTML = () => {};\n  }\n  public appendMessage(msg: BetterMessage): boolean {\n    if (this.host !== msg.host) return false;\n    if (this.code !== msg.code) return false;\n    if (this.name !== msg.name) return false;\n    if (this.target !== msg.target) return false;\n    this.list.push(msg);\n    this.updateHTML();\n    return true;\n  }\n}\nexport abstract class MessageHandler {\n  private lastMessage = '';\n  private readonly betterMessageBoxes: BetterMessageBox[];\n  public abstract nodeText: HTMLElement;\n  public abstract nodeView: HTMLElement;\n  public constructor() {\n    this.betterMessageBoxes = [];\n  }\n  private addBox(type = 'warn'): HTMLDivElement {\n    const msgbox = document.createElement('div');\n    msgbox.setAttribute('type', type);\n    msgbox.classList.add('msgbox');\n    return this.nodeView.appendChild(msgbox);\n  }\n  private removeNodeBox(nodeBox: HTMLDivElement): void {\n    nodeBox.remove();\n    this.updateText(this.lastMessage);\n  }\n  private removeBetterMessageBox(msgbox: BetterMessageBox): void {\n    const index = this.betterMessageBoxes.indexOf(msgbox);\n    if (index !== -1) this.betterMessageBoxes.splice(index, 1);\n  }\n  private msgbox(msg = '', type = '', fatal = false): void {\n    const msgbox = this.addBox(type);\n    msgbox.innerHTML = msg;\n    const btn = document.createElement('a');\n    btn.innerText = '忽略';\n    btn.style.float = 'right';\n    btn.onclick = () => this.removeNodeBox(msgbox);\n    btn.classList.toggle('disabled', fatal);\n    msgbox.appendChild(btn);\n  }\n  private bmsgbox(msg: BetterMessage): BetterMessageBox {\n    const msgbox = new BetterMessageBox(msg);\n    const page = { page: 1, size: 5, get pages() { return Math.ceil(msgbox.list.length / this.size) } };\n    // 日志文本\n    const text = document.createTextNode('');\n    // 按钮[全部忽略]\n    const btnIgnoreAll = document.createElement('a');\n    btnIgnoreAll.innerText = '全部忽略';\n    btnIgnoreAll.classList.add('bm-rbtn');\n    // 当前页数(可编辑)\n    const nodePageNum = document.createElement('span');\n    nodePageNum.textContent = String(page.page);\n    nodePageNum.contentEditable = 'true';\n    nodePageNum.style.cssText = ';color:red;outline:none;text-decoration:underline';\n    // 总页数\n    const nodePages = document.createElement('span');\n    nodePages.textContent = String(page.pages);\n    // 按钮[上一页]\n    const btnPrevousPage = document.createElement('a');\n    btnPrevousPage.innerText = '上一页';\n    // 按钮[下一页]\n    const btnNextPage = document.createElement('a');\n    btnNextPage.innerText = '下一页';\n    // 控制栏\n    const nodeControl = document.createElement('div');\n    nodeControl.classList.add('bm-item');\n    nodeControl.append(nodePageNum, ' / ', nodePages, ' 页 ', btnPrevousPage, ' ', btnNextPage);\n    // 消息框\n    const nodeBMsg = this.addBox(['notice', 'warn', 'error'][msgbox.code]);\n    nodeBMsg.append(text, btnIgnoreAll, nodeControl);\n    // 脚本\n    btnIgnoreAll.setAttribute('bm-ctrl', '');\n    nodeControl.setAttribute('bm-ctrl', '');\n    const updatePage = (num: number) => {\n      if (!isNaN(num)) page.page = Math.max(1, Math.min(num, page.pages));\n      nodePageNum.textContent = String(page.page);\n      msgbox.updateHTML();\n    };\n    nodePageNum.onblur = () => updatePage(parseInt(nodePageNum.textContent!));\n    btnPrevousPage.onclick = () => updatePage(page.page - 1);\n    btnNextPage.onclick = () => updatePage(page.page + 1);\n    btnIgnoreAll.onclick = () => {\n      this.removeBetterMessageBox(msgbox);\n      this.removeNodeBox(nodeBMsg);\n    };\n    // 防抖\n    let timer = 0;\n    msgbox.updateHTML = () => {\n      clearTimeout(timer);\n      timer = self.setTimeout(() => {\n        const { pages } = page;\n        if (page.page > pages) page.page = pages;\n        const start = (page.page - 1) * page.size;\n        text.textContent = `${msgbox.code ? `${msgbox.host}: 检测到 ${msgbox.list.length} 个 ${msgbox.name}\\n` : ''}来自 ${msgbox.target}`;\n        nodePageNum.textContent = String(page.page);\n        nodePages.textContent = String(pages);\n        for (const elem of nodeBMsg.querySelectorAll('[bm-ctrl]')) elem.classList.toggle('hide', pages <= 1);\n        for (const elem of nodeBMsg.querySelectorAll('[bm-cell]')) elem.remove();\n        for (const bmsg of msgbox.list.slice(start, start + page.size)) {\n          const btnIgnore = document.createElement('a');\n          btnIgnore.innerText = '忽略';\n          btnIgnore.classList.add('bm-rbtn');\n          btnIgnore.onclick = () => {\n            msgbox.list.splice(msgbox.list.indexOf(bmsg), 1);\n            msgbox.updateHTML();\n            if (msgbox.list.length === 0) {\n              this.removeBetterMessageBox(msgbox);\n              this.removeNodeBox(nodeBMsg);\n            } else this.updateText(this.lastMessage);\n          };\n          const div = document.createElement('div');\n          div.setAttribute('bm-cell', '');\n          div.classList.add('bm-item');\n          div.append(`${bmsg.name}: ${bmsg.message}`, btnIgnore);\n          nodeBMsg.appendChild(div);\n        }\n      });\n    };\n    this.betterMessageBoxes.push(msgbox);\n    return msgbox;\n  }\n  private getBetterMessageBox(msg: BetterMessage): BetterMessageBox {\n    for (const i of this.betterMessageBoxes) {\n      if (i.appendMessage(msg)) return i;\n    }\n    return this.bmsgbox(msg);\n  }\n  public updateText(msg = '', type = ''): void {\n    const num = this.nodeView.querySelectorAll('.msgbox[type=warn]').length + this.betterMessageBoxes.reduce((a, b) => a + b.list.length - 1, 0);\n    if (type === 'error') {\n      this.nodeText.className = 'error';\n      this.nodeText.innerText = msg;\n    } else {\n      this.nodeText.className = num ? 'warning' : 'accept';\n      this.nodeText.innerText = msg + (num ? `（发现${num}个问题，点击查看）` : '');\n      this.lastMessage = msg;\n    }\n  }\n  public sendWarning(msg: BetterMessage | string = '', isHTML = false): void {\n    if (typeof msg === 'string') this.msgbox(isHTML ? msg : Utils.escapeHTML(msg), 'warn');\n    else this.getBetterMessageBox(msg).updateHTML();\n    this.updateText(this.lastMessage);\n  }\n  public sendError(msg = '', html = '', fatal = false): void {\n    if (html) {\n      const exp = /([A-Za-z][A-Za-z+-.]{2,}:\\/\\/|www\\.)[^\\s\\x00-\\x20\\x7f-\\x9f\"]{2,}[^\\s\\x00-\\x20\\x7f-\\x9f\"!'),.:;?\\]}]/g;\n      const ahtml = html.replace(exp, (match = '') => {\n        const url = match.startsWith('www.') ? `//${match}` : match;\n        const rpath = match.replace(`${location.origin}/`, '');\n        if (match.includes(location.origin)) return `<a href=\"#\"style=\"color:#023b8f;text-decoration:underline;\">${rpath}</a>`;\n        return `<a href=\"${url}\"target=\"_blank\"style=\"color:#023b8f;text-decoration:underline;\">${rpath}</a>`;\n      });\n      this.msgbox(ahtml, 'error', fatal);\n    }\n    this.updateText(msg, 'error');\n  }\n}\n","const table = { sp: [0, 0], ez: [1, 7], hd: [3, 13], in: [6, 15], at: [13, 16] } as const;\nconst keys = ['ez', 'hd', 'in', 'at'] as const;\ntype DifficultyLowerCase = keyof typeof table;\ntype Difficulty = Uppercase<DifficultyLowerCase | ''>;\nexport class LevelInfoHandler {\n  private readonly selectDifficulty: HTMLSelectElement;\n  private readonly selectLevel: HTMLSelectElement;\n  public text = '';\n  public constructor(selectDifficulty: HTMLSelectElement, selectLevel: HTMLSelectElement) {\n    this.selectDifficulty = selectDifficulty;\n    this.selectLevel = selectLevel;\n    Object.keys(table).forEach(key => this.selectDifficulty.add(new Option(key.toUpperCase())));\n    for (let i = 0; i < 17; i++) this.selectLevel.add(new Option(String(i || '?')));\n    this.selectDifficulty.addEventListener('change', () => this.updateInternal(0));\n    this.selectLevel.addEventListener('change', () => this.updateInternal(1));\n    this.updateInternal(-1);\n  }\n  private updateInternal(type: number): void {\n    let diffStr = (this.selectDifficulty.value || 'SP').toLowerCase() as DifficultyLowerCase;\n    let levelNum = Number(this.selectLevel.value) | 0;\n    if (type === 0) {\n      const diff = table[diffStr];\n      if (levelNum < diff[0]) levelNum = diff[0];\n      if (levelNum > diff[1]) levelNum = diff[1];\n      this.selectLevel.value = String(levelNum || '?');\n    } else if (type === 1) {\n      if (table[diffStr][1] < levelNum) diffStr = keys.find(key => table[key][1] >= levelNum) || 'sp';\n      else if (table[diffStr][0] > levelNum) diffStr = keys.findLast(key => table[key][0] <= levelNum) || 'sp';\n      this.selectDifficulty.value = diffStr.toUpperCase() as Difficulty;\n    }\n    const diffString = this.selectDifficulty.value;\n    const levelString = this.selectLevel.value;\n    this.text = [diffString, levelString].join('\\u2002Lv.');\n  }\n  public updateLevelText(level: string): void {\n    this.text = level;\n    const p = this.text.toUpperCase().split('LV.').map(a => a.trim());\n    if (p[0]) this.selectDifficulty.value = p[0];\n    if (p[1]) this.selectLevel.value = p[1];\n  }\n  public getDifficultyIndex(): number {\n    return ['ez', 'hd', 'in', 'at'].indexOf(this.text.slice(0, 2).toLowerCase());\n  }\n  public getLevelNumber(): number {\n    return Number(/\\d+$/.exec(this.text));\n  }\n}\n","import './style.css';\nimport {getChartFilePath, init} from \"@/office\";\n///<reference path=\"../public/utils/dist/office.d.ts\" />\nimport { lastupdate, pubdate, version } from '../scripts/meta.json';\nimport { full, orientation } from '@/js/common.js';\nimport { FrameAnimater } from '@/components/FrameAnimater';\nimport { FrameTimer } from '@/components/FrameTimer';\nimport { Timer } from '@/components/Timer';\nimport { FileEmitter, ZipReader, file2, reader } from '@/utils/reader';\nimport { Renderer } from '@/core';\nimport { HitManager, JudgeEvent } from '@/components/HitManager';\nimport { Stat } from '@/components/Stat';\nimport { InteractProxy, audio } from '@/external';\nimport createCtx from '@/utils/createCtx';\nimport { ImgAny, imgBlur, imgPainter, imgShader, imgSplit } from '@/utils/ImageTools';\nimport { Checkbox, HitEvents, HitFeedback, HitImage, HitWord, ScaledNote, StatusManager } from '@/components';\nimport { Stage } from '@/components/Stage';\nimport { checkSupport } from '@/utils/checkSupport';\nimport { adjustSize } from '@/utils/adjustSize';\nimport { fixme } from '@/utils/fixme';\nimport { MessageHandler } from '@/components/MessageHandler';\nimport { AudioController } from '@/utils/AudioTools';\nimport { LevelInfoHandler } from '@/components/InfoHandler';\nconst meta = ['Phixos', version.split('.'), pubdate, lastupdate] as typeof self._i;\nself._i = meta;\nconst $id = (query: string): HTMLElement => document.getElementById(query) || (() => { throw new Error(`Cannot find element: ${query}`) })();\nconst $ = (query: string) => document.body.querySelector(query);\nconst $$ = (query: string) => document.body.querySelectorAll(query);\nconst viewNav = $id('view-nav') as HTMLDivElement;\nconst viewCfg = $id('view-cfg') as HTMLDivElement;\nconst viewMsg = $id('view-msg') as HTMLDivElement;\nconst viewNav2 = $id('view-nav2') as HTMLDivElement;\nconst viewRmg = $id('view-rmg') as HTMLDivElement;\nconst viewExt = $id('view-ext') as HTMLDivElement;\nconst coverDark = $id('cover-dark') as HTMLDivElement;\nconst coverRmg = $id('cover-rmg') as HTMLDivElement;\nconst coverView = $id('cover-view') as HTMLDivElement;\n// const buttonRmg = $id('btn-rmg') as HTMLInputElement;\nconst buttonDocs = $id('btn-docs') as HTMLInputElement;\nconst buttonMore = $id('btn-more') as HTMLInputElement;\nconst anchorCfg = $id('nav-cfg') as HTMLAnchorElement;\nconst anchorMsg = $id('nav-msg') as HTMLAnchorElement;\n// const anchorRmg = $id('nav-rmg') as HTMLAnchorElement;\nconst strongOut = $id('msg-out');\nconst blockUploader = $id('uploader') as HTMLDivElement;\nconst stageEl = $id('stage') as HTMLDivElement;\nconst selectNoteScale = $id('select-note-scale') as HTMLSelectElement;\nconst selectAspectRatio = $id('select-aspect-ratio') as HTMLSelectElement;\nconst selectBackgroundDim = $id('select-background-dim') as HTMLSelectElement;\nconst checkHighLight = $id('highLight') as HTMLInputElement;\nconst inputOffset = $id('input-offset') as HTMLInputElement;\nconst lineColor = $id('lineColor') as HTMLInputElement;\nconst checkAutoPlay = $id('autoplay') as HTMLInputElement;\nconst showTransition = $id('showTransition') as HTMLInputElement;\nconst checkFeedback = $id('feedback') as HTMLInputElement;\nconst checkImageBlur = $id('imageBlur') as HTMLInputElement;\nconst selectbg = $id('select-bg') as HTMLSelectElement;\nconst btnPlay = $id('btn-play') as HTMLInputElement;\nconst btnPause = $id('btn-pause') as HTMLInputElement;\nconst selectbgm = $id('select-bgm') as HTMLSelectElement;\nconst selectchart = $id('select-chart') as HTMLSelectElement;\nconst selectflip = $id('select-flip') as HTMLSelectElement;\nconst selectspeed = $id('select-speed') as HTMLSelectElement;\nconst inputName = $id('input-name') as HTMLInputElement;\nconst inputArtist = $id('input-artist') as HTMLInputElement;\nconst inputCharter = $id('input-charter') as HTMLInputElement;\nconst inputIllustrator = $id('input-illustrator') as HTMLInputElement;\nconst selectDifficulty = $id('select-difficulty') as HTMLSelectElement;\nconst selectLevel = $id('select-level') as HTMLSelectElement;\nconst levelInfoHandler = new LevelInfoHandler(selectDifficulty, selectLevel);\nconst selectVolume = $id('select-volume') as HTMLSelectElement;\nconst blockSelect = $id('select') as HTMLDivElement;\nconst blockMask = $id('mask') as HTMLDivElement;\nconst tween = {\n  easeInSine: (t: number) => 1 - Math.cos(t * Math.PI / 2),\n  easeOutSine: (t: number) => Math.sin(t * Math.PI / 2),\n  easeOutCubic: (t: number) => 1 + (t - 1) ** 3\n};\nconst time2Str = (time = 0) => `${Math.floor(time / 60)}:${`00${Math.floor(time % 60)}`.slice(-2)}`;\ninterface MainOptions {\n  modify: (chart: Chart) => Chart;\n  pressTime: number;\n  before: Map<string, () => Promise<void> | void>;\n  now: Map<string, (time: number) => void>;\n  after: Map<string, () => void>;\n  afterAll: Map<string, () => void>;\n  end: Map<string, () => Promise<void> | void>;\n  customDraw: ((ctx: CanvasRenderingContext2D) => void) | null;\n  filter: ((ctx: CanvasRenderingContext2D, time: number, now: number) => CanvasImageSource) | null;\n  filterOptions: Record<string, unknown>;\n  handleFile: (tag: string, total: number, promise: Promise<unknown>, oncomplete?: () => void) => Promise<unknown>;\n  uploader: typeof uploader;\n  awawa: boolean;\n  fireModal: (navHTML: HTMLElement | string, contentHTML: HTMLElement | string) => HTMLDivElement;\n  toast: (msg: string) => HTMLDivElement;\n  error: (msg?: string) => HTMLDivElement;\n  define: (arg0: ModuleConfig) => ModuleConfig;\n  use: (module: Promise<ModuleBase>) => Promise<unknown>;\n  stat: typeof stat;\n  app: typeof app;\n  res: typeof res;\n  audio: typeof audio;\n  sendText: (msg?: string, type?: string) => void;\n  sendWarning: (msg?: BetterMessage | string, isHTML?: boolean) => void;\n  sendError: (msg?: string, html?: string, fatal?: boolean) => void;\n  frameAnimater: typeof frameAnimater;\n  timeEnd: typeof timeEnd;\n  bgms: typeof bgms;\n  inputName: typeof inputName;\n  selectbgm: typeof selectbgm;\n  selectchart: typeof selectchart;\n  chartsMD5: typeof chartsMD5;\n  noteRender: typeof noteRender;\n  reader: typeof reader;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  ZipReader: typeof ZipReader;\n  status: typeof status;\n  tmps: typeof tmps;\n}\nexport const main = {} as MainOptions;\nmain.modify = a => a;\nmain.pressTime = 0;\nmain.before = new Map();\nmain.now = new Map();\nmain.after = new Map();\nmain.afterAll = new Map();\nmain.end = new Map();\nmain.filter = null;\nmain.filterOptions = {};\ndocument.oncontextmenu = e => e.preventDefault();\nfor (const thisElem of viewNav.children) {\n  thisElem.addEventListener('click', function(this: HTMLElement) {\n    for (const elem of viewNav.children) elem.classList.toggle('active', elem === this);\n    // if (!viewDoc.src) { viewDoc.src = 'docs/use.html' } // 避免阻塞页面\n    // viewDoc.classList.toggle('hide', this.id !== 'nav-use');\n    viewCfg.classList.toggle('hide', this.id !== 'nav-cfg');\n    viewMsg.classList.toggle('hide', this.id !== 'nav-msg');\n  });\n}\nfor (const thisElem of viewNav2.children) {\n  thisElem.addEventListener('click', function(this: HTMLElement) {\n    for (const elem of viewNav2.children) elem.classList.toggle('active', elem === this);\n    viewRmg.classList.toggle('hide', this.id !== 'nav-rmg');\n    viewExt.classList.toggle('hide', this.id !== 'nav-ext');\n  });\n}\ncoverDark.addEventListener('click', () => {\n  coverDark.classList.add('fade');\n  coverRmg.classList.add('fade');\n  coverView.classList.add('fade');\n});\n// buttonRmg.addEventListener('click', () => {\n//   coverDark.classList.remove('fade');\n//   coverRmg.classList.remove('fade');\n//   anchorRmg.click();\n// });\nbuttonDocs.addEventListener('click', () => {\n  main.fireModal('<p>提示</p>', '<p><a href=\"https://docs.lchz\\x68.net/project/sim-phi-core\" target=\"_blank\">点击此处</a>查看sim-phi的使用说明<br><a href=\"https://github.com/html5syt/sim-phi-Office\" target=\"_blank\">点击此处</a>查看Office插件的使用说明<br>无法访问请挂梯子，插件目录下也有离线版本的使用说明。</p>');\n});\nbuttonMore.addEventListener('click', () => {\n  coverDark.classList.remove('fade');\n  coverView.classList.remove('fade');\n  anchorCfg.click();\n});\nstrongOut.addEventListener('click', () => {\n  coverDark.classList.remove('fade');\n  coverView.classList.remove('fade');\n  anchorMsg.click();\n});\nconst msgHandler = new class extends MessageHandler {\n  public nodeView = viewMsg;\n  public nodeText = strongOut;\n}();\nconst sendText = msgHandler.updateText.bind(msgHandler);\nconst sendWarning = msgHandler.sendWarning.bind(msgHandler);\nconst sendError = msgHandler.sendError.bind(msgHandler);\nconst stat = new Stat();\nconst stage = new Stage(stageEl);\nconst app = new Renderer(stageEl); // test\nconst { canvas, ctx, canvasfg, ctxfg } = app;\nself.addEventListener('resize', () => stage.resize());\nclass Emitter extends EventTarget {\n  private status: string;\n  public constructor(statusInit = '') {\n    super();\n    this.status = statusInit;\n  }\n  public emit(status = '') {\n    if (this.status === status) return;\n    this.status = status;\n    this.dispatchEvent(new Event('change'));\n  }\n  public eq(status = '') {\n    return this.status === status;\n  }\n  public ne(status = '') {\n    return this.status !== status;\n  }\n}\n// @ts-ignore\nconst emitter = new Emitter('stop');\nconst status2 = {\n  text: '',\n  list: [] as { toString: (target: EventTarget) => void }[],\n  reg(target: EventTarget, type: string, handler: (target: EventTarget) => string) {\n    this.list[this.list.length] = { toString: () => handler(target) };\n    target.addEventListener(type, this.update.bind(this));\n  },\n  update() {\n    const arr = this.list.map(String).filter(Boolean);\n    this.text = arr.length === 0 ? '' : `(${arr.join('+')})`;\n  }\n};\nclass ImageStore {\n  public base: ImageBitmap;\n  public width: number;\n  public height: number;\n  private _blur: ImageBitmap | null;\n  public constructor(image: ImageBitmap) {\n    this.base = image;\n    this.width = image.width;\n    this.height = image.height;\n    this._blur = null;\n  }\n  public get blur() {\n    this.setBlur();\n    return this._blur || this.base;\n  }\n  public async setBlur() {\n    this.setBlur = async() => {};\n    this._blur = await imgBlur(this.base);\n  }\n}\nconst bgs = new Map() as Map<string, ImageStore>;\nconst bgms = new Map() as Map<string, MediaData>;\nconst charts = new Map() as Map<string, Chart>;\nconst chartsMD5 = new Map() as Map<string, string>;\nconst chartsFormat = new Map() as Map<string, string>;\nconst chartLineDataList: ChartLineData[] = []; // line.csv\nconst chartInfoDataList: ChartInfoData[] = []; // info.csv\nselectNoteScale.addEventListener('change', evt => app.setNoteScale(Number((evt.target as HTMLSelectElement).value)));\nselectAspectRatio.addEventListener('change', evt => stage.resize(Number((evt.target as HTMLSelectElement).value)));\nselectBackgroundDim.addEventListener('change', evt => app.brightness = Number((evt.target as HTMLSelectElement).value));\ncheckHighLight.addEventListener('change', evt => app.multiHint = (evt.target as HTMLInputElement).checked);\nconst status = new StatusManager('sim-phi-status').init(data => data.resetCfg);\nstatus.reg('feedback', checkFeedback);\nstatus.reg('imageBlur', checkImageBlur);\nstatus.reg('highLight', checkHighLight);\nstatus.reg('lineColor', lineColor);\nstatus.reg('autoplay', checkAutoPlay);\nstatus.reg('showTransition', showTransition);\nconst resetCfg = new Checkbox('恢复默认设置(刷新生效)').appendTo(viewCfg).hook(status.reg.bind(status, 'resetCfg'));\nconst showCE2 = new Checkbox('Early/Late特效').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showCE2'));\nconst showPoint = new Checkbox('显示定位点').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showPoint'));\nconst showAcc = new Checkbox('显示Acc').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showAcc'));\nconst showStat = new Checkbox('显示统计').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showStat'));\nconst lowRes = new Checkbox('低分辨率').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'lowRes'));\nconst lockOri = new Checkbox('横屏锁定', true).appendBefore(resetCfg.container).hook(status.reg.bind(status, 'lockOri'));\nconst maxFrame = new Checkbox('限制帧率').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'maxFrame'));\nconst autoDelay = new Checkbox('音画实时同步(若声音卡顿则建议关闭)', true).appendBefore(resetCfg.container).hook(status.reg.bind(status, 'autoDelay'));\nconst enableVP = new Checkbox('隐藏距离较远的音符').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'enableVP'));\nenableVP.checkbox.addEventListener('change', evt => app.enableVP = (evt.target as HTMLInputElement).checked);\nenableVP.checkbox.dispatchEvent(new Event('change'));\nconst enableFR = new Checkbox('使用单精度浮点运算').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'enableFR'));\nenableFR.checkbox.addEventListener('change', evt => app.enableFR = (evt.target as HTMLInputElement).checked);\nenableFR.checkbox.dispatchEvent(new Event('change'));\nselectflip.addEventListener('change', evt => app.mirrorView(Number((evt.target as HTMLInputElement).value)));\nstatus.reg('selectFlip', selectflip);\nselectspeed.addEventListener('change', evt => {\n  const dict = { slowest: -9, slower: -4, faster: 3, fastest: 5 } as Record<string, number | undefined>;\n  app.speed = 2 ** ((dict[(evt.target as HTMLInputElement).value.toLowerCase()] ?? 0) / 12);\n});\nstatus.reg('selectSpeed', selectspeed);\n// 自动填写歌曲信息\nfunction adjustInfo() {\n  for (const data of chartInfoDataList) {\n    if (selectchart.value.trim() === data.chart) {\n      if (data.name != null) inputName.value = data.name;\n      if (data.artist != null) inputArtist.value = data.artist;\n      if (data.level != null) levelInfoHandler.updateLevelText(data.level);\n      if (data.illustrator != null) inputIllustrator.value = data.illustrator;\n      if (data.charter != null) inputCharter.value = data.charter;\n      if (data.music != null && bgms.has(data.music)) selectbgm.value = data.music;\n      if (data.image != null && bgs.has(data.image)) {\n        selectbg.value = data.image;\n        selectbg.dispatchEvent(new Event('change'));\n      }\n      if (data.aspectRatio != null) {\n        selectAspectRatio.value = data.aspectRatio.toString();\n        stage.resize(data.aspectRatio);\n      }\n      if (data.noteScale != null) {\n        selectNoteScale.value = data.noteScale.toString();\n        app.setNoteScale(data.noteScale);\n      }\n      if (data.backgroundDim != null) {\n        selectBackgroundDim.value = data.backgroundDim.toString();\n        app.brightness = data.backgroundDim;\n      }\n      if (data.offset != null) inputOffset.value = data.offset.toString();\n    }\n  }\n}\n// Uploader\nexport const uploader = new FileEmitter();\n(function() {\n  const dones: Record<string, number> = {};\n  const totals: Record<string, number> = {};\n  let uploaderDone = 0;\n  let uploaderTotal = 0;\n  const handleFile = async(tag: string, total: number, promise: unknown, oncomplete?: () => void) => {\n    totals[tag] = total;\n    uploaderTotal = Object.values(totals).reduce((a, b) => a + b, 0);\n    await (promise instanceof Promise ? promise : Promise.resolve(promise));\n    dones[tag] = (dones[tag] || 0) + 1;\n    uploaderDone = Object.values(dones).reduce((a, b) => a + b, 0);\n    sendText(`读取文件：${uploaderDone}/${uploaderTotal}`);\n    if (dones[tag] === totals[tag] && oncomplete != null) oncomplete();\n    loadComplete();\n  };\n  main.handleFile = handleFile;\n  // let fileTotal = 0;\n  const options = { async createAudioBuffer(_: ArrayBuffer) { return audio.decode(_) } };\n  const zip = new ZipReader({ handler: async data => reader.read(data, options) });\n  zip.addEventListener('loadstart', () => sendText('加载zip组件...'));\n  // 监听zip文件的read事件\n  zip.addEventListener('read', evt => { \n    // 处理zip文件，传入zip文件的总数和pick函数处理后的detail\n    handleFile('zip', zip.total, pick((evt as CustomEvent<ReaderData>).detail)) \n  });\n  uploader.addEventListener('change', loadComplete);\n  uploader.addEventListener('load', async evt => {\n    console.log(evt);\n    var buffer=await file2.arrayBuffer()\n    const data: ByteData = { pathname: getChartFilePath(), buffer };\n\n  zip.read(data);\n    // else handler();\n  });\n  function pick(data: ReaderData) {\n    console.log(data);\n    switch (data.type) {\n      case 'line':\n        chartLineDataList.push(...data.data);\n        break;\n      case 'info':\n        chartInfoDataList.push(...data.data);\n        break;\n      case 'media': {\n        const basename = getUniqueName(data.pathname, bgms);\n        bgms.set(basename, data.data);\n        selectbgm.appendChild(createOption(basename, data.pathname));\n        selectbgm.dispatchEvent(new Event('change'));\n        break;\n      }\n      case 'image': {\n        const basename = getUniqueName(data.pathname, bgs);\n        bgs.set(basename, new ImageStore(data.data));\n        selectbg.appendChild(createOption(basename, data.pathname));\n        selectbg.dispatchEvent(new Event('change'));\n        break;\n      }\n      case 'chart': {\n        if (data.msg) {\n          data.msg.forEach(v => {\n            if (typeof v === 'string') sendWarning(v);\n            else sendWarning({ ...v, target: data.pathname });\n          });\n        }\n        if (data.info) chartInfoDataList.push(...data.info);\n        if (data.line) chartLineDataList.push(...data.line);\n        const basename = getUniqueName(data.pathname, charts);\n        charts.set(basename, data.data);\n        chartsMD5.set(basename, data.md5);\n        chartsFormat.set(basename, data.format);\n        selectchart.appendChild(createOption(basename, data.pathname));\n        selectchart.dispatchEvent(new Event('change'));\n        break;\n      }\n      default:\n        console.warn(`Unsupported file: ${data.pathname}`);\n        console.log(data.data);\n        sendWarning(`不支持的文件：${data.pathname}\\n${data.data as string || 'Error: Unknown File Type'}`);\n    }\n  }\n  function createOption(value: string, innerhtml: string) {\n    const option = document.createElement('option');\n    const isHidden = /(^|\\/)\\./.test(innerhtml);\n    option.innerHTML = isHidden ? '' : innerhtml;\n    option.value = value;\n    if (isHidden) option.classList.add('hide');\n    return option;\n  }\n  function loadComplete() {\n    if (uploaderDone === uploaderTotal) {\n      blockUploader.classList.remove('disabled');\n      adjustInfo();\n    } else blockUploader.classList.add('disabled');\n  }\n  function getUniqueName(name: string, set: Map<string, unknown>): string {\n    let basename = name;\n    while (set.has(basename)) basename += '\\n';\n    return basename;\n  }\n}());\nmain.uploader = uploader;\nconst isBeta = String(meta[1][3]).startsWith('b');\nconst resLink = atob('aHR0cHM6Ly9sY2h6aC5uZXQvZGF0YS9wYWNrLmpzb24=');\n// const resLink = 'local/ptres.json';\nimport('@/plugins/demo/index.js').then(a => a.default(isBeta));\n// Hit start\nconst hitManager = new HitManager();\nconst exitFull = () => {\n  if (full.onchange) document.removeEventListener(full.onchange, exitFull);\n  hitManager.clear('keyboard'); // Esc退出全屏只有onchange事件能检测到\n  stage.setFull(full.check());\n  stage.resize();\n};\n// TODO: better way to handle this\n//@ts-ignore\nconst timeIn = new Timer();\nconst timeOut = new Timer();\nconst timeEnd = new Timer();\nconst specialClick = {\n  time: [0, 0, 0, 0],\n  func: [\n    async() => Promise.resolve().then(mainPause),\n    async() => Promise.resolve().then(mainPlay).then(mainPlay),\n    async() => Promise.resolve().then(() => showStat.toggle()),\n    async() => {\n      const isFull = stage.getFull();\n      try {\n        await full.toggle();\n        if (!stage.setFull(full.check())) return;\n        if (full.onchange) document.addEventListener(full.onchange, exitFull);\n        if (!lockOri.checked) return;\n        await orientation.lockLandscape();\n      } catch (e) {\n        console.warn(e); // TODO: 未知错误处理\n        stage.setFull(!isFull);\n      } finally {\n        stage.resize();\n      }\n    }\n  ],\n  click(id: number) {\n    const now = performance.now();\n    if (now - this.time[id] < 300) {\n      this.func[id]().catch((e: unknown) => {\n        console.warn(e);\n        const msg = e instanceof Error ? e.message : String(e);\n        main.toast(`按太多下了！(${msg})`); // TODO: 忽略操作\n      });\n    }\n    this.time[id] = now;\n  },\n  activate(offsetX: number, offsetY: number) {\n    const { lineScale } = app;\n    if (offsetX < lineScale * 1.5 && offsetY < lineScale * 1.5) this.click(0);\n    if (offsetX > canvasfg.width - lineScale * 1.5 && offsetY < lineScale * 1.5) this.click(1);\n    if (offsetX < lineScale * 1.5 && offsetY > canvasfg.height - lineScale * 1.5) this.click(2);\n    if (offsetX > canvasfg.width - lineScale * 1.5 && offsetY > canvasfg.height - lineScale * 1.5) this.click(3);\n    if (timeEnd.second > 0) main.pressTime = main.pressTime > 0 ? -timeEnd.second : timeEnd.second;\n  }\n};\nfunction getJudgeOffset(judgeEvent: JudgeEvent, note: Renderer.Note) {\n  const { offsetX, offsetY } = judgeEvent;\n  const { offsetX: x, offsetY: y, cosr, sinr } = note;\n  return Math.abs((offsetX - x) * cosr + (offsetY - y) * sinr) || 0;\n}\nfunction getJudgeDistance(judgeEvent: JudgeEvent, note: Renderer.Note) {\n  const { offsetX, offsetY } = judgeEvent;\n  const { offsetX: x, offsetY: y, cosr, sinr } = note;\n  return Math.abs((offsetX - x) * cosr + (offsetY - y) * sinr) + Math.abs((offsetX - x) * sinr - (offsetY - y) * cosr) || 0;\n}\nconst res = {} as ResourceMap; // 存放资源\nlet nowTimeMS = 0; // 当前绝对时间(ms)\nlet curTime = 0; // 最近一次暂停的音乐时间(s)\nlet curTimeMS = 0; // 最近一次播放的绝对时间(ms)\nlet timeBgm = 0; // 当前音乐时间(s)\nlet timeChart = 0; // 当前谱面时间(s)\nlet duration0 = 0; // 音乐时长(s)\nlet isInEnd = false; // 开头过渡动画\nlet isOutStart = false; // 结尾过渡动画\nlet isOutEnd = false; // 临时变量\n// 必要组件\nconst musicController = new AudioController();\n//@ts-ignore\nconst soundController = new AudioController();\nconst frameTimer = new FrameTimer();\nconst frameAnimater = new FrameAnimater();\nframeAnimater.setCallback(mainLoop);\nconst handlerHide = () => { if (document.visibilityState === 'hidden' && emitter.eq('play')) mainPause(); };\ndocument.addEventListener('visibilitychange', handlerHide);\ndocument.addEventListener('pagehide', handlerHide); // 兼容Safari\nlet isOutOver = false;\nlet tempStat = null as StatData | null;\nconst tmps = {\n  bgImage: null as unknown as ImageBitmap,\n  bgVideo: null as HTMLVideoElement | null,\n  bgMusicHack: (_: AudioBufferSourceNode): void => {},\n  progress: 0,\n  name: '',\n  artist: '',\n  illustrator: '',\n  charter: '',\n  level: '',\n  combo: '',\n  combo2: '',\n  showStat: false,\n  customForeDraw: null as ((ctx: CanvasRenderingContext2D) => void) | null,\n  customBackDraw: null as ((ctx: CanvasRenderingContext2D) => void) | null\n};\nfunction playBgm(data: AudioBuffer | null, offset?: number) {\n  curTimeMS = performance.now();\n  if (data == null) return;\n  tmps.bgMusicHack = musicController.play(data, {\n    offset: (offset ?? 0) || 0,\n    playbackrate: app.speed,\n    interval: autoDelay.checked ? 1 : 0\n  }) as (_: AudioBufferSourceNode) => void;\n}\nasync function playVideo(data: HTMLVideoElement, offset?: number) {\n  data.currentTime = (offset ?? 0) || 0;\n  data.playbackRate = app.speed;\n  data.muted = true;\n  await data.play();\n}\nconst hitImageList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitImage) => nowTimeMS >= i.time + i.duration,\n  iterateCallback(i: HitImage) {\n    const tick = (nowTimeMS - i.time) / i.duration;\n    const { effects } = i;\n    ctxfg.globalAlpha = 1;\n    ctxfg.setTransform(app.noteScaleRatio * 6, 0, 0, app.noteScaleRatio * 6, i.offsetX, i.offsetY); // 缩放\n    // ctxfg.rotate(i.rotation);\n    (effects[Math.floor(tick * effects.length)] ?? effects[effects.length - 1]).full(ctxfg); // 停留约0.5秒\n    ctxfg.fillStyle = i.color;\n    ctxfg.globalAlpha = 1 - tick; // 不透明度\n    const r3 = 30 * (((0.2078 * tick - 1.6524) * tick + 1.6399) * tick + 0.4988); // 方块大小\n    for (const j of i.direction) {\n      const ds = j[0] * (9 * tick / (8 * tick + 1)); // 打击点距离\n      ctxfg.fillRect(ds * Math.cos(j[1]) - r3 / 2, ds * Math.sin(j[1]) - r3 / 2, r3, r3);\n    }\n  }\n});\nconst hitWordList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitWord) => nowTimeMS >= i.time + i.duration,\n  iterateCallback(i: HitWord) {\n    const tick = (nowTimeMS - i.time) / i.duration;\n    ctxfg.setTransform(1, 0, 0, 1, i.offsetX, i.offsetY); // 缩放\n    ctxfg.font = `bold ${app.noteScaleRatio * (256 + 128 * (((0.2078 * tick - 1.6524) * tick + 1.6399) * tick + 0.4988))}px Custom,Noto Sans SC`;\n    ctxfg.textAlign = 'center';\n    ctxfg.fillStyle = i.color;\n    ctxfg.globalAlpha = 1 - tick; // 不透明度\n    ctxfg.fillText(i.text, 0, -app.noteScaleRatio * 128);\n  }\n});\nconst judgeManager = {\n  list: [] as JudgeEvent[],\n  addEvent(notes: Renderer.Note[], seconds: number) {\n    const { list } = this;\n    list.length = 0;\n    if (app.playMode === 1) {\n      const dispTime = Math.min(frameTimer.disp, 0.04);\n      for (const note of notes) {\n        if (note.scored) continue;\n        const deltaTime = note.seconds - seconds;\n        if (note.type === 1) {\n          if (deltaTime < dispTime) list[list.length] = new JudgeEvent(note.offsetX, note.offsetY, 1);\n        } else if (note.type === 2) {\n          if (deltaTime < dispTime) list[list.length] = new JudgeEvent(note.offsetX, note.offsetY, 2);\n        } else if (note.type === 3) {\n          if (note.holdTapTime) list[list.length] = new JudgeEvent(note.offsetX, note.offsetY, 2);\n          else if (deltaTime < dispTime) list[list.length] = new JudgeEvent(note.offsetX, note.offsetY, 1);\n        } else if (note.type === 4) if (deltaTime < dispTime) list[list.length] = new JudgeEvent(note.offsetX, note.offsetY, 3);\n      }\n    } else if (emitter.eq('play')) {\n      for (const evt of hitManager.list) {\n        if (!evt.isTapped) list[list.length] = new JudgeEvent(evt.offsetX, evt.offsetY, 1);\n        if (evt.isActive) list[list.length] = new JudgeEvent(evt.offsetX, evt.offsetY, 2);\n        if (evt.type === 'keyboard') list[list.length] = new JudgeEvent(evt.offsetX, evt.offsetY, 3); // 以后加上Flick判断\n        if (evt.flicking && !evt.flicked) list[list.length] = new JudgeEvent(evt.offsetX, evt.offsetY, 3, evt);\n      // i.flicked = true; 不能在这里判断，因为可能会判定不到\n      }\n    }\n  },\n  execute(notes: Renderer.Note[], seconds: number, width: number) {\n    const { list } = this;\n    for (const note of notes) {\n      if (note.scored) continue; // 跳过已判分的Note\n      const deltaTime = note.seconds - seconds;\n      if (deltaTime > 0.2) break; // 跳过判定范围外的Note\n      if (note.type !== 1 && deltaTime > 0.16) continue;\n      if (deltaTime < -0.16 && note.frameCount > 4 && !note.holdStatus) {\n        // 超时且不为Hold拖判，判为Miss\n        // console.log('Miss', i.name);\n        note.status = 2;\n        stat.addCombo(2, note.type);\n        note.scored = true;\n      } else if (note.type === 2) {\n        // Drag音符\n        if (deltaTime > 0) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 1) continue; // 跳过非Tap判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            judgeEvent.preventBad = true;\n          }\n        }\n        if (note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 2) continue; // 跳过非Drag判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            // console.log('Perfect', i.name);\n            note.status = 4;\n            break;\n          }\n        } else if (deltaTime < 0) {\n          soundController.play(res.HitSong1);\n          hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n          stat.addCombo(4, 2);\n          note.scored = true;\n        }\n      } else if (note.type === 4) {\n        // Flick音符\n        if (deltaTime > 0 || note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 1) continue;\n            // 跳过非Tap判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            judgeEvent.preventBad = true;\n          }\n        }\n        if (note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 3) continue;\n            // 跳过非Move判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            let distance = getJudgeDistance(judgeEvent, note);\n            let noteJudge = note;\n            let nearcomp = false;\n            for (const nearNote of note.nearNotes) {\n              if (nearNote.status) continue;\n              if (nearNote.seconds - seconds > 0.16) break;\n              if (getJudgeOffset(judgeEvent, nearNote) > width) continue;\n              const nearDistance = getJudgeDistance(judgeEvent, nearNote);\n              if (nearDistance < distance) {\n                distance = nearDistance;\n                noteJudge = nearNote;\n                nearcomp = true;\n              }\n            }\n            // console.log('Perfect', i.name);\n            if (judgeEvent.event == null) {\n              noteJudge.status = 4;\n              if (!nearcomp) break;\n            } else if (!judgeEvent.event.flicked) {\n              noteJudge.status = 4;\n              judgeEvent.event.flicked = true;\n              if (!nearcomp) break;\n            }\n          }\n        } else if (deltaTime < 0) {\n          soundController.play(res.HitSong2);\n          hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n          stat.addCombo(4, 4);\n          note.scored = true;\n        }\n      } else {\n        // Hold音符\n        if (note.type === 3 && note.holdTapTime) {\n          // 是否触发头判\n          if ((performance.now() - note.holdTapTime) * note.holdTime >= 1.6e4 * note.holdSeconds) {\n            // 间隔时间与bpm成反比\n            if (note.holdStatus % 4 === 0) hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n            else if (note.holdStatus % 4 === 1) hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n            else if (note.holdStatus % 4 === 3) hitImageList.add(HitImage.good(note.projectX, note.projectY, note));\n            note.holdTapTime = performance.now();\n          }\n          if (deltaTime + note.holdSeconds < 0.2) {\n            if (!note.status) stat.addCombo(note.status = note.holdStatus, 3);\n            if (deltaTime + note.holdSeconds < 0) note.scored = true;\n            continue;\n          }\n          note.holdBroken = true; // 若1帧内未按住并使其转为false，则判定为Miss\n        }\n        for (const judgeEvent of list) {\n          if (note.holdTapTime) {\n            // 头判\n            if (judgeEvent.type !== 2) continue;\n            if (getJudgeOffset(judgeEvent, note) <= width) {\n              note.holdBroken = false;\n              break;\n            }\n            continue;\n          }\n          if (judgeEvent.type !== 1) continue;\n          // 跳过非Tap判定\n          if (judgeEvent.judged) continue;\n          // 跳过已触发的判定\n          if (getJudgeOffset(judgeEvent, note) > width) continue;\n          let deltaTime2 = deltaTime;\n          let distance = getJudgeDistance(judgeEvent, note);\n          let noteJudge = note;\n          let nearcomp = false;\n          for (const nearNote of note.nearNotes) {\n            if (nearNote.status) continue;\n            if (nearNote.holdTapTime) continue;\n            const nearDeltaTime = nearNote.seconds - seconds;\n            if (nearDeltaTime > 0.2) break;\n            if (nearNote.type === 3 && nearDeltaTime > 0.16) continue;\n            if (getJudgeOffset(judgeEvent, nearNote) > width) continue;\n            const nearDistance = getJudgeDistance(judgeEvent, nearNote);\n            if (nearDistance < distance) {\n              deltaTime2 = nearDeltaTime;\n              distance = nearDistance;\n              noteJudge = nearNote;\n              nearcomp = true;\n            }\n          }\n          if (deltaTime2 > 0.16) {\n            if (judgeEvent.preventBad) continue;\n            noteJudge.status = 6; // console.log('Bad', i.name);\n            noteJudge.badTime = performance.now();\n          } else {\n            const note1 = noteJudge;\n            stat.addDisp(Math.max(deltaTime2, (-1 - note1.frameCount) * 0.04 || 0));\n            soundController.play(res.HitSong0);\n            if (deltaTime2 > 0.08) {\n              note1.holdStatus = 7; // console.log('Good(Early)', i.name);\n              hitImageList.add(HitImage.good(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.early(note1.projectX, note1.projectY));\n            } else if (deltaTime2 > 0.04) {\n              note1.holdStatus = 5; // console.log('Perfect(Early)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.early(note1.projectX, note1.projectY));\n            } else if (deltaTime2 > -0.04 || note1.frameCount < 1) {\n              note1.holdStatus = 4; // console.log('Perfect(Max)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n            } else if (deltaTime2 > -0.08 || note1.frameCount < 2) {\n              note1.holdStatus = 1; // console.log('Perfect(Late)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.late(note1.projectX, note1.projectY));\n            } else {\n              note1.holdStatus = 3; // console.log('Good(Late)', i.name);\n              hitImageList.add(HitImage.good(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.late(note1.projectX, note1.projectY));\n            }\n            if (note1.type === 1) note1.status = note1.holdStatus;\n          }\n          if (noteJudge.status) {\n            stat.addCombo(noteJudge.status, 1);\n            noteJudge.scored = true;\n          } else {\n            noteJudge.holdTapTime = performance.now();\n            noteJudge.holdBroken = false;\n          }\n          judgeEvent.judged = true;\n          noteJudge.statOffset = deltaTime2; // TODO: (Replay)也许是统计偏移量？\n          if (!nearcomp) break;\n        }\n        if (emitter.eq('play') && note.holdTapTime && note.holdBroken) {\n          note.status = 2; // console.log('Miss', i.name);\n          stat.addCombo(2, 3);\n          note.scored = true;\n        }\n      }\n    }\n  }\n};\nconst hitFeedbackList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitFeedback) => i.time++ > 0,\n  iterateCallback(i: HitFeedback) {\n    ctxfg.globalAlpha = 0.85;\n    ctxfg.setTransform(1, 0, 0, 1, i.offsetX, i.offsetY); // 缩放\n    ctxfg.fillStyle = i.color;\n    ctxfg.beginPath();\n    ctxfg.arc(0, 0, app.lineScale * 0.5, 0, 2 * Math.PI);\n    ctxfg.fill();\n  }\n});\nconst interact = new InteractProxy(canvas);\n// 兼容PC鼠标\ninteract.setMouseEvent({\n  mousedownCallback(evt: MouseEvent) {\n    const idx = evt.button;\n    const { x, y } = getPos(evt);\n    if (idx === 1) hitManager.activate('mouse', 4, x, y);\n    else if (idx === 2) hitManager.activate('mouse', 2, x, y);\n    else hitManager.activate('mouse', 1 << idx, x, y);\n    specialClick.activate(x, y);\n  },\n  mousemoveCallback(evt: MouseEvent) {\n    const idx = evt.buttons;\n    const { x, y } = getPos(evt);\n    for (let i = 1; i < 32; i <<= 1) {\n      // 同时按住多个键时，只有最后一个键的move事件会触发\n      if (idx & i) hitManager.moving('mouse', i, x, y);\n      else hitManager.deactivate('mouse', i);\n    }\n  },\n  mouseupCallback(evt: MouseEvent) {\n    const idx = evt.button;\n    if (idx === 1) hitManager.deactivate('mouse', 4);\n    else if (idx === 2) hitManager.deactivate('mouse', 2);\n    else hitManager.deactivate('mouse', 1 << idx);\n  }\n});\n// 兼容键盘(喵喵喵?)\ninteract.setKeyboardEvent({\n  keydownCallback(evt: KeyboardEvent) {\n    if (emitter.eq('stop')) return;\n    if (evt.key === 'Shift') btnPause.click();\n    else if (hitManager.list.find(i => i.type === 'keyboard' && i.id === evt.code) == null) {\n      hitManager.activate('keyboard', evt.code, NaN, NaN); // 按住一个键时，会触发多次keydown事件\n    }\n  },\n  keyupCallback(evt: KeyboardEvent) {\n    if (emitter.eq('stop')) return;\n    if (evt.key !== 'Shift') hitManager.deactivate('keyboard', evt.code);\n  }\n});\nself.addEventListener('blur', () => {\n  hitManager.clear('keyboard');\n});\n// re:不）兼容移动设备（触摸\ninteract.setTouchEvent({\n  touchstartCallback(evt: TouchEvent) {\n    for (const touch of evt.changedTouches) {\n      const { x, y } = getPos(touch);\n      hitManager.activate('touch', touch.identifier, x, y);\n      specialClick.activate(x, y);\n    }\n  },\n  touchmoveCallback(evt: TouchEvent) {\n    for (const touch of evt.changedTouches) {\n      const { x, y } = getPos(touch);\n      hitManager.moving('touch', touch.identifier, x, y);\n    }\n  },\n  touchendCallback(evt: TouchEvent) {\n    for (const touch of evt.changedTouches) hitManager.deactivate('touch', touch.identifier);\n  },\n  touchcancelCallback(evt: TouchEvent) {\n    // if (emitter.eq('play')) mainPause(); TODO: 意外暂停提醒\n    for (const touch of evt.changedTouches) hitManager.deactivate('touch', touch.identifier);\n  }\n});\nfunction getPos(obj: MouseEvent | Touch) {\n  const rect = canvas.getBoundingClientRect();\n  return {\n    x: (obj.clientX - rect.left) / canvas.offsetWidth * canvas.width - (canvas.width - canvasfg.width) / 2,\n    y: (obj.clientY - rect.top) / canvas.offsetHeight * canvas.height\n  };\n}\n// Hit end\nconst noteRender = {\n  note: {} as Record<string, ScaledNote>,\n  hitFX: {} as Record<string, ScaledHitFX>,\n  async update(name: string, img: ImageBitmap, scale: number, compacted = false): Promise<void> {\n    this.note[name] = new ScaledNote(img, scale, compacted);\n    if (name === 'Tap') this.note.TapBad = new ScaledNote(await imgPainter(img, '#6c4343'), scale);\n  },\n  async updateFX(img0: ImageBitmap, scale: number, limitX?: number, limitY?: number, hideParts = false, duration?: number): Promise<void> {\n    const hitRaw = await imgSplit(img0, limitX, limitY);\n    const hitPerfect = hitRaw.map(async img => new ScaledNote(await imgShader(img, 'rgba(255,236,160,0.8823529)'), scale)); // #fce491,#ffeca0e1\n    const hitGood = hitRaw.map(async img => new ScaledNote(await imgShader(img, 'rgba(180,225,255,0.9215686)'), scale)); // #9ed5f3,#b4e1ffeb\n    img0.close();\n    this.hitFX.Perfect = {\n      effects: await Promise.all(hitPerfect),\n      numOfParts: hideParts ? 0 : 4,\n      duration: Number(duration) | 0 || 500\n    };\n    this.hitFX.Good = {\n      effects: await Promise.all(hitGood),\n      numOfParts: hideParts ? 0 : 3,\n      duration: Number(duration) | 0 || 500\n    };\n    hitRaw.forEach(img => img.close());\n  }\n};\n// 初始化(踩坑：监听DOMContentLoaded似乎会阻塞页面导致长时间白屏)\nwindow.addEventListener('load', (): void => {\n  const handler = async(): Promise<void> => {\n    canvas.classList.add('fade');\n    // let loadedNum = 0;\n    // let errorNum = 0;\n    sendText('初始化...');\n    if (await checkSupport({\n      messageCallback: sendText,\n      warnCallback: sendWarning,\n      errorCallback: sendError,\n      mobileCallback: () => console.warn(`检测到移动设备，可能无法正常使用`),\n      orientNotSupportCallback: () => {\n        lockOri.checked = false;\n        lockOri.container.classList.add('disabled');\n        lockOri.label.textContent += '(当前设备或浏览器不支持)';\n      }\n    })) return;\n    await import('@/utils/reader-');\n    const raw = await loadResource(resLink).catch(() => null) || {\n      image: {} as Record<string, string>,\n      audio: {} as Record<string, string>,\n      alternative: {} as Record<string, string>,\n      format: ''\n    };\n    // if (!raw) return; // 占位符\n    // shit start\n    await readResource(raw);\n    // .then(result => {\n    //   loadedNum += result.loadedNum;\n    //   errorNum += result.errorNum;\n    // })\n    // shit end\n    // if (errorNum) {\n    //   sendError(`错误：${errorNum}个资源加载失败（点击查看详情）`);\n    //   return;\n    // }\n    const entries = ['Tap', 'TapHL', 'Drag', 'DragHL', 'HoldHead', 'HoldHeadHL', 'Hold', 'HoldHL', 'HoldEnd', 'Flick', 'FlickHL'];\n    await fixme(raw, res);\n    await Promise.all(entries.map(async i => noteRender.update(i, res[i] as ImageBitmap, 8080 / Number(raw.image[i].split('|')[1]))));\n    // for (const entry of entries) await noteRender.update(entry, res[entry], 8080 / raw.image[entry].split('|')[1]);\n    await noteRender.updateFX(res.HitFXRaw, 8080 / Number(raw.image.HitFXRaw.split('|')[1]));\n    res.NoImageBlack = await createImageBitmap(new ImageData(new Uint8ClampedArray(4).fill(0), 1, 1));\n    res.NoImageWhite = await createImageBitmap(new ImageData(new Uint8ClampedArray(4).fill(255), 1, 1));\n    res.JudgeLineMP = await imgShader(res.JudgeLine, '#feffa9');\n    res.JudgeLineFC = await imgShader(res.JudgeLine, '#a2eeff');\n    res.Ranks = await imgSplit(res.Rank);\n    res.Rank.close();\n    res.mute = audio.mute(1);\n    if ((() => {\n      const b = createCtx(1, 1);\n      b.drawImage(res.JudgeLine, 0, 0);\n      return b.getImageData(0, 0, 1, 1).data[0];\n    })() === 0) {\n      sendError('检测到图片加载异常，请关闭所有应用程序然后重试');\n      return;\n    }\n    sendText('等待选择文件...');\n    blockUploader.classList.remove('disabled');\n    blockSelect.classList.remove('disabled');\n    emitter.dispatchEvent(new CustomEvent('change'));\n    // selectChartFile.dispatchEvent(new CustomEvent('change'));\n    // // 测试测试！！！\n  };\n  handler();\n}, { once: true });\nasync function loadResource(url: string) {\n  const res1 = await fetch(url);\n  const text = await res1.text();\n  try {\n    return JSON.parse(text) as {\n      image: Record<string, string>;\n      audio: Record<string, string>;\n      alternative: Record<string, string>;\n    };\n  } catch (err) {\n    sendError('错误：解析资源时出现问题（点击查看详情）', Utils.escapeHTML(`解析资源时出现问题：\\n${(err as Error).message}\\n原始数据：\\n${text}`), true);\n    return null;\n  }\n}\nasync function readResource(raw: {\n  format?: string;\n  image: Record<string, string>;\n  audio: Record<string, string>;\n  alternative: Record<string, string>;\n}) {\n  let loadedNum = 0;\n  let errorNum = 0;\n  const res0: Record<string, string> = {};\n  Object.assign(res0, raw.image);\n  Object.assign(res0, raw.audio);\n  // 加载资源\n  const res1 = [] as Promise<void>[];\n  if (raw.format === 'raw') {\n    res1.push(...Object.entries(raw.image).map(async([name, src]) => {\n      const [url, ext] = src.split('|');\n      console.log(url, ext);\n      await fetch(url, { referrerPolicy: 'no-referrer' }).then(async a => a.blob()).then(async blob => {\n        const img = await createImageBitmap(blob);\n        res[name] = img;\n        sendText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch(() => {\n        errorNum++;\n        sendWarning(`资源加载失败，请检查您的网络连接然后重试：\\n${new URL(url, location.toString()).toString()}`);\n      });\n    }));\n    res1.push(...Object.entries(raw.audio).map(async([name, src]) => {\n      await fetch(src, { referrerPolicy: 'no-referrer' }).then(async a => a.arrayBuffer()).then(async buffer => {\n        res[name] = await audio.decode(buffer);\n        sendText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch(() => {\n        errorNum++;\n        sendWarning(`资源加载失败，请检查您的网络连接然后重试：\\n${new URL(src, location.toString()).toString()}`);\n      });\n    }));\n  } else {\n    res1.push(...Object.entries(res0).map(async([name, src]) => {\n      const [url, ext] = src.split('|') as [string, string | null];\n      await fetch(url, { referrerPolicy: 'no-referrer' }).then(async a => a.blob()).then(async blob => {\n        const img = await createImageBitmap(blob);\n        if (ext != null && ext.startsWith('m')) {\n          const data = ImgAny.decode(img, Number(ext.slice(1)));\n          img.close();\n          res[name] = await audio.decode(data).catch(async(_e: unknown) => {\n            const blob1 = await fetch(raw.alternative[name], {\n              referrerPolicy: 'no-referrer'\n            }).then(async i => i.blob());\n            return createImageBitmap(blob1).then(ImgAny.decodeAlt).then(async ab => audio.decode(ab)).catch((e: unknown) => {\n              const err = e instanceof Error ? e : new Error('Unknown error');\n              sendWarning(`音频加载存在问题，将导致以下音频无法正常播放：\\n${name}(${err.message})\\n如果多次刷新问题仍然存在，建议更换设备或浏览器。`);\n              return audio.mute(1);\n            });\n          });\n        } else res[name] = img;\n        sendText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch((err: unknown) => {\n        console.error(err);\n        sendError(`错误：${errorNum++}个资源加载失败（点击查看详情）`, `资源加载失败，请检查您的网络连接然后重试：\\n${new URL(url, location.toString()).toString()}`, true);\n      });\n    }));\n  }\n  await Promise.all(res1);\n  return { loadedNum, errorNum };\n}\nconst background = {\n  isBlur: false,\n  image: null as ImageStore | null,\n  getImage() {\n    if (!this.image) return res.NoImageWhite;\n    return this.image.base;\n  },\n  getImageBlur() {\n    if (!this.image) return res.NoImageWhite;\n    return this.isBlur ? this.image.blur : this.image.base;\n  }\n};\ncheckImageBlur.addEventListener('change', () => {\n  background.isBlur = checkImageBlur.checked;\n});\ncheckImageBlur.dispatchEvent(new Event('change'));\n// 作图\nfunction mainLoop() {\n  frameTimer.addTick(); // 计算fps\n  const { lineScale } = app;\n  nowTimeMS = performance.now();\n  app.resizeCanvas();\n  // 计算时间\n  if (timeOut.second < 0.67) {\n    loopNoCanvas();\n    for (const callback of main.now.values()) callback(timeBgm * app.speed);\n    loopCanvas();\n  } else if (!isOutOver) {\n    isOutOver = true;\n    audio.stop();\n    btnPause.classList.add('disabled'); // TODO: 优化\n    ctxfg.globalCompositeOperation = 'source-over';\n    ctxfg.resetTransform();\n    ctxfg.globalAlpha = 1;\n    const bgImageBlur = background.getImageBlur();\n    ctxfg.drawImage(bgImageBlur, ...adjustSize(bgImageBlur, canvasfg, 1));\n    ctxfg.fillStyle = '#000'; // 背景变暗\n    ctxfg.globalAlpha = app.brightness; // 背景不透明度\n    ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n    self.setTimeout(() => {\n      if (!isOutOver) return; // 避免快速重开后直接结算\n      const difficulty = levelInfoHandler.getDifficultyIndex();\n      musicController.play(res[`LevelOver${difficulty < 0 ? 2 : difficulty}_v1`] as AudioBuffer, { loop: true });\n      timeEnd.reset();\n      timeEnd.play();\n      stat.level = levelInfoHandler.getLevelNumber();\n      tempStat = stat.getData(app.playMode === 1, selectspeed.value);\n    }, 1e3);\n  } // 只让它执行一次\n  if (tempStat != null) atDraw3(tempStat);\n  ctx.globalAlpha = 1;\n  const bgImageBlur = background.getImageBlur();\n  ctx.drawImage(bgImageBlur, ...adjustSize(bgImageBlur, canvas, 1.1));\n  ctx.fillStyle = '#000';\n  ctx.globalAlpha = 0.4;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.globalAlpha = 1;\n  ctx.drawImage(canvasfg, (canvas.width - canvasfg.width) / 2, 0);\n  for (const callback of main.afterAll.values()) callback();\n  // Copyright\n  ctx.globalCompositeOperation = 'difference';\n  ctx.font = `${lineScale * 0.4}px Custom,Noto Sans SC`;\n  ctx.fillStyle = '#fff';\n  ctx.globalAlpha = 0.8;\n  ctx.textAlign = 'right';\n  ctx.fillText(`${meta[0]} v${meta[1].join('.')} - Code by lchz\\x683\\x3473 Re.V`, (canvas.width + canvasfg.width) / 2 - lineScale * 0.1, canvas.height - lineScale * 0.1);\n  ctx.globalCompositeOperation = 'source-over';\n}\nfunction loopNoCanvas() {\n  if (app.chart == null) throw new Error('Not initialized: Chart');\n  if (!isInEnd && timeIn.second >= 3 && emitter.eq('play')) { // fixed: 修复关闭过渡动画时重开1帧内点击暂停产生显示暂停实际音乐播放的问题\n    isInEnd = true;\n    playBgm(app.bgMusic);\n    if (app.bgVideo != null) playVideo(app.bgVideo);\n  }\n  if (emitter.eq('play') && isInEnd && !isOutStart) timeBgm = curTime + (nowTimeMS - curTimeMS) / 1e3;\n  if (timeBgm < 0) timeBgm = 0; // fixed: 修复重开后时间轴不归零的问题\n  if (timeBgm >= duration0) isOutStart = true;\n  if (showTransition.checked && isOutStart && !isOutEnd) {\n    isOutEnd = true;\n    timeOut.play();\n  }\n  timeChart = Math.max(timeBgm - (app.chart.offset + Number(inputOffset.value) / 1e3 || 0) / app.speed, 0);\n  // 遍历判定线events和Note\n  app.updateByTime(timeChart);\n  // 更新打击特效和触摸点动画\n  hitFeedbackList.update();\n  hitImageList.update();\n  hitWordList.update();\n  for (const evt of hitManager.list) {\n    if (evt.type === 'keyboard') continue;\n    if (!evt.isTapped) hitFeedbackList.add(HitFeedback.tap(evt.offsetX, evt.offsetY));\n    else if (evt.isMoving) hitFeedbackList.add(HitFeedback.move(evt.offsetX, evt.offsetY));\n    else if (evt.isActive) hitFeedbackList.add(HitFeedback.hold(evt.offsetX, evt.offsetY)); // TODO: 动态特效\n  }\n  // 触发判定和播放打击音效\n  if (isInEnd) {\n    const judgeWidth = canvasfg.width * 0.118125;\n    judgeManager.addEvent(app.notes, timeChart);\n    judgeManager.execute(app.drags, timeChart, judgeWidth);\n    judgeManager.execute(app.flicks, timeChart, judgeWidth);\n    judgeManager.execute(app.tapholds, timeChart, judgeWidth);\n  }\n  // 更新判定\n  hitManager.update();\n  // if (awawa && stat.good + stat.bad) {\n  //   stat.level = Number(levelText.match(/\\d+$/));\n  //   stat.reset();\n  //   Promise.resolve().then(mainPlay).then(mainPlay);\n  // }\n  tmps.bgImage = background.getImageBlur();\n  tmps.bgVideo = app.bgVideo;\n  tmps.progress = (main.awawa ? duration0 - timeBgm : timeBgm) / duration0;\n  tmps.name = inputName.value || inputName.placeholder;\n  tmps.artist = inputArtist.value;\n  tmps.illustrator = `Illustration designed by ${inputIllustrator.value || inputIllustrator.placeholder}`;\n  tmps.charter = `Level designed by ${inputCharter.value || inputCharter.placeholder}`;\n  tmps.level = levelInfoHandler.text;\n  if (stat.combo > 2) {\n    tmps.combo = `${stat.combo}`;\n    tmps.combo2 = app.playMode === 1 ? 'Autoplay' : 'combo';\n  } else {\n    tmps.combo = '';\n    tmps.combo2 = '';\n  }\n  tmps.showStat = true;\n  tmps.customForeDraw = null;\n  tmps.customBackDraw = null;\n}\nfunction loopCanvas() {\n  const { lineScale, wlen, hlen } = app;\n  const { bgImage, bgVideo } = tmps;\n  ctxfg.clearRect(0, 0, canvasfg.width, canvasfg.height); // 重置画面\n  // 绘制背景\n  ctxfg.globalAlpha = 1;\n  ctxfg.drawImage(bgImage, ...adjustSize(bgImage, canvasfg, 1));\n  if (isInEnd && bgVideo != null && !main.awawa) {\n    const { videoWidth: width, videoHeight: height } = bgVideo;\n    ctxfg.drawImage(bgVideo, ...adjustSize({ width, height }, canvasfg, 1));\n  }\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  if (timeIn.second >= 2.5 && !stat.lineStatus) drawLine(0, lineScale); // 绘制判定线(背景后0)\n  // if (awawa) ctxfg.filter = 'none';\n  ctxfg.resetTransform();\n  ctxfg.fillStyle = '#000'; // 背景变暗\n  ctxfg.globalAlpha = app.brightness; // 背景不透明度\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  if (timeIn.second >= 2.5 && tmps.customBackDraw != null) tmps.customBackDraw(ctxfg); // 自定义背景\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  if (timeIn.second >= 2.5) drawLine(stat.lineStatus ? 2 : 1, lineScale); // 绘制判定线(背景前1)\n  // if (awawa) ctxfg.filter = 'none';\n  ctxfg.resetTransform();\n  if (timeIn.second >= 3 && timeOut.second === 0) {\n    // 绘制note\n    drawNotes();\n    if (showPoint.checked) {\n      // 绘制定位点\n      ctxfg.font = `${lineScale}px Custom,Noto Sans SC`;\n      ctxfg.textAlign = 'center';\n      for (const line of app.linesReversed) {\n        ctxfg.setTransform(line.cosr, line.sinr, -line.sinr, line.cosr, line.offsetX, line.offsetY);\n        ctxfg.globalAlpha = 1;\n        ctxfg.fillStyle = 'violet';\n        ctxfg.fillRect(-lineScale * 0.2, -lineScale * 0.2, lineScale * 0.4, lineScale * 0.4);\n        ctxfg.fillStyle = 'yellow';\n        ctxfg.globalAlpha = (line.alpha + 0.5) / 1.5;\n        ctxfg.fillText(line.lineId.toString(), 0, -lineScale * 0.3);\n      }\n      for (const note of app.notesReversed) {\n        if (!note.visible) continue;\n        ctxfg.setTransform(note.cosr, note.sinr, -note.sinr, note.cosr, note.offsetX, note.offsetY);\n        ctxfg.globalAlpha = 1;\n        ctxfg.fillStyle = 'lime';\n        ctxfg.fillRect(-lineScale * 0.2, -lineScale * 0.2, lineScale * 0.4, lineScale * 0.4);\n        ctxfg.fillStyle = 'cyan';\n        ctxfg.globalAlpha = note.seconds > timeChart ? 1 : 0.5;\n        ctxfg.fillText(note.name, 0, -lineScale * 0.3);\n      }\n    }\n  }\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  hitImageList.animate(); // 绘制打击特效1\n  // if (awawa) ctxfg.filter = 'none';\n  if (showCE2.checked) hitWordList.animate(); // 绘制打击特效2\n  ctxfg.globalAlpha = 1;\n  // 绘制进度条\n  ctxfg.setTransform(canvasfg.width / 1920, 0, 0, canvasfg.width / 1920, 0, lineScale * (timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) - 1 : -tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  ctxfg.drawImage(res.ProgressBar, tmps.progress * 1920 - 1920, 0);\n  // 绘制文字\n  ctxfg.resetTransform();\n  for (const callback of main.after.values()) callback();\n  ctxfg.fillStyle = '#fff';\n  // 开头过渡动画\n  // re：已禁用信息显示\n  if (timeIn.second < 3) {\n    if (timeIn.second < 0.67) ctxfg.globalAlpha = tween.easeOutSine(timeIn.second * 1.5);\n    else if (timeIn.second >= 2.5) ctxfg.globalAlpha = tween.easeOutSine(6 - timeIn.second * 2);\n    ctxfg.textAlign = 'center';\n    // 曲名、曲师、曲绘和谱师\n    // fillTextNode(tmps.name, wlen, hlen * 0.75, lineScale * 1.1, canvasfg.width - lineScale * 1.5);\n    // fillTextNode(tmps.artist, wlen, hlen * 0.75 + lineScale * 1.25, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    // fillTextNode(tmps.illustrator, wlen, hlen * 1.25 + lineScale * 0.55, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    // fillTextNode(tmps.charter, wlen, hlen * 1.25 + lineScale * 1.4, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    // 判定线(装饰用)\n    ctxfg.globalAlpha = 1;\n    ctxfg.setTransform(1, 0, 0, 1, wlen, hlen);\n    const imgW = lineScale * 48 * (timeIn.second < 0.67 ? tween.easeInSine(timeIn.second * 1.5) : 1);\n    const imgH = lineScale * 0.15; // 0.1333...\n    if (timeIn.second >= 2.5) ctxfg.globalAlpha = tween.easeOutSine(6 - timeIn.second * 2);\n    ctxfg.drawImage(lineColor.checked ? res.JudgeLineMP : res.JudgeLine, -imgW / 2, -imgH / 2, imgW, imgH);\n  }\n  // 绘制分数和combo\n  ctxfg.globalAlpha = 1;\n  ctxfg.setTransform(1, 0, 0, 1, 0, lineScale * (timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) - 1 : -tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  if (tmps.showStat) {\n    ctxfg.font = `${lineScale * 0.95}px Custom,Noto Sans SC`;\n    ctxfg.textAlign = 'right';\n    ctxfg.fillText(stat.scoreStr, canvasfg.width - lineScale * 0.65, lineScale * 1.375);\n    if (showAcc.checked) {\n      ctxfg.font = `${lineScale * 0.66}px Custom,Noto Sans SC`;\n      ctxfg.fillText(stat.accStr, canvasfg.width - lineScale * 0.65, lineScale * 2.05);\n    }\n  }\n  ctxfg.textAlign = 'center';\n  ctxfg.font = `${lineScale * 1.32}px Custom,Noto Sans SC`;\n  ctxfg.fillText(tmps.combo, wlen, lineScale * 1.375);\n  ctxfg.globalAlpha = timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) : 1 - tween.easeOutSine(timeOut.second * 1.5);\n  ctxfg.font = `${lineScale * 0.66}px Custom,Noto Sans SC`;\n  ctxfg.fillText(tmps.combo2, wlen, lineScale * 2.05);\n  // 绘制曲名和等级\n  ctxfg.globalAlpha = 1;\n  ctxfg.setTransform(1, 0, 0, 1, 0, lineScale * (timeIn.second < 0.67 ? 1 - tween.easeOutSine(timeIn.second * 1.5) : tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  ctxfg.textAlign = 'right';\n  fillTextNode(tmps.level, canvasfg.width - lineScale * 0.75, canvasfg.height - lineScale * 0.66, lineScale * 0.63, wlen - lineScale);\n  ctxfg.textAlign = 'left';\n  fillTextNode(tmps.name, lineScale * 0.65, canvasfg.height - lineScale * 0.66, lineScale * 0.63, wlen - lineScale);\n  ctxfg.resetTransform();\n  // 绘制时间和帧率以及note打击数\n  ctxfg.fillStyle = '#fff';\n  if (timeIn.second < 0.67) ctxfg.globalAlpha = tween.easeOutSine(timeIn.second * 1.5);\n  else ctxfg.globalAlpha = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  ctxfg.font = `${lineScale * 0.4}px Custom,Noto Sans SC`;\n  ctxfg.textAlign = 'left';\n  ctxfg.fillText(`${time2Str(main.awawa ? duration0 - timeBgm : timeBgm)}/${time2Str(duration0)}${status2.text}`, lineScale * 0.05, lineScale * 0.6);\n  ctxfg.fillText(stat.format, canvasfg.width - lineScale * 4.35, lineScale * 0.6);\n  ctxfg.textAlign = 'right';\n  ctxfg.fillText(frameTimer.fpsStr, canvasfg.width - lineScale * 0.05, lineScale * 0.6);\n  if (tmps.showStat && showStat.checked) {\n    ctxfg.textAlign = 'right';\n    [stat.noteRank[6], stat.noteRank[7], stat.noteRank[5], stat.noteRank[4], stat.noteRank[1], stat.noteRank[3], stat.noteRank[2]].forEach((val, idx) => {\n      const comboColor = ['#fe7b93', '#0ac3ff', 'lime', '#f0ed69', 'lime', '#0ac3ff', '#999'];\n      ctxfg.fillStyle = comboColor[idx];\n      ctxfg.fillText(val.toString(), canvasfg.width - lineScale * 0.05, canvasfg.height / 2 + lineScale * (idx - 2.8) * 0.5);\n    });\n    ctxfg.fillStyle = '#fff';\n    ctxfg.textAlign = 'left';\n    ctxfg.fillText(`DSP:  ${stat.curDispStr}`, lineScale * 0.05, canvasfg.height / 2 - lineScale * 0.15);\n    ctxfg.fillText(`AVG:  ${stat.avgDispStr}`, lineScale * 0.05, canvasfg.height / 2 + lineScale * 0.35);\n    ctxfg.textAlign = 'center';\n    stat.combos.forEach((val, idx) => {\n      const comboColor = ['#fff', '#0ac3ff', '#f0ed69', '#a0e9fd', '#fe4365'];\n      ctxfg.fillStyle = comboColor[idx];\n      ctxfg.fillText(val.toString(), lineScale * (idx + 0.55) * 1.1, canvasfg.height - lineScale * 0.1);\n    });\n  }\n  if (timeIn.second >= 2.5 && timeIn.second < 3) ctxfg.globalAlpha = 1 - tween.easeOutSine(6 - timeIn.second * 2);\n  else ctxfg.globalAlpha = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  if (timeIn.second >= 2.5 && tmps.customForeDraw != null) tmps.customForeDraw(ctxfg); // 自定义前景\n  if (timeIn.second >= 2.5 && main.filter != null) main.filter(ctxfg, timeBgm, nowTimeMS / 1e3); // 滤镜处理\n  if (checkFeedback.checked) hitFeedbackList.animate(); // 绘制打击特效0\n  ctxfg.resetTransform();\n}\n// 判定线函数，undefined/0:默认,1:非,2:恒成立\nfunction drawLine(bool: number, lineScale: number) {\n  const tw = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  for (const line of app.linesReversed) {\n    if (bool ^ Number(line.imageD) && timeOut.second < 0.67) {\n      ctxfg.globalAlpha = line.alpha;\n      ctxfg.setTransform(line.cosr * tw, line.sinr, -line.sinr * tw, line.cosr, app.wlen + (line.offsetX - app.wlen) * tw, line.offsetY); // Hiahiah\n      const imgS = (line.imageU ? lineScale * 18.75 : canvasfg.height) * line.imageS / 1080;\n      const imgW = imgS * line.imageW * line.imageA;\n      const imgH = imgS * line.imageH;\n      ctxfg.drawImage(line.imageL[line.imageC && lineColor.checked ? stat.lineStatus : 0], -imgW / 2, -imgH / 2, imgW, imgH);\n    }\n  }\n  ctxfg.globalAlpha = 1;\n}\nfunction fillTextNode(text: string, x: number, y: number, size: number, maxWidth: number) {\n  ctxfg.font = `${size}px Custom,Noto Sans SC`;\n  const dx = ctxfg.measureText(text).width;\n  if (dx > maxWidth) ctxfg.font = `${size / dx * maxWidth}px Custom,Noto Sans SC`;\n  ctxfg.fillText(text, x, y);\n  return dx;\n}\nfunction atDraw3(statData: StatData) {\n  ctxfg.resetTransform();\n  ctxfg.clearRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalAlpha = 1;\n  const bgImageBlur = background.getImageBlur();\n  ctxfg.drawImage(bgImageBlur, ...adjustSize(bgImageBlur, canvasfg, 1));\n  ctxfg.fillStyle = '#000'; // 背景变暗\n  ctxfg.globalAlpha = app.brightness; // 背景不透明度\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalCompositeOperation = 'destination-out';\n  ctxfg.globalAlpha = 1;\n  const k = 3.7320508075688776; // tan75°\n  ctxfg.setTransform(canvasfg.width - canvasfg.height / k, 0, -canvasfg.height / k, canvasfg.height, canvasfg.height / k, 0);\n  ctxfg.fillRect(0, 0, 1, tween.easeOutCubic(clip((timeEnd.second - 0.13) * 0.94)));\n  ctxfg.resetTransform();\n  ctxfg.globalCompositeOperation = 'destination-over';\n  const skew = (canvasfg.width - canvasfg.height / k) / (16 - 9 / k);\n  ctxfg.setTransform(skew / 120, 0, 0, skew / 120, app.wlen - skew * 8, app.hlen - skew * 4.5); // ?\n  ctxfg.drawImage(res.LevelOver4, 183, 42, 1184, 228);\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.27) / 0.83);\n  ctxfg.drawImage(res.LevelOver1, 102, 378);\n  ctxfg.globalCompositeOperation = 'source-over';\n  ctxfg.globalAlpha = 1;\n  ctxfg.drawImage(res.LevelOver5, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 369, 91, 20, 80);\n  // 曲名和等级\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'left';\n  fillTextNode(inputName.value || inputName.placeholder, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 320, 160, 80, 1500);\n  const textWidth = fillTextNode(levelInfoHandler.text, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 317, 212, 30, 750);\n  ctxfg.font = '30px Custom,Noto Sans SC';\n  // Rank图标\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.87) * 3.75);\n  const outerSize = 293 + clip((timeEnd.second - 1.87) * 3.75) * 100;\n  const innerSize = 410 - clip((timeEnd.second - 1.87) * 2.14) * 164;\n  ctxfg.drawImage(res.LevelOver3, 661 - outerSize / 2, 545 - outerSize / 2, outerSize, outerSize);\n  ctxfg.drawImage(res.Ranks[stat.rankStatus], 661 - innerSize / 2, 545 - innerSize / 2, innerSize, innerSize);\n  // 各种数据\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.87) * 2.5);\n  ctxfg.fillStyle = statData.newBestColor;\n  ctxfg.fillText(statData.newBestStr, 898, 433);\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'center';\n  ctxfg.fillText(statData.scoreBest, 1180, 433);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.87) * 2.5);\n  ctxfg.textAlign = 'right';\n  ctxfg.fillText(statData.scoreDelta, 1414, 433);\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.95) * 1.5);\n  ctxfg.textAlign = 'left';\n  ctxfg.fillText(stat.accStr, 352, 550);\n  ctxfg.fillText(stat.maxcombo.toString(), 1528, 550);\n  ctxfg.fillStyle = statData.textAboveColor;\n  ctxfg.fillText(app.speed === 1 ? '' : statData.textAboveStr.replace('{SPEED}', app.speed.toFixed(2)), 383 + Math.min(textWidth, 750), 212);\n  ctxfg.fillStyle = statData.textBelowColor;\n  ctxfg.fillText(statData.textBelowStr, 1355, 595);\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'center';\n  ctxfg.font = '86px Custom,Noto Sans SC';\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.12) * 2.0);\n  ctxfg.fillText(stat.scoreStr, 1075, 569);\n  ctxfg.font = '26px Custom,Noto Sans SC';\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.87) * 2.5);\n  ctxfg.fillText(stat.perfect.toString(), 891, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.07) * 2.5);\n  ctxfg.fillText(stat.good.toString(), 1043, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.27) * 2.5);\n  ctxfg.fillText(stat.noteRank[6].toString(), 1196, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.47) * 2.5);\n  ctxfg.fillText(stat.noteRank[2].toString(), 1349, 650);\n  ctxfg.font = '22px Custom,Noto Sans SC';\n  const transition = clip((main.pressTime > 0 ? timeEnd.second - main.pressTime : 0.2 - timeEnd.second - main.pressTime) * 5.0);\n  ctxfg.globalAlpha = 0.8 * clip((timeEnd.second - 0.87) * 2.5) * transition;\n  ctxfg.fillStyle = '#696';\n  ctxfg.fill(new Path2D('M841,718s-10,0-10,10v80s0,10,10,10h100s10,0,10-10v-80s0-10-10-10h-40l-10-20-10,20h-40z'));\n  ctxfg.globalAlpha = 0.8 * clip((timeEnd.second - 1.07) * 2.5) * transition;\n  ctxfg.fillStyle = '#669';\n  ctxfg.fill(new Path2D('M993,718s-10,0-10,10v80s0,10,10,10h100s10,0,10-10v-80s0-10-10-10h-40l-10-20-10,20h-40z'));\n  ctxfg.fillStyle = '#fff';\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.97) * 2.5) * transition;\n  ctxfg.fillText(`Early: ${stat.noteRank[5]}`, 891, 759);\n  ctxfg.fillText(`Late: ${stat.noteRank[1]}`, 891, 792);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.17) * 2.5) * transition;\n  ctxfg.fillText(`Early: ${stat.noteRank[7]}`, 1043, 759);\n  ctxfg.fillText(`Late: ${stat.noteRank[3]}`, 1043, 792);\n  ctxfg.resetTransform();\n  ctxfg.globalCompositeOperation = 'destination-over';\n  ctxfg.globalAlpha = 1;\n  ctxfg.fillStyle = '#000';\n  const bgImage = background.getImage();\n  ctxfg.drawImage(bgImage, ...adjustSize(bgImage, canvasfg, 1));\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalCompositeOperation = 'source-over';\n}\nfunction clip(num: number) {\n  if (num < 0) return 0;\n  if (num > 1) return 1;\n  return num;\n}\ninterface ScaledHitFX {\n  effects: ScaledNote[];\n  numOfParts: number;\n  duration: number;\n}\n// 绘制Note\nfunction drawNotes() {\n  for (const note of app.holds) drawHold(note, timeChart);\n  for (const note of app.dragsReversed) drawDrag(note);\n  for (const note of app.tapsReversed) drawTap(note);\n  for (const note of app.flicksReversed) drawFlick(note);\n}\nfunction drawTap(note: Renderer.Note) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    // 过线前1.5s出现\n    noteRender.note[HL ? 'TapHL' : 'Tap'].full(ctxfg);\n  } else {\n    ctxfg.globalAlpha = 1 - clip((performance.now() - note.badTime) / 500);\n    noteRender.note.TapBad.full(ctxfg);\n  }\n}\nfunction drawDrag(note: Renderer.Note) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    noteRender.note[HL ? 'DragHL' : 'Drag'].full(ctxfg);\n  } else {\n    // Nothing to do\n  }\n}\nfunction drawHold(note: Renderer.Note, seconds: number) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.seconds + note.holdSeconds < seconds) return; // 不绘制时空超界的Hold\n  ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n  if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  const baseLength = app.scaleY / nsr * note.speed * app.speed;\n  const holdLength = baseLength * note.holdSeconds;\n  if (note.seconds > seconds) {\n    noteRender.note[HL ? 'HoldHeadHL' : 'HoldHead'].head(ctxfg);\n    noteRender.note[HL ? 'HoldHL' : 'Hold'].body(ctxfg, -holdLength, holdLength);\n  } else noteRender.note[HL ? 'HoldHL' : 'Hold'].body(ctxfg, -holdLength, holdLength - baseLength * (seconds - note.seconds));\n  noteRender.note.HoldEnd.tail(ctxfg, -holdLength);\n}\nfunction drawFlick(note: Renderer.Note) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    noteRender.note[HL ? 'FlickHL' : 'Flick'].full(ctxfg);\n  } else {\n    // Nothing to do\n  }\n}\nconst lineImages = new Map() as Map<ImageBitmap, LineImage>;\nclass LineImage {\n  public image: ImageBitmap;\n  public imageFC: ImageBitmap | null;\n  public imageAP: null; // ImageBitmap | null;\n  public imageMP: ImageBitmap | null;\n  public constructor(image: ImageBitmap) {\n    this.image = image;\n    this.imageFC = null;\n    this.imageAP = null;\n    this.imageMP = null;\n  }\n  public async getFC() {\n    if (this.imageFC == null) this.imageFC = await imgShader(this.image, '#a2eeff');\n    return this.imageFC;\n  }\n  public async getAP() {\n    /* if (this.imageAP == null) */ this.imageAP = await Promise.resolve(null); // imgShader(this.image, '#a3ffac');\n    return this.imageAP;\n  }\n  public async getMP() {\n    if (this.imageMP == null) this.imageMP = await imgShader(this.image, '#feffa9');\n    return this.imageMP;\n  }\n}\nconst updateLineImage = (image: ImageBitmap) => {\n  const lineImage = lineImages.get(image) || new LineImage(image);\n  if (!lineImages.has(image)) lineImages.set(image, lineImage);\n  return lineImage;\n};\n// rgba数组(0-1)转十六进制\n// function rgba2hex(...rgba:number[]) {\n//   return '#' + rgba.map(i => ('00' + Math.round(Number(i) * 255 || 0).toString(16)).slice(-2)).join('');\n// }\n// byte转人类可读\n// function bytefm(byte = 0) {\n//   let result = byte;\n//   if (result < 1024) return `${result}B`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}KB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}MB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}GB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}TB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}PB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}EB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}ZB`;\n//   if ((result /= 1024) < 1024) return `${result.toFixed(2)}YB`;\n//   result /= 1024; return `${result}BB`;\n// }\nselectVolume.addEventListener('change', evt => {\n  const volume = Number((evt.target as HTMLInputElement).value);\n  app.musicVolume = Math.min(1, 1 / volume);\n  app.soundVolume = Math.min(1, volume);\n  audio.test(() => {\n    musicController.gainNode.gain.value = app.musicVolume;\n    soundController.gainNode.gain.value = app.soundVolume;\n  });\n});\nstatus.reg('selectVolume', selectVolume);\ncheckAutoPlay.addEventListener('change', evt => {\n  app.playMode = (evt.target as HTMLInputElement).checked ? 1 : 0;\n});\ncheckAutoPlay.dispatchEvent(new Event('change'));\nlowRes.checkbox.addEventListener('change', evt => {\n  app.setLowResFactor((evt.target as HTMLInputElement).checked ? 0.5 : 1);\n});\nlowRes.checkbox.dispatchEvent(new Event('change'));\nselectbg.onchange = () => {\n  const bg = bgs.get(selectbg.value);\n  background.image = bg || null;\n  if (bg) bg.setBlur();\n};\nselectchart.addEventListener('change', adjustInfo);\n(function() {\n  const input = document.createElement('input');\n  Object.assign(input, { type: 'number', min: 25, max: 1000, value: 60 });\n  input.style.cssText += ';width:50px;margin-left:10px';\n  input.addEventListener('change', function(this: HTMLInputElement) {\n    const value = Number(this.value);\n    if (value < 25) this.value = '25';\n    if (value > 1000) this.value = '1000';\n    frameAnimater.setFrameRate(Number(this.value));\n  });\n  status.reg('maxFrameNumber', input, false);\n  maxFrame.container.appendChild(input);\n  maxFrame.checkbox.addEventListener('change', function(this: HTMLInputElement) {\n    input.classList.toggle('disabled', !this.checked);\n    if (this.checked) input.dispatchEvent(new Event('change'));\n    else frameAnimater.setFrameRate(0);\n  });\n  maxFrame.checkbox.dispatchEvent(new Event('change'));\n}());\n// Play\nemitter.addEventListener('change', function(this: Emitter) {\n  canvas.classList.toggle('fade', this.eq('stop'));\n  blockMask.classList.toggle('fade', this.ne('stop'));\n  btnPlay.value = this.eq('stop') ? '播放' : '停止';\n  btnPause.value = this.eq('pause') ? '继续' : '暂停';\n  btnPause.classList.toggle('disabled', this.eq('stop'));\n  for (const elem of $$('.disabled-when-playing')) elem.classList.toggle('disabled', this.ne('stop'));\n  // console.log(this);\n});\nbtnPlay.addEventListener('click', function(this: HTMLInputElement) {\n  const handler = async() => {\n    if (this.classList.contains('disabled')) return;\n    this.classList.add('disabled');\n    await mainPlay();\n    this.classList.remove('disabled');\n  };\n  handler();\n});\nbtnPause.addEventListener('click', function(this: HTMLInputElement) {\n  const handler = async() => {\n    if (this.classList.contains('disabled')) return;\n    this.classList.add('disabled');\n    await mainPause();\n    this.classList.remove('disabled');\n  };\n  handler();\n});\ninputOffset.addEventListener('input', function(this: HTMLInputElement) {\n  const value = Number(this.value);\n  if (value < -400) this.value = '-400';\n  if (value > 600) this.value = '600';\n});\nstatus2.reg(emitter, 'change', () => main.awawa ? 'Reversed' : ''); // TODO: 重构\nstatus2.reg(selectflip, 'change', target => ['', 'FlipX', 'FlipY', 'FlipX&Y'][Number((target as HTMLSelectElement).value)]);\nstatus2.reg(selectspeed, 'change', target => (target as HTMLSelectElement).value);\nstatus2.reg(emitter, 'change', target => (target as Emitter).eq('pause') ? 'Paused' : '');\nexport async function mainPlay(): Promise<void> {\n  console.log('mainPlaying......');\n  // re: 播放谱面函数\n  if (emitter.eq('stop')) {\n    if (!selectchart.value) {\n      main.error('未选择任何谱面');\n      return;\n    }\n    for (const callback of main.before.values()) await callback();\n    const bgm: MediaData = bgms.get(selectbgm.value) || { audio: null, video: null };\n    app.bgMusic = bgm.audio;\n    app.bgVideo = bgm.video;\n    app.prerenderChart(main.modify(charts.get(selectchart.value)!));\n    const md5 = chartsMD5.get(selectchart.value)!;\n    const format = chartsFormat.get(selectchart.value)!;\n    stat.level = levelInfoHandler.getLevelNumber();\n    if (app.chart != null) stat.reset(app.chart.numOfNotes, md5, format, selectspeed.value);\n    await loadLineData({ onwarn: sendWarning });\n    duration0 = app.duration / app.speed;\n    isInEnd = false;\n    isOutStart = false;\n    isOutEnd = false;\n    timeBgm = 0;\n    if (!showTransition.checked) timeIn.addTime(3e3);\n    audio.play(res.mute, { loop: true }); // 播放空音频(避免音画不同步)\n    frameAnimater.start();\n    timeIn.play();\n    interact.activate();\n    emitter.emit('play');\n  } else {\n    emitter.emit('stop');\n    interact.deactive();\n    audio.stop();\n    frameAnimater.stop();\n    // 清除原有数据\n    isOutOver = false;\n    tempStat = null;\n    hitFeedbackList.clear();\n    hitImageList.clear();\n    hitWordList.clear();\n    timeIn.reset();\n    timeOut.reset();\n    timeEnd.reset();\n    curTime = 0;\n    curTimeMS = 0;\n    duration0 = 0;\n    for (const callback of main.end.values()) await callback();\n  }\n}\nasync function loadLineData({\n  onwarn = (_: string) => {}\n} = {}) {\n  for (const line of app.lines) {\n    line.imageW = 6220.8; // 1920\n    line.imageH = 7.68; // 3\n    line.imageL = [res.JudgeLine, res.JudgeLineMP, null, res.JudgeLineFC];\n    line.imageS = 1; // 2.56\n    line.imageA = 1; // 1.5625\n    line.imageD = false;\n    line.imageC = true;\n    line.imageU = true;\n  }\n  for (const data of chartLineDataList) {\n    if (selectchart.value === data.chart) {\n      if (data.lineId == null) {\n        onwarn('未指定判定线id');\n        continue;\n      }\n      const line = app.lines[Number(data.lineId)] as Renderer.JudgeLine | null;\n      if (line == null) {\n        onwarn(`指定id的判定线不存在：${data.lineId}`);\n        continue;\n      }\n      let image = data.image == null ? null : bgs.get(data.image)?.base;\n      if (!image) {\n        if (data.image != null) onwarn(`图片不存在：${data.image}`);\n        image = res.NoImageBlack;\n      }\n      line.imageW = image.width;\n      line.imageH = image.height;\n      const lineImage = updateLineImage(image);\n      line.imageL = await Promise.all([image, lineImage.getMP(), lineImage.getAP(), lineImage.getFC()]);\n      if (data.scaleOld != null) { // Legacy\n        line.imageS = Math.abs(data.scaleOld) * 1080 / image.height;\n        line.imageU = data.scaleOld > 0;\n      }\n      if (data.scale != null) line.imageS = data.scale;\n      if (data.aspect != null) line.imageA = data.aspect;\n      if (data.useBackgroundDim != null) line.imageD = data.useBackgroundDim;\n      if (data.useLineColor != null) line.imageC = data.useLineColor;\n      if (data.useLineScale != null) line.imageU = data.useLineScale;\n    }\n  }\n}\nasync function mainPause() {\n  if (emitter.eq('stop') || isOutOver) return;\n  if (emitter.eq('play')) {\n    if (app.bgVideo != null) app.bgVideo.pause();\n    timeIn.pause();\n    if (showTransition.checked && isOutStart) timeOut.pause();\n    curTime = timeBgm;\n    audio.stop();\n    audio.play(res.mute, { loop: true }); // TODO: 重构\n    emitter.emit('pause');\n  } else {\n    if (app.bgVideo != null) await playVideo(app.bgVideo, timeBgm * app.speed);\n    timeIn.play();\n    if (showTransition.checked && isOutStart) timeOut.play();\n    if (isInEnd && !isOutStart) playBgm(app.bgMusic, timeBgm * app.speed);\n    // console.log(app.bgVideo);\n    emitter.emit('play');\n  }\n}\n// Plugins\nconst debounce = (callback: () => void, delay: number) => {\n  let timer = 0;\n  return () => {\n    clearTimeout(timer);\n    timer = self.setTimeout(callback, delay);\n  };\n};\nconst loadPlugin = (searchValue: string, callback: () => void) => {\n  inputName.addEventListener('input', debounce(() => {\n    if (inputName.value === searchValue) {\n      callback();\n      inputName.value = '';\n      inputName.dispatchEvent(new Event('input'));\n    }\n  }, 1e3));\n};\nconst appendCfg = (name: string, callback: () => void) => new Checkbox(name).appendBefore(resetCfg.container).hook(callback);\nmain.fireModal = function(navHTML = '', contentHTML = '') {\n  const cover = document.createElement('div');\n  cover.classList.add('cover-dark', 'fade');\n  const container = document.createElement('div');\n  container.classList.add('cover-view', 'fade');\n  const nav = document.createElement('div');\n  nav.classList.add('view-nav');\n  if (typeof navHTML === 'string') nav.innerHTML = navHTML;\n  else nav.appendChild(navHTML);\n  const content = document.createElement('div');\n  content.classList.add('view-content');\n  if (typeof contentHTML === 'string') content.innerHTML = contentHTML;\n  else content.appendChild(contentHTML);\n  content.addEventListener('custom-done', () => cover.click());\n  container.append(nav, content);\n  requestAnimationFrame(() => {\n    ($('.main') as HTMLDivElement).append(cover, container);\n    requestAnimationFrame(() => {\n      cover.classList.remove('fade');\n      container.classList.remove('fade');\n    });\n  });\n  cover.addEventListener('click', () => {\n    cover.classList.add('fade');\n    cover.addEventListener('transitionend', () => {\n      cover.remove();\n    });\n    container.classList.add('fade');\n    container.addEventListener('transitionend', () => {\n      container.remove();\n    });\n  });\n  return content;\n};\nmain.toast = (msg = '') => main.fireModal('<p>提示</p>', `<p style=\"white-space:pre;text-align:left;display:inline-block;\">${msg}</p>`);\nmain.error = (msg = '') => main.fireModal('<p>错误</p>', `<p style=\"white-space:pre;text-align:left;display:inline-block;\">${msg}</p>`);\nmain.define = a => a;\nmain.use = async m => {\n  const module = await m.then(n => n.default);\n  for (const data of module.contents) {\n    if (data.type === 'command') loadPlugin(data.meta[0], data.meta[1]);\n    else if (data.type === 'script') data.meta[0]($);\n    else if (data.type === 'config') appendCfg(data.meta[0], data.meta[1]);\n    else throw new TypeError(`Unknown Plugin Type: ${data.type}`);\n  }\n  console.log(module);\n  return module;\n};\nmain.use(import('@/plugins/phizone.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/tips.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/filter.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/skin.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/export.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/gauge.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/dynamic-score.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/video-recorder.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/plugins/online.js') as unknown as Promise<ModuleBase>);\n// debug\nself.hook = main;\nexport const hook = main;\nmain.stat = stat;\nmain.app = app;\nmain.res = res;\nmain.audio = audio;\nmain.sendText = sendText;\nmain.sendWarning = sendWarning;\nmain.sendError = sendError;\nmain.frameAnimater = frameAnimater;\nmain.timeEnd = timeEnd;\nmain.bgms = bgms;\nmain.inputName = inputName;\nmain.selectbgm = selectbgm;\nmain.selectchart = selectchart;\nmain.chartsMD5 = chartsMD5;\nmain.noteRender = noteRender;\nmain.reader = reader;\nmain.ZipReader = ZipReader;\nmain.status = status;\nmain.tmps = tmps;\nmain.awawa = false;\n// play\ninterface MainOptions {\n  pause: typeof pause;\n  // play: typeof mainPlay;\n  // stop: typeof mainPlay;\n  playing: boolean;\n  time: number;\n}\nconst pause = async() => emitter.eq('play') && mainPause();\nmain.pause = pause;\nObject.defineProperty(main, 'playing', {\n  get: () => emitter.eq('play')\n  // set: v => v ? mainPause() : mainPause()\n});\nObject.defineProperty(main, 'time', {\n  get: () => timeBgm,\n  set(v: number) {\n    const handler = async() => {\n      if (emitter.eq('stop') || isOutOver) return;\n      const isPlaying = emitter.eq('play');\n      if (isPlaying) await mainPause();\n      timeBgm = v / app.speed;\n      curTime = timeBgm;\n      app.seekLineEventIndex();\n      // app.notes.forEach(a => { a.status = 0;\n      //   a.scored = 0;\n      //   a.holdStatus = 1; });\n      // stat.reset();\n      if (isPlaying) await mainPause().catch((e: unknown) => console.error(e)); // FIXME: video+gauge结算时会报错\n    };\n    handler();\n  }\n});\n// cover\ninterface MainOptions {\n  cover: typeof cover;\n}\nconst cover = {\n  color: 'black',\n  value: 0,\n  setValueCurve(...values: number[]) { // [time, value, ...]\n    if (!(values.length &= ~1)) return;\n    const lastTime = performance.now();\n    const lastValue = this.value;\n    requestAnimationFrame(function callback(t) {\n      const id = requestAnimationFrame(callback);\n      let time = (t - lastTime) * 1e-3;\n      if (time < 0) time = 0; // 实测有时会出现负数，可能计算出NaN导致闪屏\n      for (let i = 0; i < values.length; i += 2) {\n        if (time < values[i]) {\n          const start = i === 0 ? lastValue : values[i - 1];\n          const end = values[i + 1];\n          cover.value = start + (end - start) * time / values[i];\n          return;\n        } time -= values[i];\n      }\n      if (time >= 0) {\n        cover.value = values[values.length - 1];\n        cancelAnimationFrame(id);\n      }\n    });\n  }\n};\nmain.cover = cover;\nmain.afterAll.set('main::cover', () => {\n  if (cover.value > 0) {\n    ctx.fillStyle = cover.color;\n    ctx.globalAlpha = cover.value;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n  }\n});\n/* exported hook */\nif (new URLSearchParams(location.search).has('iframe')) {\n  document.body.classList.add('iframe');\n  stage.setFull(true);\n  stage.resize();\n  specialClick.func[3] = async() => Promise.resolve(window.parent.postMessage('full', '*'));\n}\nself.onmessage = evt => {\n  console.log('onmessage', evt);\n  if (evt.data instanceof File) {\n    const reader1 = new FileReader();\n    reader1.readAsArrayBuffer(evt.data);\n    reader1.onload = () => {\n      uploader.fireLoad(evt.data as File, reader1.result as ArrayBuffer);\n    };\n  } else if (evt.data === 'play') {\n    mainPlay();\n  }\n};\n\n\n\n// office 部分\n// 初始化后回调\nOffice.onReady(function() {\n\ninit()\n});\n\n","export class Stage {\n  private aspectRatio: number;\n  private isFull: boolean;\n  private readonly stage: HTMLDivElement;\n  public constructor(stage: HTMLDivElement) {\n    this.aspectRatio = 0;\n    this.isFull = false;\n    this.stage = stage;\n    this.resize();\n  }\n  public resize(ratio = 0): void {\n    this.aspectRatio = ratio || this.aspectRatio || 16 / 9;\n    const devicePixelRatio = self.devicePixelRatio || 1;\n    const rawWidth = Math.min(854, document.body.getBoundingClientRect().width * 0.8);\n    const width = Math.round(rawWidth * devicePixelRatio);\n    const height = Math.ceil(width / this.aspectRatio); // 保证实际宽高比不大于理论值，防止出现黑边\n    const stageWidth = width / devicePixelRatio;\n    const stageHeight = height / devicePixelRatio;\n    if (this.isFull) this.stage.style.cssText = ';position:fixed;top:0;left:0;bottom:0;right:0';\n    else this.stage.style.cssText = `;width:${stageWidth.toFixed(3)}px;height:${stageHeight.toFixed(3)}px`;\n  }\n  public getFull(): boolean {\n    return this.isFull;\n  }\n  public setFull(isFull: boolean): boolean {\n    return this.isFull = isFull;\n  }\n}\n","interface SpeedEventExtends extends SpeedEvent {\n  floorPosition: number;\n  floorPosition2: number;\n  startSeconds: number;\n  endSeconds: number;\n}\ninterface NoteExtends extends Note {\n  maxVisiblePos: number;\n  offsetX: number;\n  offsetY: number;\n  alpha: number;\n  seconds: number;\n  holdSeconds: number;\n  line: JudgeLine;\n  lineId: number;\n  noteId: number;\n  isAbove: boolean;\n  name: string;\n  isMulti: boolean;\n  nearNotes: NoteExtends[];\n  badTime?: number;\n  badY?: number;\n  projectX: number;\n  projectY: number;\n  cosr: number;\n  sinr: number;\n  visible: boolean;\n  showPoint: boolean;\n  frameCount: number;\n  status: number;\n  scored: boolean;\n  holdTapTime: number;\n  holdStatus: number;\n  holdBroken: boolean;\n  statOffset: number;\n}\ninterface LineEventExtends extends JudgeLineEvent {\n  startSeconds: number;\n  endSeconds: number;\n}\ninterface JudgeLineExtends extends JudgeLine {\n  lineId: number;\n  offsetX: number;\n  offsetY: number;\n  alpha: number;\n  rotation: number;\n  positionY: number;\n  positionY2: number;\n  speedEvents: SpeedEventExtends[];\n  notesAbove: NoteExtends[];\n  notesBelow: NoteExtends[];\n  judgeLineDisappearEvents: LineEventExtends[];\n  judgeLineMoveEvents: LineEventExtends[];\n  judgeLineRotateEvents: LineEventExtends[];\n  disappearEventsIndex: number;\n  moveEventsIndex: number;\n  rotateEventsIndex: number;\n  speedEventsIndex: number;\n  cosr: number;\n  sinr: number;\n  imageW: number;\n  imageH: number;\n  imageD: boolean;\n  imageU: boolean;\n  imageS: number;\n  imageA: number;\n  imageL: [ImageBitmap, ImageBitmap, null, ImageBitmap];\n  imageC: boolean;\n}\ninterface ChartExtends extends Chart {\n  maxSeconds: number;\n  judgeLineList: JudgeLineExtends[];\n}\ninterface EventSeconds {\n  startTime: number;\n  endTime: number;\n  startSeconds: number;\n  endSeconds: number;\n}\nexport class Renderer {\n  // 容器和画布上下文\n  public stage: HTMLDivElement;\n  public canvas: HTMLCanvasElement;\n  public ctx: CanvasRenderingContext2D;\n  public canvasfg: HTMLCanvasElement;\n  public ctxfg: CanvasRenderingContext2D;\n  /** Half of the width of the canvas. */\n  public wlen: number;\n  /** Half of the height of the canvas. */\n  public hlen: number;\n  public scaleX: number;\n  public scaleY: number;\n  private width: number;\n  private height: number;\n  private matX: (x: number) => number;\n  private matY: (y: number) => number;\n  private matR: (r: number) => number;\n  // 用户设置项\n  public speed: number;\n  public lineScale: number;\n  public noteScale: number;\n  public noteScaleRatio: number;\n  public brightness: number;\n  public multiHint: boolean;\n  public playMode: number;\n  public musicVolume: number;\n  public soundVolume: number;\n  public enableFR: boolean;\n  public enableVP: boolean;\n  public lowResFactor: number;\n  // 谱面数据\n  public readonly lines: JudgeLineExtends[];\n  public readonly notes: NoteExtends[];\n  public readonly taps: NoteExtends[];\n  public readonly drags: NoteExtends[];\n  public readonly flicks: NoteExtends[];\n  public readonly holds: NoteExtends[];\n  public linesReversed: JudgeLineExtends[];\n  public notesReversed: NoteExtends[];\n  public tapsReversed: NoteExtends[];\n  public dragsReversed: NoteExtends[];\n  public flicksReversed: NoteExtends[];\n  public holdsReversed: NoteExtends[];\n  public readonly tapholds: NoteExtends[];\n  // 资源数据\n  public chart: ChartExtends | null;\n  public bgMusic: AudioBuffer | null;\n  public bgVideo: HTMLVideoElement | null;\n  private _mirrorType: number;\n  private initialized: boolean;\n  public constructor(stage: unknown) {\n    if (!(stage instanceof HTMLDivElement)) throw new Error('Not a container');\n    const fail = () => { throw new Error('Failed to initialize canvas') };\n    this.stage = stage;\n    this.canvas = document.createElement('canvas');\n    this.ctx = this.canvas.getContext('2d', { alpha: false }) || fail(); // 游戏界面(alpha:false会使Firefox显示异常/需要验证)\n    this.canvasfg = document.createElement('canvas'); // 绘制游戏主界面(OffscreenCanvas会使Safari崩溃)\n    this.ctxfg = this.canvasfg.getContext('2d') || fail();\n    this.stage.appendChild(this.canvas);\n    this.canvas.style.cssText = ';position:absolute;top:0px;left:0px;right:0px;bottom:0px';\n    console.log('Hello, Phixos! IN OFFICE ADD-INS');\n    // config\n    this.speed = 1;\n    this.lineScale = 57.6;\n    this.noteScale = 1; // note缩放设定值\n    this.noteScaleRatio = 8e3; // note缩放比率，由noteScale计算而来\n    this.brightness = 0.6;\n    // this.songName = '';\n    // this.chartLevel = '';\n    // this.illustrator = '';\n    // this.chartDesign = '';\n    // this.feedback = true;\n    // this.imageBlur = true;\n    this.multiHint = true;\n    // this.hitSound = true;\n    // this.anchorPoint = false;\n    // this.coloredLine = true;\n    // this.perfectLine = '#feffa9';\n    // this.goodLine = '#a2eeff';\n    // this.perfectNote = '#ffeca0';\n    // this.goodNote = '#b4e1ff';\n    // this.badNote = '#6c4343';\n    this.playMode = 1; // 0:game,1:auto,2:hyper,3:auto&hyper\n    this.musicVolume = 1;\n    this.soundVolume = 1;\n    // this.showTransition = true;\n    // this.chartOffset = 0;\n    this._mirrorType = 0;\n    this.enableFR = false;\n    this.enableVP = false;\n    // chart\n    this.chart = null;\n    this.bgMusic = null;\n    this.bgVideo = null;\n    this.lines = [];\n    this.notes = [];\n    this.taps = [];\n    this.drags = [];\n    this.flicks = [];\n    this.holds = [];\n    this.linesReversed = [];\n    this.notesReversed = [];\n    this.tapsReversed = [];\n    this.dragsReversed = [];\n    this.flicksReversed = [];\n    this.holdsReversed = [];\n    this.tapholds = [];\n    // canvas\n    this.lowResFactor = 1;\n    this.width = 0;\n    this.height = 0;\n    this.wlen = 0;\n    this.hlen = 0;\n    this.scaleX = 0;\n    this.scaleY = 0;\n    this.matX = x => x;\n    this.matY = y => y;\n    this.matR = r => r;\n    this.initialized = false;\n    // event\n    this._setLowResFactor(1);\n    this.resizeCanvas();\n  }\n  public get duration(): number {\n    if (this.bgMusic) return this.bgMusic.duration;\n    if (this.chart) return this.chart.maxSeconds + 0.5;\n    throw new TypeError('Illegal state');\n  }\n  // config\n  public setNoteScale(num = 1): void {\n    this.noteScale = num;\n    this.noteScaleRatio = this.canvasfg.width * this.noteScale / 8080; // note、特效缩放\n  }\n  public setLowResFactor(num = 1): void {\n    this._setLowResFactor(num);\n    this._resizeCanvas();\n  }\n  public resizeCanvas(): void {\n    const { width, height } = this.stage.getBoundingClientRect();\n    if (this.width === width && this.height === height) return;\n    this.width = width;\n    this.height = height;\n    this.canvas.style.cssText += `;width:${width.toFixed(3)}px;height:${height.toFixed(3)}px`; // 只有inset还是会溢出\n    this._resizeCanvas();\n  }\n  public mirrorView(code = this._mirrorType): void {\n    const n = 3 & code;\n    this._mirrorType = n;\n    this.transformView(1 & n ? -1 : 1, 2 & n ? -1 : 1, 0, 0);\n  }\n  public transformView(scaleX = 1, scaleY = 1, offsetX = 0, offsetY = 0): void {\n    const { canvasfg } = this;\n    const xa = canvasfg.width * scaleX;\n    const xb = (canvasfg.width - xa) * 0.5;\n    const ya = -canvasfg.height * scaleY;\n    const yb = (canvasfg.height - ya) * 0.5;\n    const ra = -Math.sign(scaleX * scaleY) * Math.PI / 180;\n    const rb = scaleY > 0 ? 0 : Math.PI;\n    const tx = Math.sign(scaleY) * xa * 0.05625;\n    const ty = Math.sign(scaleY) * -ya * 0.6; // 控制note流速\n    this.matX = x => xb + xa * (x - offsetX);\n    this.matY = y => yb + ya * (y - offsetY);\n    this.matR = r => rb + ra * r;\n    this.scaleX = tx;\n    this.scaleY = ty;\n    this.initialized = true;\n  }\n  // note预处理\n  public prerenderChart(chart: Chart): void {\n    this.lines.length = 0;\n    this.notes.length = 0;\n    this.taps.length = 0;\n    this.drags.length = 0;\n    this.flicks.length = 0;\n    this.holds.length = 0;\n    this.tapholds.length = 0;\n    const chartNew = chart.duplicate() as ChartExtends;\n    for (const line of chartNew.judgeLineList) {\n      let y = Math.fround(line.speedEvents[0].startTime / line.bpm * 1.875);\n      let y2 = y; // float32\n      for (const evt of line.speedEvents) {\n        evt.floorPosition = y;\n        evt.floorPosition2 = y2;\n        const dy = (evt.endTime - evt.startTime) / line.bpm * 1.875;\n        y += dy * evt.value;\n        y2 += Math.fround(Math.fround(dy) * evt.value);\n        y = Math.fround(y);\n        y2 = Math.fround(y2);\n      }\n    }\n    const ss = {\n      aniStart: 1e9,\n      aniEnd: 0,\n      hitStart: 1e9,\n      hitEnd: 0\n    };\n    const aniUpdate = (seconds: number) => {\n      if (seconds < ss.aniStart) ss.aniStart = seconds;\n      if (seconds > ss.aniEnd) ss.aniEnd = seconds;\n    };\n    const hitUpdate = (seconds: number) => {\n      aniUpdate(seconds);\n      if (seconds < ss.hitStart) ss.hitStart = seconds;\n      if (seconds > ss.hitEnd) ss.hitEnd = seconds;\n    };\n    // 添加seconds\n    const addSeconds = (events: EventSeconds[], bpm: number) => {\n      for (const evt of events) {\n        evt.startSeconds = evt.startTime / bpm * 1.875;\n        evt.endSeconds = evt.endTime / bpm * 1.875;\n        if (evt.startTime > 1 - 1e6) aniUpdate(evt.startSeconds);\n        if (evt.endTime < 1e9 && evt.endTime !== events[events.length - 1].endTime) aniUpdate(evt.endSeconds);\n      }\n    };\n    // 获取note最大可见位置\n    const getMaxVisiblePos = (x: number) => {\n      const n = Math.fround(x);\n      if (!isFinite(n)) throw new TypeError('Argument must be a finite number');\n      const magic = 11718.75;\n      const prime = n >= magic ? 2 ** Math.floor(1 + Math.log2(n / magic)) : 1;\n      const a = n / prime + 0.001;\n      const r = Math.fround(a);\n      if (r <= a) return r * prime;\n      const a_ = new Float32Array([a]);\n      new Uint32Array(a_.buffer)[0] += a_[0] <= 0 ? 1 : -1;\n      return a_[0] * prime;\n    };\n    // 向Renderer添加Note\n    const addNote = (note: NoteExtends, beat32: number, line: JudgeLineExtends, noteId: number, isAbove: boolean) => {\n      note.offsetX = 0;\n      note.offsetY = 0;\n      note.alpha = 0;\n      note.seconds = note.time * beat32;\n      note.holdSeconds = note.holdTime * beat32;\n      note.maxVisiblePos = getMaxVisiblePos(note.floorPosition);\n      if (note.time < 1e9) {\n        hitUpdate(note.seconds);\n        hitUpdate(note.seconds + note.holdSeconds);\n      }\n      note.line = line;\n      note.lineId = line.lineId;\n      note.noteId = noteId;\n      note.isAbove = isAbove;\n      note.name = `${line.lineId}${isAbove ? '+' : '-'}${noteId}${'?tdhf'[note.type]}`;\n      this.notes.push(note);\n      if (note.type === 1) this.taps.push(note);\n      else if (note.type === 2) this.drags.push(note);\n      else if (note.type === 3) this.holds.push(note);\n      else if (note.type === 4) this.flicks.push(note);\n      if (note.type === 1 || note.type === 3) this.tapholds.push(note);\n    };\n    const sortNote = (a: NoteExtends, b: NoteExtends) => a.seconds - b.seconds || a.lineId - b.lineId || a.noteId - b.noteId;\n    // 优化events\n    chartNew.judgeLineList.forEach((i, lineId) => i.lineId = lineId);\n    for (const line of chartNew.judgeLineList) {\n      line.bpm *= this.speed;\n      line.offsetX = 0;\n      line.offsetY = 0;\n      line.alpha = 0;\n      line.rotation = 0;\n      line.positionY = 0; // 临时过渡用\n      line.positionY2 = 0;\n      // line.speedEvents = normalizeSpeedEvent(line.speedEvents) as SpeedEventExtends[];\n      // line.judgeLineDisappearEvents = normalizeLineEvent(line.judgeLineDisappearEvents) as LineEventExtends[];\n      // line.judgeLineMoveEvents = normalizeLineEvent(line.judgeLineMoveEvents) as LineEventExtends[];\n      // line.judgeLineRotateEvents = normalizeLineEvent(line.judgeLineRotateEvents) as LineEventExtends[];\n      line.disappearEventsIndex = 0;\n      line.moveEventsIndex = 0;\n      line.rotateEventsIndex = 0;\n      line.speedEventsIndex = 0;\n      addSeconds(line.speedEvents, line.bpm);\n      addSeconds(line.judgeLineDisappearEvents, line.bpm);\n      addSeconds(line.judgeLineMoveEvents, line.bpm);\n      addSeconds(line.judgeLineRotateEvents, line.bpm);\n      this.lines.push(line); // TODO: 可以定义新类避免函数在循环里定义\n      line.notesAbove.forEach((j, noteId) => addNote(j, 1.875 / line.bpm, line, noteId, true));\n      line.notesBelow.forEach((j, noteId) => addNote(j, 1.875 / line.bpm, line, noteId, false));\n    }\n    this.notes.sort(sortNote);\n    this.taps.sort(sortNote);\n    this.drags.sort(sortNote);\n    this.holds.sort(sortNote);\n    this.flicks.sort(sortNote);\n    this.notesReversed = this.notes.toReversed();\n    this.tapsReversed = this.taps.toReversed();\n    this.dragsReversed = this.drags.toReversed();\n    this.holdsReversed = this.holds.toReversed();\n    this.flicksReversed = this.flicks.toReversed();\n    this.linesReversed = this.lines.toReversed();\n    this.tapholds.sort(sortNote);\n    // 多押标记\n    const timeOfMulti: Record<string, number> = {};\n    for (const note of this.notes) timeOfMulti[note.seconds.toFixed(6)] = timeOfMulti[note.seconds.toFixed(6)] ? 2 : 1;\n    for (const note of this.notes) note.isMulti = timeOfMulti[note.seconds.toFixed(6)] === 2;\n    // 分析邻近Note(0.01s内标记，用于预处理Flick,TapHold重叠判定)\n    for (let i = 0; i < this.flicks.length; i++) {\n      const note = this.flicks[i];\n      note.nearNotes = [];\n      for (let j = i + 1; j < this.flicks.length; j++) {\n        const note2 = this.flicks[j];\n        if (Math.fround(note2.seconds - note.seconds) > 0.01) break;\n        note.nearNotes.push(note2);\n      }\n    }\n    for (let i = 0; i < this.tapholds.length; i++) {\n      const note = this.tapholds[i];\n      note.nearNotes = [];\n      for (let j = i + 1; j < this.tapholds.length; j++) {\n        const note2 = this.tapholds[j];\n        if (Math.fround(note2.seconds - note.seconds) > 0.01) break;\n        note.nearNotes.push(note2);\n      }\n    }\n    this.chart = chartNew;\n    this.chart.maxSeconds = ss.aniEnd;\n    console.table(ss);\n  }\n  /** 从0开始，将事件index定位到正确位置 */\n  public seekLineEventIndex(time?: number): void {\n    if (!this.initialized) throw new Error('Not initialized');\n    for (const line of this.lines) {\n      line.speedEventsIndex = 0;\n      line.disappearEventsIndex = 0;\n      line.moveEventsIndex = 0;\n      line.rotateEventsIndex = 0;\n      if (time == null) continue;\n      while (line.speedEventsIndex < line.speedEvents.length && line.speedEvents[line.speedEventsIndex].endSeconds < time) line.speedEventsIndex++;\n      while (line.disappearEventsIndex < line.judgeLineDisappearEvents.length && line.judgeLineDisappearEvents[line.disappearEventsIndex].endSeconds < time) line.disappearEventsIndex++;\n      while (line.moveEventsIndex < line.judgeLineMoveEvents.length && line.judgeLineMoveEvents[line.moveEventsIndex].endSeconds < time) line.moveEventsIndex++;\n      while (line.rotateEventsIndex < line.judgeLineRotateEvents.length && line.judgeLineRotateEvents[line.rotateEventsIndex].endSeconds < time) line.rotateEventsIndex++;\n    }\n  }\n  public updateByTime(time: number): void {\n    if (!this.initialized) throw new Error('Not initialized');\n    for (const line of this.lines) {\n      for (let i = line.disappearEventsIndex, len = line.judgeLineDisappearEvents.length; i < len; i++) {\n        const evt = line.judgeLineDisappearEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.alpha = evt.start + (evt.end - evt.start) * dt;\n        if (line.alpha > 1) line.alpha = 1;\n        line.disappearEventsIndex = i;\n        break;\n      }\n      for (let i = line.moveEventsIndex, len = line.judgeLineMoveEvents.length; i < len; i++) {\n        const evt = line.judgeLineMoveEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.offsetX = this.matX(evt.start + (evt.end - evt.start) * dt);\n        line.offsetY = this.matY(evt.start2 + (evt.end2 - evt.start2) * dt);\n        line.moveEventsIndex = i;\n        break;\n      }\n      for (let i = line.rotateEventsIndex, len = line.judgeLineRotateEvents.length; i < len; i++) {\n        const evt = line.judgeLineRotateEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.rotation = this.matR(evt.start + (evt.end - evt.start) * dt);\n        line.cosr = Math.cos(line.rotation);\n        line.sinr = Math.sin(line.rotation);\n        line.rotateEventsIndex = i;\n        break;\n      }\n      for (let i = line.speedEventsIndex, len = line.speedEvents.length; i < len; i++) {\n        const evt = line.speedEvents[i];\n        if (time > evt.endSeconds) continue;\n        line.positionY = (time - evt.startSeconds) * this.speed * evt.value + (this.enableFR ? evt.floorPosition2 : evt.floorPosition);\n        line.positionY2 = (time - evt.startSeconds) * this.speed * evt.value + evt.floorPosition2;\n        line.speedEventsIndex = i;\n        break;\n      }\n      const getGoodY = (i: NoteExtends) => {\n        if (i.type !== 3) return (i.floorPosition - line.positionY) * i.speed;\n        if (i.seconds < time) return (i.seconds - time) * this.speed * i.speed;\n        return i.floorPosition - line.positionY;\n      };\n      const getBadY = (i: NoteExtends) => {\n        if (i.badTime == null) return getGoodY(i);\n        if (performance.now() - i.badTime > 500) delete i.badTime;\n        if (i.badY == null) i.badY = getGoodY(i);\n        return i.badY;\n      };\n      const setAlpha = (i: NoteExtends, dx: number, dy: number) => {\n        i.projectX = line.offsetX + dx * i.cosr;\n        i.offsetX = i.projectX + dy * i.sinr;\n        i.projectY = line.offsetY + dx * i.sinr;\n        i.offsetY = i.projectY - dy * i.cosr;\n        i.visible = (i.offsetX - this.wlen) ** 2 + (i.offsetY - this.hlen) ** 2 < (this.wlen * 1.23625 + this.hlen + this.scaleY * i.holdSeconds * this.speed * i.speed) ** 2; // Math.hypot实测性能较低\n        i.showPoint = false;\n        if (i.badTime != null) {\n          // Not bad\n        } else if (i.seconds > time) {\n          i.showPoint = true;\n          const isHidden = i.maxVisiblePos < line.positionY2;\n          i.alpha = isHidden || this.enableVP && getGoodY(i) * 0.6 > 2 ? 0 : i.type === 3 && i.speed === 0 ? 0 : 1;\n        } else {\n          // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n          i.frameCount = i.frameCount == null ? 0 : i.frameCount + 1;\n          if (i.type === 3) {\n            i.showPoint = true;\n            i.alpha = i.speed === 0 ? 0 : i.status % 4 === 2 ? 0.45 : 1;\n          } else i.alpha = Math.max(1 - (time - i.seconds) / 0.16, 0); // 过线后0.16s消失\n        }\n      };\n      for (const note of line.notesAbove) {\n        note.cosr = line.cosr;\n        note.sinr = line.sinr;\n        setAlpha(note, this.scaleX * note.positionX, this.scaleY * getBadY(note));\n      }\n      for (const note of line.notesBelow) {\n        note.cosr = -line.cosr;\n        note.sinr = -line.sinr;\n        setAlpha(note, -this.scaleX * note.positionX, this.scaleY * getBadY(note));\n      }\n    }\n  }\n  private _setLowResFactor(num = 1) {\n    this.lowResFactor = num;\n  }\n  private _resizeCanvas() {\n    const { canvas, canvasfg, width, height } = this;\n    const lowResFactor = this.lowResFactor * self.devicePixelRatio;\n    const widthLowRes = width * lowResFactor;\n    const heightLowRes = height * lowResFactor;\n    canvas.width = widthLowRes;\n    canvas.height = heightLowRes;\n    canvasfg.width = Math.min(widthLowRes, heightLowRes * 16 / 9);\n    canvasfg.height = heightLowRes;\n    this.wlen = canvasfg.width / 2;\n    this.hlen = canvasfg.height / 2;\n    this.mirrorView();\n    this.setNoteScale(this.noteScale);\n    this.lineScale = canvasfg.width > canvasfg.height * 0.75 ? canvasfg.height / 18.75 : canvasfg.width / 14.0625; // 判定线、文字缩放\n  }\n}\nexport namespace Renderer {\n  export type Note = NoteExtends;\n  export type JudgeLine = JudgeLineExtends;\n}\n// // 规范判定线事件\n// function normalizeLineEvent(events: JudgeLineEvent[]) {\n//   const oldEvents = events.map(i => new JudgeLineEvent(i as unknown as Record<string, unknown>)); // 深拷贝\n//   if (!oldEvents.length) return [new JudgeLineEvent({ startTime: -999999, endTime: 1e9 })]; // 如果没有事件，添加一个默认事件(以后添加warning)\n//   const newEvents = [\n//     new JudgeLineEvent({\n//       startTime: -999999,\n//       endTime: 0,\n//       start: oldEvents[0].start,\n//       end: oldEvents[0].start,\n//       start2: oldEvents[0].start2,\n//       end2: oldEvents[0].start2\n//     })\n//   ]; // 以1-1e6开头\n//   oldEvents.push(new JudgeLineEvent({\n//     startTime: oldEvents[oldEvents.length - 1].endTime,\n//     endTime: 1e9,\n//     start: oldEvents[oldEvents.length - 1].end,\n//     end: oldEvents[oldEvents.length - 1].end,\n//     start2: oldEvents[oldEvents.length - 1].end2,\n//     end2: oldEvents[oldEvents.length - 1].end2\n//   })); // 以1e9结尾\n//   for (const i2 of oldEvents) {\n//     // 保证时间连续性\n//     if (i2.startTime > i2.endTime) continue;\n//     const i1 = newEvents[newEvents.length - 1];\n//     if (i1.endTime > i2.endTime) {\n//       // 忽略\n//     } else if (i1.endTime === i2.startTime) newEvents.push(i2);\n//     else if (i1.endTime < i2.startTime) {\n//       newEvents.push(new JudgeLineEvent({\n//         startTime: i1.endTime,\n//         endTime: i2.startTime,\n//         start: i1.end,\n//         end: i1.end,\n//         start2: i1.end2,\n//         end2: i1.end2\n//       }), i2);\n//     } else if (i1.endTime > i2.startTime) {\n//       newEvents.push(new JudgeLineEvent({\n//         startTime: i1.endTime,\n//         endTime: i2.endTime,\n//         start: (i2.start * (i2.endTime - i1.endTime) + i2.end * (i1.endTime - i2.startTime)) / (i2.endTime - i2.startTime),\n//         end: i1.end,\n//         start2: (i2.start2 * (i2.endTime - i1.endTime) + i2.end2 * (i1.endTime - i2.startTime)) / (i2.endTime - i2.startTime),\n//         end2: i1.end2\n//       }));\n//     }\n//   }\n//   // 合并相同变化率事件\n//   const newEvents2 = [newEvents.shift()!];\n//   for (const i2 of newEvents) {\n//     const i1 = newEvents2[newEvents2.length - 1];\n//     const d1 = i1.endTime - i1.startTime;\n//     const d2 = i2.endTime - i2.startTime;\n//     if (i2.startTime === i2.endTime) {\n//       // 忽略\n//     } else if (i1.end === i2.start && i1.end2 === i2.start2 && (i1.end - i1.start) * d2 === (i2.end - i2.start) * d1 && (i1.end2 - i1.start2) * d2 === (i2.end2 - i2.start2) * d1) {\n//       i1.endTime = i2.endTime;\n//       i1.end = i2.end;\n//       i1.end2 = i2.end2;\n//     } else newEvents2.push(i2);\n//   }\n//   return newEvents2;\n// }\n// // 规范speedEvents\n// function normalizeSpeedEvent(events: SpeedEvent[]) {\n//   const newEvents = [];\n//   for (const i2 of events) {\n//     const i1 = newEvents[newEvents.length - 1];\n//     if (i1?.value === i2.value) i1.endTime = i2.endTime;\n//     else newEvents.push(i2);\n//   }\n//   return newEvents;\n// }\n","import { setSetting, rmSetting, isOfficeInited,activeview } from \"@/office\";\n// Html交互(WIP)\nexport class StatusManager {\n  private readonly key: string;\n  private data: Record<string, string>;\n  public constructor(key: string) {\n    this.key = key;\n    this.data = {};\n  }\n  public init(resetCallback: (data: Record<string, string>) => string): this {\n    try {\n      var dataOffice = Office.context.document.settings.get(this.key)\n    }\n    catch (e) {\n      var dataOffice = undefined\n    }\n    if (dataOffice != undefined) {\n      this.data = JSON.parse(dataOffice ?? '{}') as Record<string, string>\n    }\n    else {\n      this.data = JSON.parse(localStorage.getItem(this.key) ?? '{}') as Record<string, string>\n    };\n    if (typeof resetCallback === 'function') {\n      if (resetCallback(this.data)) this.reset();\n    }\n    return this;\n  }\n  public save(): void {\n    localStorage.setItem(this.key, JSON.stringify(this.data));\n    if (isOfficeInited == 1 && activeview == 0) {\n      setSetting(this.key, JSON.stringify(this.data));\n    }\n  }\n  public reset(): void {\n    this.data = {};\n    this.save();\n    if (isOfficeInited == 1 && activeview == 0) {\n      rmSetting(true, \"0\")\n    }\n  }\n  public get(key: string): string | undefined {\n    return this.data[key];\n  }\n  public set(key: string, value: string): void {\n    this.data[key] = value;\n    this.save();\n  }\n  public reg(key: string, node: HTMLElement, dispatch: unknown = true): void {\n    if (node instanceof HTMLInputElement || node instanceof HTMLSelectElement) {\n      const property = node.type === 'checkbox' ? 'checked' : 'value';\n      const value = this.get(key);\n      if (value !== undefined) ((node as HTMLInputElement)[property] as string) = value;\n      node.addEventListener('change', () => {\n        this.set(key, (node as HTMLInputElement)[property] as string);\n      });\n      if (dispatch as boolean) node.dispatchEvent(new Event('change'));\n    } else if (node instanceof HTMLTextAreaElement) {\n      const value = this.get(key);\n      if (value !== undefined) (node.value as unknown) = value;\n      node.addEventListener('change', () => {\n        this.set(key, node.value);\n      });\n      if (dispatch as boolean) node.dispatchEvent(new Event('change'));\n    } else throw new Error('Node must be <input>, <select> or <textarea>');\n  }\n}\n","export class FrameTimer {\n  private tick: number;\n  private time: number;\n  private fps: number;\n  public constructor() {\n    this.tick = 0;\n    this.time = performance.now();\n    this.fps = 0;\n  }\n  public get fpsStr(): string {\n    const { fps } = this;\n    if (fps < 10) return fps.toPrecision(2);\n    return fps.toFixed(0);\n  }\n  public get disp(): number {\n    return 0.5 / this.fps || 0;\n  }\n  public addTick(fr = 10): number {\n    if (++this.tick >= fr) {\n      this.tick = 0;\n      this.fps = 1e3 * fr / (-this.time + (this.time = performance.now()));\n    }\n    return this.fps;\n  }\n}\n","export class FrameAnimater {\n  private callback: (arg0: number) => void;\n  private lastTime: number;\n  private interval: number;\n  private id: number | null;\n  public constructor() {\n    this.callback = (): void => {};\n    this.lastTime = 0;\n    this.interval = Number.EPSILON;\n    this.id = null;\n    this._animate = this._animate.bind(this);\n  }\n  public start(): void {\n    if (this.id !== null) return;\n    this.lastTime = performance.now();\n    this.id = requestAnimationFrame(this._animate.bind(this));\n  }\n  public stop(): void {\n    if (this.id === null) return;\n    cancelAnimationFrame(this.id);\n    this.id = null;\n  }\n  public setCallback(callback: (arg0: number) => void): void {\n    if (typeof callback !== 'function') throw new TypeError('callback is not a function');\n    this.callback = callback;\n  }\n  public setFrameRate(frameRate: number): void {\n    this.interval = Math.abs(1e3 / frameRate);\n    if (!isFinite(this.interval)) this.interval = Number.EPSILON;\n  }\n  private _animate() {\n    this.id = requestAnimationFrame(this._animate.bind(this)); // 回调更新动画\n    const nowTime = performance.now();\n    const elapsed = nowTime - this.lastTime;\n    if (elapsed > this.interval) {\n      this.lastTime = nowTime - elapsed % this.interval;\n      this.callback(nowTime);\n    }\n  }\n}\n","import { getConstructorName, isUndefined, loadJS, orientation } from '@/js/common.js';\nimport { audio } from '@/external';\nexport async function checkSupport({\n  messageCallback = (_msg: string) => {},\n  warnCallback = (_msg: string) => {},\n  errorCallback = (_msg: string, _html: string, _fatal?: boolean) => {},\n  mobileCallback = () => {},\n  orientNotSupportCallback = () => {}\n} = {}): Promise<number> {\n  const sysError = (error: unknown, message?: string) => {\n    const type = getConstructorName(error) as string;\n    // if (message==='Script error.') return;\n    let message2 = String(error);\n    let detail = String(error);\n    if (error instanceof Error) {\n      const stack = error.stack ?? 'Stack not available';\n      if (error.name === type) message2 = error.message;\n      else message2 = `${error.name}: ${error.message}`;\n      const idx = stack.indexOf(message2) + 1;\n      if (idx) detail = `${message2}\\n${stack.slice(idx + message2.length)}`;\n      else detail = `${message2}\\n    ${stack.split('\\n').join('\\n    ')}`; // Safari\n    }\n    if (message != null) message2 = message;\n    const errMessage = `[${type}] ${message2.split('\\n')[0]}`;\n    const errDetail = `[${type}] ${detail}`;\n    errorCallback(errMessage, Utils.escapeHTML(errDetail));\n  };\n  self.addEventListener('error', e => sysError(e.error, e.message));\n  self.addEventListener('unhandledrejection', e => sysError(e.reason));\n  const loadLib = async(name: string, urls: string[] | string, check: () => boolean) => {\n    if (!check()) return true;\n    const errmsg1 = `错误：${name}组件加载失败（点击查看详情）`;\n    const errmsg2 = `${name}组件加载失败，请检查您的网络连接然后重试：`;\n    const errmsg3 = `${name}组件加载失败，请检查浏览器兼容性`;\n    messageCallback(`加载${name}组件...`);\n    await loadJS(urls).catch((e: unknown) => {\n      const msg = e instanceof Error ? e.message : String(e);\n      errorCallback(errmsg1, msg.replace(/.+/, errmsg2), true);\n    });\n    if (!check()) return true;\n    errorCallback(errmsg1, errmsg3, true);\n    return false;\n  };\n  await Utils.addFont('Titillium Web', { alt: 'Custom' });\n  // 兼容性检测\n  messageCallback('检查浏览器兼容性...');\n  const isMobile = navigator.standalone !== undefined || navigator.platform.includes('Linux') && navigator.maxTouchPoints === 5;\n  if (isMobile) mobileCallback();\n  checkMiuiVersion(warnCallback);\n  if (!await loadLib('ImageBitmap兼容', '/lib/createImageBitmap.js', () => isUndefined('createImageBitmap'))) return -1;\n  messageCallback('加载音频组件...');\n  const oggCompatible = new Audio().canPlayType('audio/ogg') !== '';\n  if (!await loadLib('ogg格式兼容', '/lib/oggmented-bundle.js', () => !oggCompatible && isUndefined('oggmented'))) return -4;\n  audio.init(oggCompatible ? self.AudioContext : self.oggmented.OggmentedAudioContext); // 兼容Safari\n  const webpCompatible = document.createElement('canvas').toDataURL('image/webp').includes('data:image/webp');\n  if (!await loadLib('webp格式兼容', '/lib/webp-bundle.js', () => !webpCompatible && isUndefined('webp'))) return -5;\n  await checkOrient(orientNotSupportCallback);\n  return 0;\n}\nfunction checkMiuiVersion(warnCallback: (_msg: string) => void) {\n  if (navigator.userAgent.includes('MiuiBrowser')) {\n    // 实测 v17.1.8 问题仍然存在，v17.4.80113 问题已修复\n    const miuiVersion = /MiuiBrowser\\/(\\d+\\.\\d+)/.exec(navigator.userAgent);\n    const text = '检测到小米浏览器且版本低于17.4，可能存在切后台声音消失的问题';\n    if (miuiVersion == null || parseFloat(miuiVersion[1]) < 17.4) warnCallback(text);\n  }\n}\nasync function checkOrient(orientNotSupportCallback: () => void) {\n  const orientSupported = await orientation.checkSupport();\n  if (!orientSupported) orientNotSupportCallback();\n}\n","import createCtx from './createCtx';\nimport { audio } from '@/external';\nexport async function fixme(raw: Record<string, unknown>, res: Record<string, unknown>): Promise<void> {\n  const entries = ['Tap', 'TapHL', 'Drag', 'DragHL', 'HoldHead', 'HoldHeadHL', 'Hold', 'HoldHL', 'HoldEnd', 'Flick', 'FlickHL', 'HitFXRaw'];\n  if (raw.image == null) raw.image = {};\n  const { image } = raw as { image: Record<string, string | null> };\n  for (const entry of entries) {\n    if (image[entry] == null) image[entry] = '|8080';\n  }\n  if (res.Tap == null) {\n    const ctx = createCtx(1089, 200);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 200 L 0 200 Z'));\n    ctx.strokeStyle = '#0ac3e1';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 150 L 50 150 Z'));\n    res.Tap = await createImageBitmap(ctx.canvas);\n  }\n  if (res.TapHL == null) {\n    const ctx = createCtx(1089, 200);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 200 L 0 200 Z'));\n    ctx.strokeStyle = '#0ac3e1';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 150 L 50 150 Z'));\n    res.TapHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Drag == null) {\n    const ctx = createCtx(1089, 160);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 160 L 0 160 Z'));\n    ctx.strokeStyle = '#f0ed69';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 110 L 50 110 Z'));\n    res.Drag = await createImageBitmap(ctx.canvas);\n  }\n  if (res.DragHL == null) {\n    const ctx = createCtx(1089, 160);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 160 L 0 160 Z'));\n    ctx.strokeStyle = '#f0ed69';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 110 L 50 110 Z'));\n    res.DragHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHead == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 0 100 L 1089 100 L 1089 0'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 50 L 1039 50 L 1039 0'));\n    res.HoldHead = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHeadHL == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 0 100 L 1089 100 L 1089 0'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 50 L 1039 50 L 1039 0'));\n    res.HoldHeadHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Hold == null) {\n    const ctx = createCtx(1089, 1900);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 0 1900 M 1089 0 L 1089 1900'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 1900 M 1039 0 L 1039 1900'));\n    res.Hold = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHL == null) {\n    const ctx = createCtx(1089, 1900);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 0 1900 M 1089 0 L 1089 1900'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 1900 M 1039 0 L 1039 1900'));\n    res.HoldHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldEnd == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 100 L 0 0 L 1089 0 L 1089 100'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 100 L 50 50 L 1039 50 L 1039 100'));\n    res.HoldEnd = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Flick == null) {\n    const ctx = createCtx(1089, 300);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 300 L 0 300 Z'));\n    ctx.strokeStyle = '#fe4365';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 250 L 50 250 Z'));\n    res.Flick = await createImageBitmap(ctx.canvas);\n  }\n  if (res.FlickHL == null) {\n    const ctx = createCtx(1089, 300);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 300 L 0 300 Z'));\n    ctx.strokeStyle = '#fe4365';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 250 L 50 250 Z'));\n    res.FlickHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Rank == null) {\n    const _5x5colors = ['#fffb00', '#a937e7', '#ea61df', '#ff9e22', '#00a844', '#00e8de', '#e4e4e4'];\n    const _5x5dots = [5232301, 4532785, 16267326, 18415150, 16301615, 31491134, 1088575];\n    const ctx = createCtx(256, 1792);\n    for (let i = 0; i < 7; i++) {\n      ctx.fillStyle = '#fff';\n      ctx.fillRect(0, i * 256, 256, 256);\n      ctx.fillStyle = '#303030';\n      ctx.fillRect(16, i * 256 + 16, 224, 224);\n      ctx.fillStyle = _5x5colors[i];\n      const dot = _5x5dots[i];\n      const size = 32;\n      const start = (256 - size * 5) / 2;\n      for (let k = 0; k < 25; k++) {\n        if (dot >> k & 1) {\n          const x = start + k % 5 * size;\n          const y = start + Math.floor(k / 5) * size + i * 256;\n          ctx.fillRect(x, y, size, size);\n        }\n      }\n    }\n    res.Rank = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HitFXRaw == null) {\n    const ctx = createCtx(256, 256 * 30);\n    ctx.strokeStyle = '#fff';\n    for (let i = 0; i < 30; i++) {\n      const tick = i / 30;\n      ctx.lineWidth = (1 - tick) ** 2 * 25;\n      ctx.globalAlpha = 1 - tick;\n      const width = tick ** 0.2 * 224;\n      ctx.strokeRect(128 - width / 2, i * 256 + 128 - width / 2, width, width);\n    }\n    res.HitFXRaw = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver1 == null) {\n    const ctx = createCtx(1716, 325);\n    ctx.fillStyle = '#000';\n    ctx.globalAlpha = 0.8;\n    ctx.fillRect(0, 0, 1716, 325);\n    ctx.fillStyle = '#989898';\n    // ctx.fillRect(0, 90, 1716, 145);\n    // ctx.fillStyle = '#4b4b4b';\n    ctx.fillRect(0, 94, 1716, 137);\n    ctx.globalAlpha = 1;\n    ctx.fillStyle = 'white';\n    ctx.textAlign = 'right';\n    ctx.font = 'bold 30px Custom';\n    ctx.fillText('ACC:', 240, 172);\n    ctx.fillText('Max combo:', 1420, 172);\n    ctx.textAlign = 'center';\n    ctx.font = 'bold 22px Custom';\n    ctx.fillText('Perfect', 788, 304);\n    ctx.fillText('Good', 942, 304);\n    ctx.fillText('Bad', 1096, 304);\n    ctx.fillText('Miss', 1250, 304);\n    res.LevelOver1 = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver4 == null) {\n    const ctx = createCtx(633, 122);\n    const gradient = ctx.createLinearGradient(24, 0, 633, 0);\n    gradient.addColorStop(0, 'rgba(0,0,0,0.78125)');\n    gradient.addColorStop(1, 'rgba(0,0,0,0)');\n    ctx.fillStyle = gradient;\n    ctx.fillRect(24, 24, 609, 72);\n    res.LevelOver4 = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver5 == null) {\n    const ctx = createCtx(11, 43);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(3, 1, 7, 40);\n    res.LevelOver5 = await createImageBitmap(ctx.canvas);\n  }\n  const entries2 = ['HitFXRaw', 'Rank', 'LevelOver1', 'LevelOver3', 'LevelOver4', 'LevelOver5'];\n  for (const entry of entries2) {\n    if (res[entry] == null) {\n      res[entry] = await createImageBitmap(createCtx(1, 1).canvas);\n    }\n  }\n  if (res.JudgeLine == null) {\n    const ctx = createCtx(1920, 3);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(0, 0, 1920, 3);\n    res.JudgeLine = await createImageBitmap(ctx.canvas);\n  }\n  if (res.ProgressBar == null) {\n    const ctx = createCtx(1919, 11);\n    ctx.fillStyle = '#919191';\n    ctx.fillRect(0, 0, 1916, 11);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(1916, 0, 3, 11);\n    res.ProgressBar = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HitSong0 == null) res.HitSong0 = audio.triangle(0.075, 880, 0.5); // 0.1\n  if (res.HitSong1 == null) res.HitSong1 = audio.triangle(0.05, 1318, 0.5); // 0.44\n  if (res.HitSong2 == null) res.HitSong2 = audio.triangle(0.075, 1760, 0.5); // 0.39\n  if (res.LevelOver0_v1 == null) res.LevelOver0_v1 = audio.noise(27.83);\n  if (res.LevelOver1_v1 == null) res.LevelOver1_v1 = audio.noise(27.83);\n  if (res.LevelOver2_v1 == null) res.LevelOver2_v1 = audio.noise(27.83);\n  if (res.LevelOver3_v1 == null) res.LevelOver3_v1 = audio.noise(27.83);\n}\n"],"names":["selectChartFile","document","getElementById","musicDispatchE","int","playFlag","activeview","isAuto","chartFilePath","isOfficeInited","checkView","Office","context","getSelectedDataAsync","CoercionType","SlideRange","asyncResult","status","AsyncResultStatus","Failed","console","error","message","value","slides","index","mainPlay","setInt","async","flag","setInterval","clearInterval","activeViewHandler","eventArgs","activeView","musicDispatch","setSetting","name","settings","set","saveAsync","log","setSelect","fetch","then","response","ok","Error","json","data","chartlist","chartFileName","key","hasOwnProperty","item","push","path","length","innerHTML","forEach","option","createElement","text","appendChild","addEventListener","chartIndex","selectedIndex","uploader","simulateFileSelection","setChart","dispatchEvent","Event","catch","click","initialize","addHandlerAsync","EventType","ActiveViewChanged","getActiveViewAsync","goToFirst","Index","First","gotonext","goToNext","Next","goToByIdAsync","GoToType","setTimeout","loading","get","getAndSetChartIndex","onload","full","toggle","elem","this","enabled","Promise","reject","onFullscreen","n","resolve","onchange","once","onerror","element","handler","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","call","HTMLElement","body","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","check","onfullscreenchange","onwebkitfullscreenchange","onmozfullscreenchange","onfullscreenerror","onwebkitfullscreenerror","onmozfullscreenerror","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","orientation","checkSupport","s","screen","lock","type","unlock","hook","toast","e","lockLandscape","lockPortrait","isUndefined","self","Reflect","construct","EventTarget","listeners","prototype","constructor","callback","removeEventListener","stack","i","l","splice","event","defaultPrevented","cause","Object","defineProperty","DOMException","super","captureStackTrace","replace","AudioContext","webkitAudioContext","hasOwn","obj","prop","Array","findLast","predicate","thisArg","toReversed","slice","reverse","Timer","__publicField","t0","t1","isPaused","time","performance","now","second","play","pause","reset","addTime","num","parseCSV","rawText","isObject","lines","split","rows","line","rowText","isQuot","beforeQuot","row","char","SyntaxError","arr","j","stringify","bfs","labels","label","decoder","TextDecoder","fatal","decode","Type","a","Number","float","bool","str","String","isArray","map","Type$1","SpeedEvent","startTime","endTime","Note","note","positionX","holdTime","speed","floorPosition","JudgeLineEvent","start","end","start2","end2","JudgeLine","numOfNotes","numOfNotesAbove","numOfNotesBelow","bpm","speedEvents","notesAbove","notesBelow","judgeLineDisappearEvents","judgeLineMoveEvents","judgeLineRotateEvents","Chart","input","chart","formatVersion","offset","judgeLineList","reduce","b","duplicate","structChart","filename","result","evt","Math","floor","errors","messages","numOfLines","o","host","code","target","maxNoteSeconds","seconds","subErrors","maxNoteTime","ceil","checkMaxEventTime","maxEndTime","join","structInfoData","entries","entry","Name","Musician","artist","Composer","Artist","Level","level","Illustrator","illustrator","Designer","charter","Charter","Music","music","Image","image","AspectRatio","v","parseFloat","isFinite","aspectRatio","ScaleRatio","noteScale","NoteScale","GlobalAlpha","backgroundDim","BackgroundDim","Offset","structLineData","LineId","lineId","Vert","scaleOld","Horz","aspect","IsDark","useBackgroundDim","Scale","scale","Aspect","UseBackgroundDim","UseLineColor","useLineColor","UseLineScale","useLineScale","base64map","crypt","rotl","rotr","endian","randomBytes","bytes","random","bytesToWords","words","wordsToBytes","bytesToHex","hex","toString","hexToBytes","c","parseInt","substr","bytesToBase64","base64","triplet","charAt","base64ToBytes","imod4","indexOf","pow","cryptModule","exports","charenc","utf8","stringToBytes","bin","unescape","encodeURIComponent","bytesToString","decodeURIComponent","escape","charCodeAt","fromCharCode","charenc_1","isBuffer_1","isBuffer","readFloatLE","isSlowBuffer","_isBuffer","require$$0","require$$1","require$$2","md5","options","encoding","Uint8Array","m","d","FF","_ff","GG","_gg","HH","_hh","II","_ii","aa","bb","cc","dd","x","t","_blocksize","_digestsize","md5Module","digestbytes","asBytes","asString","file2","FileEmitter","accept","multiple","fireChange","files","file","reader","FileReader","readAsArrayBuffer","onprogress","fireProgress","loaded","total","ArrayBuffer","fireLoad","fireFileLoaded","assign","uploadFile","webkitdirectory","uploadDir","ProgressEvent","lengthComputable","buffer","filePath","blob","fetchFileFromPath","File","ZipReader","worker","read","zipData","CustomEvent","Zip","msg","detail","postMessage","terminate","readerInits","pattern","createAudioBuffer","videoElement","src","URL","createObjectURL","Blob","preload","onloadedmetadata","pathname","audio","video","videoWidth","videoHeight","readMediaData","arraybuffer","actx","close","decodeAudioData","defaultDecode","JSON","parse","_","fround","jsonData","format","imageData","createImageBitmap","mustMatch","splitPath","chartLine","chartInfo","define","readers","filtered","filter","test","sort","weight","errorHandler","err","use","readerInit","createReader","isText","isJSON","lastIndexOf","HitEvent","id","offsetX","offsetY","isActive","isTapped","isMoving","lastDeltaX","lastDeltaY","nowDeltaX","nowDeltaY","deltaTime","currentTime","flicking","flicked","move","flickSpeed","sqrt","JudgeEvent","judged","preventBad","Stat","noteRank","combos","cumDisp","curDisp","numDisp","maxcombo","combo","good","bad","great","perfect","all","scoreNum","scoreStr","toFixed","repeat","accNum","accStr","avgDispStr","trunc","curDispStr","lineStatus","rankStatus","round","localData","removeLegacy","localStorage","getItem","setItem","removeItem","getData","s1","s2","l1","l2","l3","na","sa","sb","pbj","newBestColor","newBestStr","scoreBest","scoreDelta","abs","textAboveColor","textAboveStr","textBelowColor","textBelowStr","_localStorage$getItem","addCombo","addDisp","disp","_actx","_gain","_msdest","_inited","initFnList","bfsList","IntervalBufferSource","res","dest","loop","playbackrate","interval","NaN","_bfs","createBufferSource","_loop","stop","onended","connect","playbackRate","currentOffset","duration","bufferSource","gainNode","msdest","disconnect","init","createGain","destination","initFn","mute","createBuffer","sine","frequency","gain","getChannelData","sin","PI","sawtooth","square","triangle","noise","AudioController","bind","createCtx","width","height","canvas","ctx","getContext","TypeError","_typeof","Symbol","iterator","ImgAny","mulTable","shgTable","BlurStack","instance","Constructor","_classCallCheck","r","g","next","hex2rgba","color","fillStyle","fillRect","getImageData","imgShader","img","limit","dataRGBA","willReadFrequently","drawImage","dy","dx","imgData","putImageData","imgSplit","limitX","limitY","min","sy","sx","border","ctx1","ab","size","DataView","getUint32","decodeAlt","mask","combined","Checkbox","checked","container","checkbox","Utils","randomUUID","htmlFor","textContent","appendTo","appendBefore","node","parentNode","insertBefore","HitEvents","updateCallback","iterateCallback","update","defilter","animate","iterate","add","clear","HitFeedback","n1","n2","tap","hold","HitImage","n3","packs","noteRender","hitFX","effects","direction","numOfParts","fill","_note","HitWord","early","late","ScaledNote","compacted","dw","dh","head","tail","adjustSize","source","sw","sh","BetterMessageBox","list","updateHTML","appendMessage","MessageHandler","betterMessageBoxes","addBox","msgbox","setAttribute","classList","nodeView","removeNodeBox","nodeBox","remove","updateText","lastMessage","removeBetterMessageBox","btn","innerText","style","onclick","bmsgbox","page","pages","createTextNode","btnIgnoreAll","nodePageNum","contentEditable","cssText","nodePages","btnPrevousPage","btnNextPage","nodeControl","append","nodeBMsg","updatePage","isNaN","max","onblur","timer","clearTimeout","querySelectorAll","bmsg","btnIgnore","div","getBetterMessageBox","nodeText","className","sendWarning","isHTML","escapeHTML","sendError","html","exp","ahtml","match","url","startsWith","rpath","location","origin","includes","table","sp","ez","hd","in","at","keys","meta","_i","$id","query","$","querySelector","viewNav","viewCfg","viewMsg","viewNav2","viewRmg","viewExt","coverDark","coverRmg","coverView","buttonDocs","buttonMore","anchorCfg","anchorMsg","strongOut","blockUploader","stageEl","selectNoteScale","selectAspectRatio","selectBackgroundDim","checkHighLight","inputOffset","lineColor","checkAutoPlay","showTransition","checkFeedback","checkImageBlur","selectbg","btnPlay","btnPause","selectbgm","selectchart","selectflip","selectspeed","inputName","inputArtist","inputCharter","inputIllustrator","selectDifficulty","selectLevel","levelInfoHandler","Option","toUpperCase","updateInternal","diffStr","toLowerCase","levelNum","diff","find","diffString","levelString","updateLevelText","p","trim","getDifficultyIndex","getLevelNumber","exec","selectVolume","blockSelect","blockMask","tween","time2Str","Gn","main","before","Map","after","afterAll","filterOptions","oncontextmenu","preventDefault","thisElem","children","fireModal","msgHandler","arguments","sendText","stat","stage","isFull","resize","ratio","devicePixelRatio","rawWidth","getBoundingClientRect","stageWidth","stageHeight","getFull","setFull","app","HTMLDivElement","fail","alpha","canvasfg","ctxfg","lineScale","noteScaleRatio","brightness","multiHint","playMode","musicVolume","soundVolume","_mirrorType","enableFR","enableVP","bgMusic","bgVideo","notes","taps","drags","flicks","holds","linesReversed","notesReversed","tapsReversed","dragsReversed","flicksReversed","holdsReversed","tapholds","lowResFactor","wlen","hlen","scaleX","scaleY","matX","matY","y","matR","initialized","_setLowResFactor","resizeCanvas","maxSeconds","setNoteScale","setLowResFactor","_resizeCanvas","mirrorView","transformView","xa","xb","ya","yb","ra","sign","rb","tx","ty","prerenderChart","chartNew","y2","floorPosition2","ss","aniStart","aniEnd","hitStart","hitEnd","aniUpdate","hitUpdate","addSeconds","events","startSeconds","endSeconds","addNote","h","beat32","noteId","isAbove","holdSeconds","maxVisiblePos","magic","prime","log2","a_","Float32Array","Uint32Array","getMaxVisiblePos","sortNote","rotation","positionY","positionY2","disappearEventsIndex","moveEventsIndex","rotateEventsIndex","speedEventsIndex","timeOfMulti","isMulti","nearNotes","note2","seekLineEventIndex","updateByTime","len","dt","cosr","cos","sinr","getGoodY","getBadY","badTime","badY","setAlpha","projectX","projectY","visible","showPoint","isHidden","frameCount","widthLowRes","heightLowRes","Emitter","statusInit","emit","eq","ne","emitter","status2","reg","Boolean","ImageStore","base","_blur","blur","setBlur","w","topX","topY","radius","getImageDataFromCanvas","stackEnd","pixels","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","stackIn","stackOut","yw","yi","mulSum","shgSum","pr","pg","pb","pa","rInSum","gInSum","bInSum","aInSum","rOutSum","gOutSum","bOutSum","aOutSum","rSum","gSum","bSum","aSum","_i2","rbs","paInitial","_a2","_p","_stackOut","_r","_g","_b","_a","_x","_pr","_pg","_pb","_pa","_rOutSum","_gOutSum","_bOutSum","_aOutSum","_rSum","_gSum","_bSum","_aSum","_i3","yp","_gInSum","_bInSum","_aInSum","_rInSum","_i4","_rbs","_y","_p2","processImageDataRGBA","canvasRGBA","imgBlur","bgs","bgms","charts","chartsMD5","chartsFormat","chartLineDataList","chartInfoDataList","resetCallback","_t2","_localStorage$getItem2","dataOffice","save","rmSetting","dispatch","HTMLInputElement","HTMLSelectElement","property","HTMLTextAreaElement","resetCfg","showCE2","showAcc","showStat","lowRes","lockOri","maxFrame","autoDelay","adjustInfo","has","_n$e$target$value$toL","slowest","slower","faster","fastest","dones","totals","uploaderDone","uploaderTotal","handleFile","tag","promise","oncomplete","values","loadComplete","zip","createOption","innerhtml","getUniqueName","basename","info","warn","pick","arrayBuffer","isBeta","resLink","atob","import","default","hitManager","activate","idx","findIndex","hit","moving","hitEl","deactivate","exitFull","Bs","timeIn","timeOut","timeEnd","specialClick","func","mainPause","pressTime","getJudgeOffset","judgeEvent","getJudgeDistance","nowTimeMS","curTime","curTimeMS","timeBgm","timeChart","duration0","isInEnd","isOutStart","isOutEnd","musicController","soundController","frameTimer","tick","fps","fpsStr","toPrecision","addTick","fr","frameAnimater","lastTime","EPSILON","_animate","requestAnimationFrame","cancelAnimationFrame","setCallback","setFrameRate","frameRate","nowTime","elapsed","playBgm","playVideo","hitFeedbackList","hitImageList","hitWordList","judgeWidth","judgeManager","addEvent","execute","tmps","bgImage","background","getImageBlur","progress","awawa","placeholder","combo2","customForeDraw","customBackDraw","loopNoCanvas","clearRect","globalAlpha","drawLine","resetTransform","drawHold","drawDrag","drawTap","drawFlick","drawNotes","font","textAlign","setTransform","fillText","ProgressBar","imgW","imgH","JudgeLineMP","fillTextNode","val","loopCanvas","isOutOver","globalCompositeOperation","bgImageBlur","difficulty","tempStat","statData","k","clip","skew","LevelOver4","LevelOver1","LevelOver5","textWidth","outerSize","innerSize","LevelOver3","Ranks","transition","Path2D","getImage","atDraw3","handlerHide","Is","visibilityState","bgMusicHack","muted","_t$Math$floor","r3","ds","dispTime","scored","holdTapTime","holdStatus","HitSong1","distance","noteJudge","nearcomp","nearNote","nearDistance","HitSong2","holdBroken","deltaTime2","nearDeltaTime","note1","HitSong0","statOffset","beginPath","arc","interact","InteractProxy","getPos","rect","clientX","left","offsetWidth","clientY","top","offsetHeight","setMouseEvent","mousedownCallback","button","mousemoveCallback","buttons","mouseupCallback","setKeyboardEvent","keydownCallback","keyupCallback","setTouchEvent","touchstartCallback","touch","changedTouches","identifier","touchmoveCallback","touchendCallback","touchcancelCallback","TapBad","imgPainter","updateFX","img0","hideParts","hitRaw","hitPerfect","hitGood","Perfect","Good","window","messageCallback","_msg","warnCallback","errorCallback","_html","_fatal","mobileCallback","orientNotSupportCallback","sysError","getConstructorName","message2","_d$stack","errMessage","errDetail","reason","loadLib","urls","errmsg1","errmsg2","errmsg3","args","from","href","args0","arg","load","script","port","crossOrigin","loadJS","addFont","alt","navigator","standalone","platform","maxTouchPoints","userAgent","miuiVersion","checkMiuiVersion","oggCompatible","Audio","canPlayType","oggmented","OggmentedAudioContext","webpCompatible","toDataURL","checkOrient","raw","loadResource","alternative","loadedNum","errorNum","res0","res1","ext","referrerPolicy","blob1","readResource","Tap","lineWidth","strokeStyle","stroke","TapHL","Drag","DragHL","HoldHead","HoldHeadHL","Hold","HoldHL","HoldEnd","Flick","FlickHL","Rank","_5x5colors","_5x5dots","dot","HitFXRaw","strokeRect","gradient","createLinearGradient","addColorStop","entries2","LevelOver0_v1","LevelOver1_v1","LevelOver2_v1","LevelOver3_v1","fixme","NoImageBlack","ImageData","Uint8ClampedArray","NoImageWhite","JudgeLineFC","isBlur","tw","imageD","imgS","imageU","imageS","imageW","imageA","imageH","imageL","imageC","maxWidth","measureText","HL","nsr","baseLength","holdLength","lineImages","LineImage","imageFC","imageAP","imageMP","getFC","getAP","getMP","updateLineImage","lineImage","bgm","modify","onwarn","loadLineData","deactive","volume","bg","contains","loadPlugin","searchValue","delay","debounce","appendCfg","ka","navHTML","contentHTML","cover","nav","content","module","contents","isPlaying","setValueCurve","lastValue","URLSearchParams","search","parent","onmessage","reader1","onReady"],"mappings":"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K,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAClwCC,GAAW,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,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","x_google_ignoreList":[8,9,10,11,17]}